<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TP de Biométrie Semestre 5 - 5&nbsp; Systèmes dynamiques</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-MarkovChains.html" rel="next">
<link href="./04-Cohortes.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-DynamicSystems.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Systèmes dynamiques</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span id="sec-dynam" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Systèmes dynamiques</span></span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">TP de Biométrie<br> Semestre 5<br></a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/besibo/BiometrieS5" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./TP-de-Biométrie-br--Semestre-5-br-.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-OneSampleTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Comparaison de la moyenne d’une population à une valeur théorique</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-TwoSamplePairedTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Comparaison de moyennes : deux échantillons appariés</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-TwoSampleTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparaison de moyennes : deux échantillons indépendants</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Cohortes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse de cohortes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-DynamicSystems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Systèmes dynamiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-MarkovChains.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Les Chaînes de Markov</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#objectifs" id="toc-objectifs" class="nav-link active" data-scroll-target="#objectifs"><span class="header-section-number">5.1</span> Objectifs</a></li>
  <li><a href="#sec-packages5" id="toc-sec-packages5" class="nav-link" data-scroll-target="#sec-packages5"><span class="header-section-number">5.2</span> Pré-requis</a></li>
  <li><a href="#sec-for" id="toc-sec-for" class="nav-link" data-scroll-target="#sec-for"><span class="header-section-number">5.3</span> Les boucles <code>for</code></a></li>
  <li><a href="#sec-mort" id="toc-sec-mort" class="nav-link" data-scroll-target="#sec-mort"><span class="header-section-number">5.4</span> Modèle de mortalité exponentielle</a></li>
  <li><a href="#sec-crois" id="toc-sec-crois" class="nav-link" data-scroll-target="#sec-crois"><span class="header-section-number">5.5</span> Modèle de croissance exponentielle</a></li>
  <li><a href="#sec-logist" id="toc-sec-logist" class="nav-link" data-scroll-target="#sec-logist"><span class="header-section-number">5.6</span> Modèle de croissance logistique</a></li>
  <li><a href="#sec-lotka" id="toc-sec-lotka" class="nav-link" data-scroll-target="#sec-lotka"><span class="header-section-number">5.7</span> Modèle prédateur-proie de Lotka-Volterra</a></li>
  <li><a href="#sec-compet" id="toc-sec-compet" class="nav-link" data-scroll-target="#sec-compet"><span class="header-section-number">5.8</span> Modèle de compétition interspécifique</a></li>
  <li><a href="#sec-multispe" id="toc-sec-multispe" class="nav-link" data-scroll-target="#sec-multispe"><span class="header-section-number">5.9</span> Modèles à 3 espèces</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="objectifs" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="objectifs"><span class="header-section-number">5.1</span> Objectifs</h2>
<p>Dans ce chapitre, vous allez étudier plusieurs modèles dynamiques vus en cours :</p>
<ol type="1">
<li>modèle de mortalité exponentielle</li>
<li>modèle de croissance exponentielle</li>
<li>modèle de croissance logistique</li>
<li>modèle de Lotka-Volterra</li>
<li>modèles de compétition</li>
</ol>
<p>Pour cela, dans <code>RStudio</code>, vous devrez construire ces modèles en utilisant des boucles <code>for</code> (dont nous détaillerons la syntaxe à la <a href="#sec-for"><span>Section&nbsp;5.3</span></a>) afin de décrire les variations d’abondance des populations étudiées au cours du temps. Quand ces modèles seront construits, vous devrez en faire varier les conditions initiales et les valeurs des paramètres, afin d’observer le comportement du modèles dans des conditions variées.</p>
<p>Pour chaque modèle cité plus haut, vous allez donc tout d’abord simuler des données dans des conditions précises, en faire la représentation graphique, puis modifier les paramètres du modèle pour comprendre comment les différents termes (de croissance, de mortalité, d’interaction…) affectent les populations.</p>
</section>
<section id="sec-packages5" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-packages5"><span class="header-section-number">5.2</span> Pré-requis</h2>
<p>Comme pour chaque nouveau chapitre, je vous conseille de travailler dans un nouveau script que vous placerez dans votre répertoire de travail, et dans une nouvelle session de travail (Menu <code>Session &gt; Restart R</code>). Inutile en revanche de créer un nouveau <code>Rproject</code> : vous pouvez tout à fait avoir plusieurs script dans le même répertoire de travail et pour un même <code>Rproject</code>. Comme toujours, consultez <a href="https://besibo.github.io/BiometrieS3/01-R-basics.html#sec-code">le livre en ligne du semestre 3</a> si vous ne savez plus comment faire.</p>
<p>Si vous êtes dans une nouvelle session de travail (ou que vous avez quitté puis relancé <code>RStudio</code>), vous devrez penser à recharger en mémoire les packages utiles. Dans ce chapitre, vous aurez uniquement besoin des packages du <code>tidyverse</code> <span class="citation" data-cites="R-tidyverse">(<a href="references.html#ref-R-tidyverse" role="doc-biblioref">Wickham 2023</a>)</span>, en particulier les package <code>dplyr</code> <span class="citation" data-cites="R-dplyr">(<a href="references.html#ref-R-dplyr" role="doc-biblioref">Wickham, François, et al. 2023</a>)</span>, pour manipuler des tableaux, et <code>ggplot2</code> <span class="citation" data-cites="R-ggplot2">(<a href="references.html#ref-R-ggplot2" role="doc-biblioref">Wickham, Chang, et al. 2023</a>)</span> pour les représentations graphiques.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous n’aurons pas besoin ici d’importer de données depuis des fichiers externes : nous allons en effet générer directement des données à partir de différents modèles démographiques vus en cours.</p>
<p>Comme toujours, je spécifie une fois pour toutes le thème que j’utiliserai pour tous les graphiques de ce chapitre. Libre à vous de choisir un thème différent ou de vous contenter du thème proposé par défaut :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-for" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-for"><span class="header-section-number">5.3</span> Les boucles <code>for</code></h2>
<p>Dans tous les langages de programmation, les boucles permettent de répéter automatiquement les mêmes actions un grand nombre de fois. Il existe plusieurs types de boucles, mais les boucles <code>for</code> sont les plus communes. Dans <code>R</code>, chaque boucle <code>for</code> possède 3 éléments :</p>
<ol type="1">
<li><p><strong>La sortie</strong>. Avant d’exécuter la boucle, vous devez toujours créer de façon explicite un objet qui contiendra les résultats des calculs effectués à l’intérieur de la boucle. Une bonne façon de créer un vecteur vide pour stocker des valeurs numériques consiste à utiliser la fonction <code>numeric()</code></p></li>
<li><p><strong>La séquence</strong> pour laquelle vous souhaitez “faire tourner la boucle”. Dans une boucle <code>for</code>, vous devez indiquer un indice qui spécifie le nombre d’itérations que la boucle doit effectuer. Par exemple :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>indique que les commandes qui figurent à l’intérieur de la boucle devront être exécutées 10 fois, une fois pour chaque valeur de <code>i</code>, c’est-à-dire 1, 2, 3… jusqu’à 10. Pour chaque exécution des commandes de la boucle, l’indice <code>i</code> prendra donc une valeur différente comprise entre 1 et 10.</p></li>
<li><p><strong>Le corps de la boucle</strong>. Il est constitué des commandes que l’on souhaite faire exécuter à la boucle, et il doit obligatoirement être encadré par des accolades <code>{ }</code>.</p></li>
</ol>
<p>Voilà un exemple de boucle très simple :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un vecteur numérique vide</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour chaque valeur de i comprise entre 1 et 5</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  res[i] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> i <span class="sc">-</span> <span class="dv">1</span> <span class="co"># Calcule 3 * i - 1</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  5  8 11 14</code></pre>
</div>
</div>
<p>Les boucles peuvent faire des choses beaucoup plus complexes. Par exemple, supposez que vous avez une première valeur de 100, et que vous souhaitez diviser cette valeur par 2, puis que vous souhaitez diviser le résultat par 2, et ainsi de suite, 10 fois. Voilà comment faire ça avec une boucle <code>for</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un vecteur numérique vide</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Stockage de la valeur initialle dans cet objet</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour chaque valeur de i comprise entre 2 et 11</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>) {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  res[i] <span class="ot">&lt;-</span> res[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 100.00000000  50.00000000  25.00000000  12.50000000   6.25000000
 [6]   3.12500000   1.56250000   0.78125000   0.39062500   0.19531250
[11]   0.09765625</code></pre>
</div>
</div>
<p>Notez bien la position des accolades <code>{</code> et <code>}</code> dans le code ci-dessus. Leur position est importante, de même que les sauts de lignes. Notez aussi que dans cet exemple, <code>i</code> prend successivement les valeurs 2, 3, 4, … , 11, au lieu des valeurs 1, 2, 3, … , 10. En effet, on connait déjà la première valeur de <code>res</code>. On veut justement utiliser cette première valeur pour calculer la deuxième, la troisième et ainsi de suite. Si on souhaite répéter l’opération 10 fois de suite, il nous faut faire varier <code>i</code> de 2 à 11 inclus. Ici, nous avons en réalité calculé l’équation de récurrence suivante :</p>
<p><span class="math display">\[res_t = \frac{res_{t-1}}{2}\]</span></p>
<p>Vous savez maintenant comment fonctionnent les boucles <code>for</code> et vous devriez donc pouvoir construire votre premier modèle dynamique.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dans <code>R</code>, le premier élément d’un objet occupe la position <code>[1]</code>. L’indice <code>[0]</code> n’existe pas. Il faut donc faire attention à ce que les indices choisis pour <code>i</code> dans l’expression <code>for (i in ...)</code> soient cohérents avec d’une part la position dans l’objet qui stockera les résultats, et d’autre part l’équation du système que l’on simule.</p>
</div>
</div>
</section>
<section id="sec-mort" class="level2 page-columns page-full" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-mort"><span class="header-section-number">5.4</span> Modèle de mortalité exponentielle</h2>
<p>Comme nous l’avons vu dans le cours, le modèle de mortalité exponentielle est défini par l’équation suivante :</p>
<p><span class="math display">\[\frac{\mathrm{d}N}{\mathrm{d}t} = -mN\]</span> Avec <span class="math inline">\(N\)</span>, l’abondance de la population étudiée, <span class="math inline">\(t\)</span>, le temps et <span class="math inline">\(m\)</span> le taux de mortalité instantané. Pour coder ce modèle dans <code>RStudio</code>, vous devez vous rappeler de <strong>la signification</strong> de cette équation différentielle. Elle indique que dans un intervalle de temps très court <span class="math inline">\(\mathrm{d}t\)</span>, <strong>la variation de l’abondance de la population</strong> <span class="math inline">\(\mathrm{d}N\)</span> vaut <span class="math inline">\(-mN\)</span>. Autrement dit, entre 2 temps d’observation successifs (par exemple entre <span class="math inline">\(t\)</span> et <span class="math inline">\(t + 1\)</span>, ou entre <span class="math inline">\(t - 1\)</span> et <span class="math inline">\(t\)</span>), l’abondance de la population passe de <span class="math inline">\(N\)</span> à <span class="math inline">\(N - mN\)</span>. Ce modèle peut donc être décrit par l’équation de récurrence suivante :</p>
<p><span class="math display">\[N_{t+1} = N_t - m \times N_t\]</span> ce qui est évidemment équivalent à</p>
<p><span class="math display">\[N_{t} = N_{t - 1} - m \times N_{t - 1}\]</span> Cette dernière équation peut se lire ainsi : l’abondance au temps <span class="math inline">\(t\)</span> (<span class="math inline">\(N_t\)</span>) est égale à l’abondance au temps précédent <span class="math inline">\(N_{t-1}\)</span>, plus la variation d’abondance entre 2 pas de temps successifs (<span class="math inline">\(-m\times N_{t-1}\)</span>). Vous devez utiliser cette équation pour construire le modèle de mortalité exponentielle à l’intérieur d’une boucle <code>for</code> comme dans le dernier exemple de la <a href="#sec-for"><span>Section&nbsp;5.3</span></a>. Ici, on cherche donc à déterminer la nouvelle valeur de la variable (<span class="math inline">\(N\)</span> au temps <span class="math inline">\(t\)</span>) en utilisant la valeur de la même variable mais au temps précédent (<span class="math inline">\(N\)</span> au temps <span class="math inline">\(t-1\)</span>).</p>
<p>Plusieurs étapes sont donc nécessaires :</p>
<ol type="1">
<li><p>Créez un vecteur <code>N</code> qui sera utilisé pour stocker les résultats des calculs à chaque étape de simulation. Utilisez la commande suivante :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un vecteur numérique qui contiendra les résultats</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Fixez l’abondance initiale de la population à <span class="math inline">\(N_0 = 10\)</span></p></li>
<li><p>Fixez le taux de mortalité instantanée à <span class="math inline">\(m = 0.05\)</span> (à chaque pas de temps, 5% de la population disparaît)</p></li>
<li><p>Placez l’abondance initiale à la première position de <code>N</code></p></li>
<li><p>Créez une boucle <code>for</code> pour calculer et placer dans <code>N</code> l’abondance de la population pour 100 pas de temps</p></li>
<li><p>Créez un tibble nommé <code>res</code> contenant 2 variables (<code>Generation</code> et <code>Abondance</code>) en utilisant cette commande :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un tibble où les résultats seront stockés</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Generation =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, N)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<p>Si votre script est correct et qu’il s’exécute sans erreur, l’objet <code>res</code> devrait contenir 101 lignes, avec 101 valeurs d’abondance. Les premières lignes de <code>res</code> devraient contenir ces valeurs :</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 101 × 2
   Generation     N
        &lt;int&gt; &lt;dbl&gt;
 1          0 10   
 2          1  9.5 
 3          2  9.02
 4          3  8.57
 5          4  8.15
 6          5  7.74
 7          6  7.35
 8          7  6.98
 9          8  6.63
10          9  6.30
# ℹ 91 more rows</code></pre>
</div>
</div>
<p>Visualisez ces données avec <code>ggplot2</code>. Votre graphique devrait ressembler à ceci :</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-mort" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-mort-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.1: Modèle de mortalité exponentielle avec <span class="math inline">\(N_0 = 10\)</span> et <span class="math inline">\(m = 0.05\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour comprendre ce modèle…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Essayez d’utiliser plusieurs valeurs différentes pour <span class="math inline">\(N_0\)</span> et relancez tout le script. Que se passe-t-il quand <span class="math inline">\(N_0\)</span> est très grand ? Est-ce normal ?</p>
<p>Enfin, essayez de changer la valeur de <span class="math inline">\(m\)</span> et de relancer le script. Faites des essais avec plusieurs valeurs. Qu’observe-t-on quand la valeur de <span class="math inline">\(m\)</span> se rapproche de 1 ? Est-ce normal ? Et que se passe-t-il si <span class="math inline">\(m &gt; 1\)</span> ? Est-ce réaliste ? Pourquoi ? Mêmes questions avec <span class="math inline">\(m = 2\)</span> et <span class="math inline">\(m = 3\)</span> ?</p>
</div>
</div>
</div>
</section>
<section id="sec-crois" class="level2 page-columns page-full" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sec-crois"><span class="header-section-number">5.5</span> Modèle de croissance exponentielle</h2>
<p>Comme nous l’avons vu dans le cours, le modèle de croissance exponentielle est défini par l’équation suivante :</p>
<p><span class="math display">\[\frac{\mathrm{d}N}{\mathrm{d}t} = rN\]</span> Avec <span class="math inline">\(N\)</span>, l’abondance de la population étudiée, <span class="math inline">\(t\)</span>, le temps et <span class="math inline">\(r\)</span> le taux de croissance instantané. Pour coder ce modèle dans <code>RStudio</code>, vous devez vous rappeler de <strong>la signification</strong> de cette équation différentielle. Elle indique que dans un intervalle de temps très court <span class="math inline">\(\mathrm{d}t\)</span>, <strong>la variation de l’abondance de la population</strong> <span class="math inline">\(\mathrm{d}N\)</span> vaut <span class="math inline">\(+rN\)</span>. Autrement dit, entre 2 temps d’observation successifs (par exemple entre <span class="math inline">\(t\)</span> et <span class="math inline">\(t + 1\)</span>, ou entre <span class="math inline">\(t - 1\)</span> et <span class="math inline">\(t\)</span>), l’abondance de la population passe de <span class="math inline">\(N\)</span> à <span class="math inline">\(N + rN\)</span>. Ce modèle peut donc être décrit par l’équation de récurrence suivante :</p>
<p><span class="math display">\[N_{t+1} = N_t + r \times N_t\]</span> ce qui est évidemment équivalent à</p>
<p><span class="math display">\[N_{t} = N_{t - 1} + r \times N_{t - 1}\]</span> Cette dernière équation peut se lire ainsi : l’abondance au temps <span class="math inline">\(t\)</span> (<span class="math inline">\(N_t\)</span>) est égale à l’abondance au temps précédent <span class="math inline">\(N_{t-1}\)</span>, plus la variation d’abondance entre 2 pas de temps successifs (<span class="math inline">\(+r\times N_{t-1}\)</span>). Vous devez utiliser cette équation pour construire le modèle de mortalité exponentielle à l’intérieur d’une boucle <code>for</code> comme dans le dernier exemple de la <a href="#sec-for"><span>Section&nbsp;5.3</span></a>. Ici, on cherche donc à déterminer la nouvelle valeur de la variable (<span class="math inline">\(N\)</span> au temps <span class="math inline">\(t\)</span>) en utilisant la valeur de la même variable mais au temps précédent (<span class="math inline">\(N\)</span> au temps <span class="math inline">\(t-1\)</span>).</p>
<p>Vous fixerez l’abondance initiale à <span class="math inline">\(N_0 = 5\)</span> et le taux de croissance instantané à <span class="math inline">\(r = 0.03\)</span>. Vous calculerez l’abondance de la population pour 100 pas de temps. Vous devriez ainsi obtenir les résultats suivants :</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 101 × 2
   Generation     N
        &lt;int&gt; &lt;dbl&gt;
 1          0  5   
 2          1  5.15
 3          2  5.30
 4          3  5.46
 5          4  5.63
 6          5  5.80
 7          6  5.97
 8          7  6.15
 9          8  6.33
10          9  6.52
# ℹ 91 more rows</code></pre>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-crois" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-crois-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.2: Modèle de croissance exponentielle avec <span class="math inline">\(N_0 = 5\)</span> et <span class="math inline">\(r = 0.03\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour comprendre ce modèle…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Comme pour le modèle de mortalité exponentielle, essayez plusieurs valeurs pour la condition initiale <span class="math inline">\(N_0\)</span> et pour le paramètre du modèle <span class="math inline">\(r\)</span>. Que se passe-t-il quand <span class="math inline">\(r = 1\)</span> ? Examinez les première valeurs d’abondance dans le tableau <code>res</code> pour vous faire une meilleure idée. Est-ce réaliste ? Que se passe-t-il quand <span class="math inline">\(r &gt; 1\)</span> ? Est-ce possible dans la nature ?</p>
</div>
</div>
</div>
</section>
<section id="sec-logist" class="level2 page-columns page-full" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="sec-logist"><span class="header-section-number">5.6</span> Modèle de croissance logistique</h2>
<p>À partir du modèle de croissance exponentielle construit à la <a href="#sec-crois"><span>Section&nbsp;5.5</span></a>, vous devez maintenant construire un modèle de croissance logistique qui est défini par l’équation suivante :</p>
<p><span class="math display">\[\frac{\mathrm{d}N}{\mathrm{d}t} = rN - \frac{r}{K}\times N^2\]</span> Avec <span class="math inline">\(N\)</span>, l’abondance de la population étudiée, <span class="math inline">\(t\)</span>, le temps, <span class="math inline">\(r\)</span> le taux de croissance instantané, et <span class="math inline">\(K\)</span> la capacité biotique (ou capacité de charge) du milieu. Comme toujours, commencez par écrire cette équation sous forme d’une relation de récurrence :</p>
<p><span class="math display">\[N_{t} = N_{t - 1} + \cdots{}\]</span> Rappelez-vous que la nouvelle abondance (au temps <span class="math inline">\(t\)</span>) est égale à l’ancienne (au temps <span class="math inline">\(t-1\)</span>), plus la variation d’abondance entre 2 pas de temps successifs, la formule de la variation étant fournie par la formule <span class="math inline">\(\frac{\mathrm{d}N}{\mathrm{d}t} = \cdots{}\)</span></p>
<p>Vous devez donc modifier le script de la <a href="#sec-crois"><span>Section&nbsp;5.5</span></a> pour ajouter le terme d’auto-limitation lié à l’environnement <span class="math inline">\(\frac{r}{K}\times N^2\)</span>. Vous utiliserez les valeurs suivantes pour les conditions initiales et les paramètres du modèle :</p>
<ul>
<li><span class="math inline">\(N_0 = 1\)</span></li>
<li><span class="math inline">\(r = 0.05\)</span></li>
<li><span class="math inline">\(K = 80\)</span></li>
<li>durée de la simulation : 200 pas de temps</li>
</ul>
<p>Vous devriez ainsi obtenir les résultats suivants :</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 201 × 2
   Generation     N
        &lt;int&gt; &lt;dbl&gt;
 1          0  1   
 2          1  1.05
 3          2  1.10
 4          3  1.16
 5          4  1.21
 6          5  1.27
 7          6  1.33
 8          7  1.40
 9          8  1.47
10          9  1.54
# ℹ 191 more rows</code></pre>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-logist" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-logist-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.3: Modèle de croissance logistique avec <span class="math inline">\(N_0 = 1\)</span>, <span class="math inline">\(r = 0.05\)</span> et <span class="math inline">\(K = 80\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour comprendre ce modèle…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Modifiez les valeurs de <span class="math inline">\(N_0\)</span>, <span class="math inline">\(r\)</span> et <span class="math inline">\(K\)</span> l’une après l’autre, pour comprendre comment chaque paramètre affecte la cinétique observée. Que se passe-t-il quand <span class="math inline">\(N_0\)</span> augmente ? Que se passe-t-il que <span class="math inline">\(N_0 &gt; K\)</span> ? Est-ce logique ? Pouvez-vous imaginer des situations réalistes où <span class="math inline">\(N_0 &gt; K\)</span> ? Quelle est l’unité de <span class="math inline">\(K\)</span> ?</p>
<p>Enfin, que se passe-t-il si le terme d’auto-limitation du milieu est ajouté à la croissance exponentielle au lieu d’être soustrait ? Expliquez.</p>
</div>
</div>
</div>
</section>
<section id="sec-lotka" class="level2 page-columns page-full" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sec-lotka"><span class="header-section-number">5.7</span> Modèle prédateur-proie de Lotka-Volterra</h2>
<p>Vous allez maintenant étudier le modèle prédateur-proie tel que formulé par Lotka et Volterra et dont les éuqations vous ont été décrites dans le cours magistral de “fonctionnement des écosystèmes” :</p>
<p><span class="math display">\[
    \left\{
    \begin{array}{rcl}
        \displaystyle \frac{dX}{dt} &amp; = &amp; rX - \frac{r}{K}X^2 - c_1XY \\
        &amp; &amp; \\
        \displaystyle \frac{dY}{dt} &amp; = &amp; -mY + c_2XY
    \end{array}
    \right.
\]</span> avec <span class="math inline">\(X\)</span>, l’abondance des proies, <span class="math inline">\(Y\)</span>, l’abondance des prédateurs, <span class="math inline">\(r\)</span> le taux de croissance instantanée des proies, <span class="math inline">\(K\)</span> la capacité biotique du milieu, <span class="math inline">\(m\)</span> le taux de mortalité instantanée des prédateurs, <span class="math inline">\(c_1\)</span> l’effet négatif de la prédation sur les proies (<em>i.e.</em> la mortalité des proies causée par les rencontres avec les prédateurs) et <span class="math inline">\(c_2\)</span> l’effet positif de la prédation sur les prédateurs (<em>i.e.</em> la croissance de la population de prédateurs causée par les rencontres avec les proies).</p>
<p>En utilisant la même démarche que précédemment, construisez un modèle de Lotka-Volterra avec les valeurs suivantes :</p>
<ul>
<li>Abondance initiale des proies : <span class="math inline">\(X_0 = 1\)</span></li>
<li>Abondance initiale des prédateurs : <span class="math inline">\(Y_0 = 10\)</span></li>
<li>Taux de croissance instantanée des proies : <span class="math inline">\(r = 0.05\)</span></li>
<li>Taux de mortalité instantanée des prédateurs : <span class="math inline">\(m = 0.05\)</span></li>
<li>Capacité biotique du milieu : <span class="math inline">\(K = 50\)</span></li>
<li>Effet de la prédation sur les proies : <span class="math inline">\(c_1 = 0.01\)</span></li>
<li>Effet de la prédation sur les prédateurs : <span class="math inline">\(c_2 = 0.01\)</span></li>
<li>Durée de la simulation : 1000 pas de temps</li>
</ul>
<p>Avec ce modèle, il vous faut calculer en parallèle l’abondance de 2 populations : celle des proies et celle des prédateurs.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Calcul simultané
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention : il est impossible de calculer d’abord toutes les abondances des proies, puis ensuite toutes les abondances des prédateurs, dans 2 boucles <code>for</code> distinctes. À chaque nouveau pas de temps, au sein d’une unique boucle <code>for</code>, il faut :</p>
<ol type="1">
<li>calculer la nouvelle abondance des proies à partir de l’abondance des proies et des prédateurs au temps précédent</li>
<li>calculer la nouvelle abondance des prédateurs à partir de l’abondance des proies et des prédateurs au temps précédent</li>
</ol>
</div>
</div>
<p>Au final, l’objet <code>res</code> qui contiendra les résultats de vos simulation devra donc posséder 3 colonnes :</p>
<ol type="1">
<li>Une colonne <code>Generation</code> contenant le numéro des étapes de simulation (les pas de temps)</li>
<li>Une colonne <code>X</code> contenant les abondances de la population de proies à chaque étape de simulation</li>
<li>Une colonne <code>Y</code> contenant les abondances de la population de prédateurs à chaque étape de simulation</li>
</ol>
<p>Avec ce tableau <code>res</code>, vous devriez pouvoir produire le diagramme des phases suivants :</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-lotka" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-lotka-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.4: Modèle de Lotka-Volterra avec <span class="math inline">\(X_0 = 1\)</span>, <span class="math inline">\(Y_0 = 10\)</span>, <span class="math inline">\(r = 0.05\)</span>, <span class="math inline">\(m = 0.05\)</span>, <span class="math inline">\(K = 80\)</span> et <span class="math inline">\(c_1 = c_2 = 0.01\)</span>. Le cercle violet indique les conditions initiales.</figcaption>
</figure>
</div>
</div>
</div>
<p>Pour faire ce graphique, vous aurez besoin d’utiliser la fonction <code>geom_path()</code> au lieu de <code>geom_line()</code>. En effet, <code>geom_line()</code> relie les points d’un graphique par ordre d’abscisse croissant :</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-DynamicSystems_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ça n’est pas ce que nous voulons obtenir ! On souhaite relier les points par ordre chronologique, donc dans l’ordre où ils apparaissent dans le tableau <code>res</code>.</p>
<p>Enfin, pour mieux visualiser la dynamique de ces deux populations au cours du temps, produisez le graphique suivant :</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-volterra" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-volterra-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.5: Modèle de Lotka-Volterra avec <span class="math inline">\(X_0 = 1\)</span>, <span class="math inline">\(Y_0 = 10\)</span>, <span class="math inline">\(r = 0.05\)</span>, <span class="math inline">\(m = 0.05\)</span>, <span class="math inline">\(K = 80\)</span> et <span class="math inline">\(c_1 = c_2 = 0.01\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>Pour produire ce graphique, vous aurez besoin de transformer le tableau <code>res</code> en format long. Une colonne <code>Espece</code> devra contenir soit <code>X</code>, soit <code>Y</code>, et une colonne <code>Abondance</code> devra contenir toutes les valeurs d’abondance des 2 espèces. Si vous ne savez plus comment faire, relisez <a href="https://besibo.github.io/BiometrieS4/01-dispersion.html#sec-pivot">le chapitre 1.3</a> du livre en ligne du semestre 4. Voilà à quoi devraient ressembler les premières lignes de votre tableau :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>res_long</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,002 × 3
   Generation Espece Abondance
        &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;
 1          0 X          1    
 2          0 Y         10    
 3          1 X          0.949
 4          1 Y          9.6  
 5          2 X          0.904
 6          2 Y          9.21 
 7          3 X          0.866
 8          3 Y          8.83 
 9          4 X          0.832
10          4 Y          8.47 
# ℹ 1,992 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour comprendre ce modèle…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Expérimentez et tentez de répondre aux questions suivantes :</p>
<ul>
<li>Quelle sera l’issue de ce modèle prédateur-proie ? Augmentez la durée de simulation pour le prouver.</li>
<li>Quelles seront les abondances des proies et des prédateurs quand l’équilibre sera atteint ?</li>
<li>Modifiez la capacité biotique de la proie. QUe se passe-t-il quand vous l’augmentez ? Que se passe-t-il quand vous la diminuez ? Est-ce normal ? Est-ce ce à quoi vous vous attendiez ?</li>
<li>Que se passe-t-il quand vous modifiez les valeurs des autres paramètres du modèle (<span class="math inline">\(r\)</span>, <span class="math inline">\(m\)</span>, <span class="math inline">\(c_1\)</span> et <span class="math inline">\(c_2\)</span>) ?</li>
<li>Trouvez une combinaison de valeurs qui produisent un système à l’équilibre dynamique (<em>i.e.</em> un système d’oscillations harmoniques avec un diagramme des phases présentant un attracteur cyclique ou une courbe fermée)</li>
<li>Est-ce que certaines combinaisons de paramètres produisent des résultats irréalistes ?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="sec-compet" class="level2 page-columns page-full" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="sec-compet"><span class="header-section-number">5.8</span> Modèle de compétition interspécifique</h2>
<p>Dans sa forme la plus simple, on considère un système de compétition entre 2 espèces présentant un modèle de croissance logistique. La compétition ajoutera un terme de mortalité pour chaque espèce :</p>
<p><span class="math display">\[
    \left\{
    \begin{array}{rcl}
        \displaystyle \frac{dX}{dt} &amp; = &amp; r_1X - \frac{r_1}{K_1}X^2 - c_1XY \\
        &amp; &amp; \\
        \displaystyle \frac{dY}{dt} &amp; = &amp; r_2Y - \frac{r_2}{K_2}Y^2 - c_2XY
    \end{array}
    \right.
\]</span></p>
<p>avec <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> l’abondance des deux espèces, <span class="math inline">\(r_1\)</span> et <span class="math inline">\(r_2\)</span> les taux de croissance instantanée des deux espèces, <span class="math inline">\(K_1\)</span> et <span class="math inline">\(K_2\)</span> les capacités biotiques pour les 2 espèces, et <span class="math inline">\(c_1\)</span> et <span class="math inline">\(c_2\)</span> les effets négatifs de la compétition sur chacune des 2 espèces (<em>i.e.</em> la mortalité causée par les rencontres entre les deux espèces en compétition).</p>
<p>En modifiant le système prédateur-proie précédent, codez ce système de compétition et essayez de trouver une combinaison de paramètres et de valeurs initiales permettant de reproduire les 4 situations décrites en cours :</p>
<ol type="1">
<li>Deux espèces très compétitives (avec différentes abondances initiales). Retrouvez-vous la ligne de catastrophe ?</li>
</ol>
<div class="cell page-columns page-full" data-fig.asp="0.4">
<div class="cell-output-display page-columns page-full">
<div id="fig-compet_strong" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-compet_strong-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.6: Diagramme des phases de 2 espèces en compétition : 2 espèces très compétitives avec des conditions initiales différentes.</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Deux espèces très peu compétitives</li>
<li>Première espèce plus compétitive que la seconde</li>
<li>Seconde espèce plus compétitive que la première</li>
</ol>
<div class="cell page-columns page-full" data-fig.asp="0.4">
<div class="cell-output-display page-columns page-full">
<div id="fig-compet" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-compet-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.7: Diagramme des phases de 2 espèces en compétition : 3 situations distinctes.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour comprendre ce modèle…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Attention à l’échelle des axes de vos graphiques. Pour bien comprendre ce qui se passe et retrouver les figures schématiques vues en cours, vous devez tenter de replacer les graphique produits ici dans un plan plus large.</p>
<p>Notez aussi que contrairement au modèle prédateur-proie, les modèles de compétition ne font pas apparaître de cycles sur les diagrammes des phases. L’évolution des abondances au cours du temps ne fait donc jamais apparaître d’oscillations.</p>
</div>
</div>
</div>
</section>
<section id="sec-multispe" class="level2 page-columns page-full" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="sec-multispe"><span class="header-section-number">5.9</span> Modèles à 3 espèces</h2>
<p>Sur la base des chapitres précédents, vous devriez maintenant pouvoir construire des modèles plus complexes, par exemple à 3 espèces en compétition, ou à 3 espèces dont 2 proies en compétition et une espèce de prédateur. La clé est ici de ne pas oublier de termes lorsque l’on construit le modèle : pour chaque espèce supplémentaire dans le modèle, la complexité augmente singulièrement. En effet, une espèce signifie une équation de plus dans le système, mais également des termes d’interaction supplémentaires dans les équations déjà existantes.</p>
<p>Par exemple, si on considère un système dans lequel 3 espèces sont présentes, deux espèces de proies en compétition et un prédateur, voilà à quoi ressemblent le système d’équations :</p>
<p><span class="math display">\[
    \left\{
    \begin{array}{rcl}
        \displaystyle \frac{dX}{dt} &amp; = &amp; r_1X - \frac{r_1}{K_1}X^2 - c_{12}XY - c_{13}XZ \\
        &amp; &amp; \\
        \displaystyle \frac{dY}{dt} &amp; = &amp; r_2Y - \frac{r_2}{K_2}Y^2 - c_{21}XY - c_{23}YZ \\
        &amp; &amp; \\
        \displaystyle \frac{dZ}{dt} &amp; = &amp; -mZ + c_{31}XZ + c_{32}YZ
    \end{array}
    \right.
\]</span></p>
<p>Ce système de 3 équations comprend maintenant 11 paramètres : <span class="math inline">\(r_1\)</span>, <span class="math inline">\(r_2\)</span>, <span class="math inline">\(K_1\)</span>, <span class="math inline">\(K_2\)</span>, <span class="math inline">\(m\)</span>, <span class="math inline">\(c_{12}\)</span>, <span class="math inline">\(c_{21}\)</span>, <span class="math inline">\(c_{13}\)</span>, <span class="math inline">\(c_{23}\)</span>, <span class="math inline">\(c_{31}\)</span> et <span class="math inline">\(c_{32}\)</span>.</p>
<p>Essayez de coder ce système et de produire une figure telle que la <a href="#fig-3spe">Figure&nbsp;<span>5.8</span></a>.</p>
<div class="cell page-columns page-full" data-fig.asp="0.5">
<div class="cell-output-display page-columns page-full">
<div id="fig-3spe" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="05-DynamicSystems_files/figure-html/fig-3spe-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption margin-caption">Figure&nbsp;5.8: Évolution de l’abondance de 2 espèces de proies en compétition et d’une espèce prédatrice. Ici, les 2 espèces de proies ont les mêmes caractéristiques démographiques et sont peu compétitives. Le prédateur a un impact plus important sur l’espèce de proie 2 (abondance Y) et conduit donc à son extinction.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pour comprendre ce modèle…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Expérimentez et tentez de répondre aux questions suivantes :</p>
<ul>
<li>Pouvez-vous trouver une combinaison de paramètres conduisant à la coexistence des 3 espèces ?</li>
<li>Pouvez-vous trouver une combinaison de paramètres conduisant à la coexistence de 2 des 3 espèces ?</li>
<li>Que se passe-t-il si on augmente légèrement la capacité biotique de la première espèce ? À quelle espèce cela devrait profiter le plus ? Est-ce ce que l’on observe ? Cela vous paraît-il logique ?</li>
<li>Dans le système d’équation ci-dessus, êtes-vous capables d’identifier à quoi correspondent chacun des termes ? Quels sont les termes qui rendent comptent de la compétition ? Quels sont les termes qui rendent compte de la prédation ?</li>
</ul>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-R-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley. 2023. <em>tidyverse: Easily Install and Load the Tidyverse</em>. <a href="https://CRAN.R-project.org/package=tidyverse">https://CRAN.R-project.org/package=tidyverse</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, et Dewey Dunnington. 2023. <em>ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.
</div>
<div id="ref-R-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, et Davis Vaughan. 2023. <em>dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-Cohortes.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse de cohortes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-MarkovChains.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Les Chaînes de Markov</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>