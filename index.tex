% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  a4paper,
  DIV=11,
  numbers=noendperiod,
  oneside]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[left=1in,marginparwidth=2.0in,textwidth=4.0in,marginparsep=0.3in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.33,0.33}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.42,0.45,0.49}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.36,0.77}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.01,0.18,0.38}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.42,0.45,0.49}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.42,0.45,0.49}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.36,0.77}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.36,0.77}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.42,0.45,0.49}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.33,0.33}{\underline{#1}}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{\textbf{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.36,0.77}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.44,0.26,0.76}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.01,0.18,0.38}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.42,0.45,0.49}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.14,0.16,0.18}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.14,0.16,0.18}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.44,0.26,0.76}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.84,0.23,0.29}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.42,0.45,0.49}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.36,0.77}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.01,0.18,0.38}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.01,0.18,0.38}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.89,0.38,0.04}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.01,0.18,0.38}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{1.00,0.33,0.33}{#1}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table des matières}
\else
  \newcommand\contentsname{Table des matières}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{Liste des Figures}
\else
  \newcommand\listfigurename{Liste des Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{Liste des Tables}
\else
  \newcommand\listtablename{Liste des Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{Liste des Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{HTML}{31BAE9}}
\makeatother
\makeatletter
\@ifpackageloaded{sidenotes}{}{\usepackage{sidenotes}}
\@ifpackageloaded{marginnote}{}{\usepackage{marginnote}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\makeatother
\ifLuaTeX
\usepackage[bidi=basic]{babel}
\else
\usepackage[bidi=default]{babel}
\fi
\babelprovide[main,import]{french}
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={TP de Biométrie  Semestre 5 },
  pdfauthor={Benoît Simon-Bouhet},
  pdflang={fr},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{TP de Biométrie Semestre 5}
\author{Benoît Simon-Bouhet}
\date{mercredi 22 février 2023}

\begin{document}
\maketitle
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[breakable, enhanced, sharp corners, interior hidden, boxrule=0pt, borderline west={3pt}{0pt}{shadecolor}, frame hidden]}{\end{tcolorbox}}\fi

\renewcommand*\contentsname{Table des matières}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\hypertarget{introduction}{%
\chapter*{Introduction}\label{introduction}}
\addcontentsline{toc}{chapter}{Introduction}

\hypertarget{objectifs}{%
\section*{Objectifs}\label{objectifs}}
\addcontentsline{toc}{section}{Objectifs}

Ce livre contient l'ensemble du matériel (contenus, exemples,
exercices\ldots) nécessaire à la réalisation des travaux pratiques de
\textbf{Biométrie} de l'EC `\emph{Outils pour l'étude et la
compréhension du vivant 4}' du semestre 5 de la licence Sciences de la
Vie de La Rochelle Université.

À la fin du semestre, vous devriez être capables de faire les choses
suivantes dans le logiciel \texttt{RStudio} :

\begin{itemize}
\tightlist
\item
  Explorer des jeux de données en produisant des résumés statistiques de
  variables de différentes nature (numériques continues ou
  catégorielles) et en produisant des graphiques appropriés
\item
  Calculer des statistiques descriptives (moyennes, médianes, quartiles,
  écart-types, variances, erreurs standard, intervalles de confiance,
  etc.) pour plusieurs sous-groupes de vos jeux de données, et les
  représenter sur des graphiques adaptés
\item
  Choisir et formuler des hypothèses adaptées à la question scientifique
  posée (hypothèses bilatérales ou unilatérales)
\item
  Choisir les tests statistiques permettant de répondre à une question
  scientifique précise selon la nature de la question posée et la nature
  des variables à disposition
\item
  Réaliser les tests usuels de comparaison de proportions et de moyennes
  (\(\chi^2\), \(t\) de Student à 1 ou 2 échantillons, appariés ou
  indépendants, etc.)
\item
  Vérifier les conditions d'application des tests, et le cas échéant,
  réaliser des tests non paramétriques équivalents
\item
  Interpréter correctement les résultats des tests pour répondre aux
  questions scientifiques posées
\item
  Identifier des cohortes dans une population et en étudier les
  caractéristiques et l'évolution temporelle
\item
  Simuler le comportement de populations théoriques simples suivant des
  modèles démographiques précis (mortalité exponentielle, croissance
  exponentielle, croissance logistique, système prédateur-proies de
  Lotka et Volterra, et systèmes de compétition à 2 ou 3 espèces\ldots)
\item
  Simuler, par chaînes de Markov, les successions écologiques dans un
  écosystème théorique
\end{itemize}

\hypertarget{pruxe9-requis}{%
\section*{Pré-requis}\label{pruxe9-requis}}
\addcontentsline{toc}{section}{Pré-requis}

Pour atteindre les objectifs fixés ici, et compte tenu du volume horaire
restreint qui est consacré aux TP et TEA de Biométrie au S5, je suppose
que vous possédez un certain nombre de pré-requis. En particulier, vous
devriez avoir à ce stade une bonne connaissance de l'interface des
logiciels \texttt{R} et \texttt{RStudio}, et vous devriez être capables
:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  de créer un \texttt{Rproject} et un script d'analyse dans
  \texttt{RStudio}
\item
  d'importer des jeux de données issus de tableurs dans \texttt{RStudio}
\item
  d'effectuer des manipulations de données simples (sélectionner des
  variables, trier des colonnes, filtrer des lignes, créer de nouvelles
  variables, etc.)
\item
  de produire des graphiques de qualité, adaptés à la fois aux variables
  dont vous disposez et aux questions auxquelles vous souhaitez
  répondre.
\end{enumerate}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-warning-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-warning-color}{\faExclamationTriangle}\hspace{0.5em}{Si ces pré-requis ne sont pas maîtrisés}, colbacktitle=quarto-callout-warning-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]

\begin{itemize}
\tightlist
\item
  mettez-vous à niveau de toute urgence en lisant attentivement
  \href{https://besibo.github.io/BiometrieS3/}{le livre en ligne de
  Biométrie du semestre 3}
\item
  mettez-vous en binôme avec un·e collègue qui a suivi l'EC Immersion
  \texttt{R} et \texttt{RStudio} en début de semestre. Ça ne vous
  dispensera pas de lire le livre en ligne de Biométrie S3, mais ça vous
  fera certainement gagner pas mal de temps.
\end{itemize}

\end{tcolorbox}

\hypertarget{organisation}{%
\section*{Organisation}\label{organisation}}
\addcontentsline{toc}{section}{Organisation}

\hypertarget{volume-de-travail}{%
\subsection*{Volume de travail}\label{volume-de-travail}}
\addcontentsline{toc}{subsection}{Volume de travail}

Les travaux pratiques et TEA de biométrie auront lieu entre le 17
octobre et le 02 décembre 2022 :

\begin{itemize}
\tightlist
\item
  Semaine 42 (du 17 au 21 octobre) : 1 séance de TP d'1h30 et 1 séance
  de TEA d'1h30
\item
  Semaine 43 (du 24 au 28 octobre) : 1 séance de TP d'1h30 et 1 séance
  de TEA d'1h30
\item
  Semaine 45 (du 07 au 10 novembre) : 1 séance de TP d'1h30 et 1 séance
  de TEA d'1h30
\item
  Semaine 46 (du 14 au 18 novembre) : 1 séance de TP d'1h30 et 1 séance
  de TEA d'1h30
\item
  Semaine 47 (du 21 au 25 novembre) : 1 séance de TP d'1h30 et 1 séance
  de TEA d'1h30
\item
  Semaine 48 (du 28 novembre au 02 décembre) : 1 séance de TP d'1h30 et
  1 séance de TEA d'1h30
\end{itemize}

\textbf{Tous les TP ont lieu en salle MSI 217. Tous les TEA sont à
distance.}

Au total, chaque groupe aura donc 6 séances de TP et 6 séances de TEA,
soit un total de 18 heures prévues dans vos emplois du temps. C'est peu
pour atteindre les objectifs fixés et il y aura donc évidemment du
travail personnel à fournir en dehors de ces séances. J'estime que vous
devrez fournir à peu près une vingtaine d'heures de travail personnel en
plus des séances prévues dans votre emploi du temps. Attention donc :
pensez bien à prévoir du temps dans vos plannings car le travail
personnel est essentiel pour progresser dans cette matière. J'insiste
sur l'importance de faire l'effort dès maintenant : vous allez en effet
avoir des enseignements qui reposent sur l'utilisation de ces logiciels
jusqu'à la fin du S6 (y compris pendant vos stage et, très
vraisemblablement, dans vos futurs masters également). C'est donc
maintenant qu'il faut acquérir des automatismes, cela vous fera gagner
énormément de temps ensuite.

\hypertarget{modalituxe9s-denseignement}{%
\subsection*{Modalités
d'enseignement}\label{modalituxe9s-denseignement}}
\addcontentsline{toc}{subsection}{Modalités d'enseignement}

Pour suivre cet enseignement vous pourrez utiliser les ordinateurs de
l'université, mais je ne peux que vous encourager à utiliser vos propres
ordinateurs, sous Windows, Linux ou MacOS. Lors de vos futurs stages et
pour rédiger vos comptes-rendus de TP, vous utiliserez le plus souvent
vos propres ordinateurs, autant prendre dès maintenant de bonnes
habitudes en installant les logiciels dont vous aurez besoin tout au
long de votre licence. Si vous n'avez pas suivi l'EC immersion et que
les logiciels \texttt{R} et \texttt{RStudio} ne sont pas encore
installés sur vos ordinateurs, suivez
\href{https://besibo.github.io/BiometrieS3/01-R-basics.html\#sec-install}{la
procédure décrite ici}. Si vous ne possédez pas d'ordinateur, manifestez
vous rapidement auprès de moi car des solutions existent (prêt par
l'université, travail sur tablette via
\href{https://rstudio.cloud}{RStudio cloud}\ldots).

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-important-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Important}, colbacktitle=quarto-callout-important-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]
L'essentiel du contenu de cet enseignement peut être abordé en
autonomie, à distance, grâce à ce livre en ligne, aux ressources mises à
disposition sur Moodle et à votre ordinateur personnel. Cela signifie
que \textbf{la présence physique lors de ces séances de TP n'est pas
obligatoire}.
\end{tcolorbox}

Plus que des séances de TP classiques, considérez plutôt qu'il s'agit de
\textbf{permanences non-obligatoires} : si vous pensez avoir besoin
d'aide, si vous avez des points de blocage ou des questions sur le
contenu de ce document ou sur les exercices demandés, alors venez poser
vos questions lors des séances de TP. Vous ne serez d'ailleurs pas tenus
de rester pendant 1h30 : si vous obtenez une réponse en 10 minutes et
que vous préférez travailler ailleurs, vous serez libres de repartir !

De même, si vous n'avez pas de difficulté de compréhension, que vous
n'avez pas de problème avec les exercices de ce livre en ligne ni avec
les quizz Moodle, votre présence n'est pas requise. Si vous souhaitez
malgré tout venir en salle de TP, pas de problème, vous y serez toujours
les bienvenus.

Ce fonctionnement très souple a de nombreux avantages :

\begin{itemize}
\tightlist
\item
  vous vous organisez comme vous le souhaitez
\item
  vous ne venez que lorsque vous en avez vraiment besoin
\item
  celles et ceux qui se déplacent reçoivent une aide personnalisée
\item
  vous travaillez sur vos ordinateurs
\item
  les effectifs étant réduits, c'est aussi plus confortable pour moi !
\end{itemize}

Toutefois, pour que cette organisation fonctionne, cela demande de la
rigueur de votre part, en particulier sur la régularité du travail que
vous devez fournir. Si la présence en salle de TP n'est pas requise,
\textbf{le travail demandé est bel et bien obligatoire} ! Si vous venez
en salle de TP sans avoir travaillé en amont, votre venue sera
totalement inutile puisque vous n'aurez pas de question à poser et que
vous passerez votre séance à lire et suivre ce livre en ligne, choses
que vous pouvez très bien faire chez vous. Vous perdrez donc votre
temps, celui de vos collègues, et le mien. De même, si vous attendez la
4e semaine pour vous y mettre, vous irez droit dans le mur. Je le
répète, outre les heures de TP/TEA prévus dans vos emplois du temps,
vous devez prévoir au moins 20 heures de travail personnel
supplémentaire.

Je vous laisse donc une grande liberté d'organisation. À vous d'en tirer
le maximum et de faire preuve du sérieux nécessaire. Le rythme auquel
vous devriez avancer est présenté dans la partie suivante intitulée
``Progression conseillée''.

\hypertarget{utilisation-de-slack}{%
\subsection*{Utilisation de Slack}\label{utilisation-de-slack}}
\addcontentsline{toc}{subsection}{Utilisation de Slack}

Outre les séances de permanence non-obligatoires, nous échangerons aussi
sur \href{https://slack.com/intl/fr-fr/}{l'application Slack}, qui
fonctionne un peu comme un ``twitter privé''. Slack facilite la
communication des équipes et permet de travailler ensemble. Créez-vous
un compte en ligne et installez le logiciel sur votre ordinateur (il
existe aussi des versions pour tablettes et smartphones). Lorsque vous
aurez installé le logiciel,
\href{https://join.slack.com/t/l3sv22-23ecoutil/shared_invite/zt-1hmldkjae-Y9VADlxH~iM5u3PPMUF9_A}{cliquez
sur ce lien} pour vous connecter à notre espace de travail commun
intitulé \texttt{L3\ SV\ 22-23\ /\ EC\ outils} (ce lien expire
régulièrement : faites moi signe s'il n'est plus valide).

Vous verrez que 3 ``chaînes'' sont disponibles :

\begin{itemize}
\tightlist
\item
  \#général : c'est là que les questions liées à l'organisation générale
  du cours, des TP et TEA, des évaluations, etc. doivent être posées. Si
  vous ne savez pas si une séance de permanence a lieu, posez la
  question ici.
\item
  \#questions-rstudio : c'est ici que toutes les questions pratiques
  liées à l'utilisation de \texttt{R} et \texttt{RStudio} devront êtres
  posées. Problèmes de syntaxe, problèmes liés à l'interface, à
  l'installation des packages ou à l'utilisation des fonctions, à la
  création des graphiques, à la manipulation des tableaux\ldots{} Tout
  ce qui concerne directement les logiciels sera traité ici. Vous êtes
  libres de poser des questions, de poster des captures d'écran, des
  morceaux de code, des messages d'erreur. Et \textbf{vous êtes bien
  entendus vivement encouragés à vous entraider et à répondre aux
  questions de vos collègues.} Je n'interviendrai ici que pour répondre
  aux questions laissées sans réponse ou si les réponses apportées sont
  inexactes. Le fonctionnement est celui d'un forum de discussion
  instantané. Vous en tirerez le plus grand bénéfice en participant et
  en n'ayant pas peur de poser des questions, même si elles vous
  paraissent idiotes. Rappelez-vous toujours que si vous vous posez une
  question, d'autres se la posent aussi probablement.
\item
  \#questions-stats : C'est ici que vous pourrez poser vos questions
  liées aux méthodes statistiques ou aux choix des modèles de dynamique
  des populations. Tout ce qui ne concerne pas directement l'utilisation
  du logiciel (comme par exemple le choix d'un test ou des hypothèses
  nulles et alternatives, la démarche d'analyse, la signification de tel
  paramètre ou estimateur, le principe de telle ou telle méthode\ldots)
  peut être discuté ici. Comme pour le canal \#questions-rstudio,
  \textbf{vous êtes encouragés à vous entraider et à répondre aux
  questions de vos collègues}.
\end{itemize}

Ainsi, quand vous travaillerez à vos TP ou TEA, que vous soyez installés
chez vous ou en salle de TP, prenez l'habitude de garder Slack ouvert
sur votre ordinateur. Même si vous n'avez pas de question à poser, votre
participation active pour répondre à vos collègues est souhaitable et
souhaitée. Je vous incite donc fortement à vous \textbf{entraider} :
c'est très formateur pour celui qui explique, et celui qui rencontre une
difficulté a plus de chances de comprendre si c'est quelqu'un d'autre
qui lui explique plutôt que la personne qui a rédigé les instructions
mal comprises.

Ce document est fait pour vous permettre d'avancer en autonomie et vous
ne devriez normalement pas avoir beaucoup besoin de moi si votre lecture
est attentive. L'expérience montre en effet que la plupart du temps, il
suffit de lire correctement les paragraphes précédents et/ou suivants
pour obtenir la réponse à ses questions. J'essaie néanmoins de rester
disponible sur Slack pendant les séances de TP et de TEA de tous les
groupes. Cela veut donc dire que même si votre groupe n'est pas en TP,
vos questions ont des chances d'être lues et de recevoir des réponses
dès que d'autres groupes sont en TP ou TEA. Vous êtes d'ailleurs
encouragés à échanger sur Slack aussi pendant vos phases de travail
personnel.

\hypertarget{progession-conseilluxe9e}{%
\section*{Progession conseillée}\label{progession-conseilluxe9e}}
\addcontentsline{toc}{section}{Progession conseillée}

Si vous avez suivi le document de prise en main de \texttt{R} et
\texttt{RStudio} (lors de l'immersion ou lors d'une remise à niveau en
autonomie), vous savez que pour apprendre à utiliser ces logiciels, il
faut faire les choses soi-même, ne pas avoir peur des messages d'erreurs
(il faut d'ailleurs apprendre à les déchiffrer pour comprendre d'où
viennent les problèmes), essayer maintes fois, se tromper beaucoup,
recommencer, et surtout, ne pas se décourager. J'utilise ce logiciel
presque quotidiennement depuis plus de 15 ans et à chaque session de
travail, je rencontre des messages d'erreur. Avec suffisamment
d'habitude, on apprend à les déchiffrer, et on corrige les problèmes en
quelques secondes. Ce livre est conçu pour vous faciliter la tâche, mais
ne vous y trompez pas, vous rencontrerez des difficultés, et c'est
normal. C'est le prix à payer pour profiter de la puissance du meilleur
logiciel permettant d'analyser des données, de produire des graphiques
de qualité et de réaliser toutes les statistiques dont vous aurez besoin
d'ici la fin de vos études et au-delà.

Pour que cet apprentissage soit le moins problématique possible, il
convient de prendre les choses dans l'ordre. C'est la raison pour
laquelle les chapitres de ce livre doivent être lus dans l'ordre, et les
exercices d'application faits au fur et à mesure de la lecture.

Idéalement, voilà les étapes que vous devriez avoir franchi chaque
semaine :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  La première semaine (42) est consacrée l'exploration statistique des
  jeux de données. Avant votre seconde séance de TP, vous devriez avoir
  compris comment calculer et interpréter des résumés statistiques de
  vos jeux de données. Vous devriez en particulier être capable de
  calculer des estimateurs de position (moyennes, médianes,
  quartiles\ldots) et de dispersion (variances, écart-types, intervalles
  inter-quartiles\ldots) sur des variables numériques, et ce, pour
  plusieurs modalités d'une variable catégorielle ou pour chaque
  combinaison de modalités de plusieurs variables catégorielles (par
  exemple, quelles sont les moyennes et variances des longueurs de becs
  pour chaque espèce de manchots et chaque sexe). Vous devrez être
  capables de distinguer la notion de dispersion de celle de précision,
  et vous devrez être capables de calculer l'erreur standard de la
  moyenne (ou erreur type). Vous devrez en outre être capables de
  produire des graphiques sur lesquels apparaissent des barres
  d'incertitude (erreurs standards ou intervalles de confiance).
\item
  La deuxième semaine (43) est consacrée aux tests statistiques. Avant
  votre troisième séance de TP, vous devriez être capable de formuler
  des hypothèses nulles et alternatives pertinentes, et vous devriez
  connaître le concept de \(p-\)value. Vous devriez en outre être
  capables, avec des données de comptages, de réaliser des tests de
  comparaison de proportions, et d'en interpréter correctement les
  résultats.
\item
  La troisième semaine (45) est également consacrée aux tests
  d'hypothèses. Avant votre quatrième séance de TP, vous devriez être
  capable de comparer la moyenne d'une population à une valeur
  théorique, et de comparer la moyenne de 2 populations, dans le cas où
  vous disposez d'échantillons appariés. Dans les deux cas, vous devrez
  être capable de vérifier les conditions d'application des tests
  paramétriques, et de choisir des tests non-paramétriques équivalents
  si les conditions d'application ne sont pas vérifiées.
\item
  La quatrième semaine (46) est consacrée aux derniers tests de
  comparaison de moyennes. Avant votre cinquième séance de TP, vous
  devrez donc être capable de comparer la moyenne de deux populations
  lorsque les échantillons sont indépendants. Comme pour la semaine
  précédente, vous devrez être capable de vérifier les conditions
  d'application du test paramétrique, et de réaliser le tests non
  paramétrique équivalent le cas échéant. Enfin, vous devrez aussi être
  en mesure de spécifier les hypothèses alternatives unilatérales ou
  bilatérales pertinentes selon la question scientifique posée. Pour
  chaque semaine consacrée aux tests, vous devrez aussi toujours penser
  à examiner les données graphiquement, et par le biais des statistiques
  descriptives décrites lors de la première semaine
\item
  La cinquième semaine (47) est consacrée à la mise en pratique des
  notions vues dans le cours magistral de Population Dynamics (EC
  ``Fonctionnement des Écosystèmes). Nous aborderons ici les analyses de
  cohorte. Avant votre dernière séance de TP, vous devriez être en
  mesure de réaliser l'analyse de cohorte d'une population étudiée
  pendant plusieurs années afin de produire les courbes de croissance,
  de survie et d'Allen d'une cohorte d'intérêt. Vous devrez en
  particulier importer et mettre en forme des données issues d'un suivi
  de terrain, produire les structures démographiques instantanées à
  chaque date d'échantillonnage, faire les décompositions polymodales
  afin de récupérer les informations utiles au sujet de la cohorte dont
  on souhaite assurer le suivi.
\item
  La sixième semaine (48) est consacrée à la mise en pratique des
  notions vues dans le cours magistral de Population Dynamics (EC
  ``Fonctionnement des Écosystèmes). Nous aborderons ici l'étude des
  systèmes dynamiques. Vous devrez coder différents modèles d'évolution
  d'une populations (mortalité exponentielle, croissance exponentielle,
  croissance logistique) ou de plusieurs populations ou espèces (modèle
  prédateurs-proies, modèle de compétition). Ces modèles généreront des
  données que vous devrez représenter graphiquement. Vous devrez enfin
  modifier la valeur de certains paramètres de ces modèles afin de
  comprendre leur influence sur le comportement des systèmes dynamiques
  étudiés.
\end{enumerate}

\hypertarget{uxe9valuations}{%
\section*{Évaluation(s)}\label{uxe9valuations}}
\addcontentsline{toc}{section}{Évaluation(s)}

L'évaluation de la partie ``Biométrie'' de l'EC ``Outils pour l'étude et
la compréhension du vivant'' aura lieu dans le cadre du travail de
stratégie d'échantillonnage que vous mettez en œuvre avec Pierrick
Bocher. Le compte-rendu de stratégie d'échantillonnage servira donc à
évaluer 3 choses :

\begin{itemize}
\tightlist
\item
  les grands principes de stratégie d'échantillonnage abordés par
  Pierrick
\item
  la mise en œuvre de méthodes statistiques adaptées pour répondre aux
  questions scientifiques posées, telles que nous les traitons en
  Biométrie
\item
  la maîtrise du logiciel \texttt{RStudio} pour réaliser les analyses de
  données pertinentes (de l'importation des données et leur mise en
  forme dans le logiciel, à la réalisation et l'interprétation correcte
  des tests statistiques appropriés, en passant par l'exploration des
  statistiques descriptives et la création de graphiques informatifs).
  Pour ce dernier volet, vous devrez rendre, en plus de votre
  compte-rendu, votre script d'analyse. C'est ce script qui me permettra
  d'évaluer votre niveau de compétence et de maîtrise de l'outil, tant
  sur la forme du script (lisibilité, structure, reproductibilité, etc.)
  que sur le fond (pertinence des analyses réalisées).
\end{itemize}

Pour vous aider à comprendre ce qui est attendu, je vous fournis
ci-dessous la grille critériée dont je me servirai pour évaluer la forme
de votre script. Je ne peux que vous encourager à lire attentivement les
critères d'évaluation ci-dessous et à tenter de vous les approprier. Les
séances de TP et de TEA qui viennent doivent vous permettre de vous
entraîner à produire des scripts de qualité.

\includegraphics{./images/Grille.png}

Pour ce qui est du fond (pertinence des analyses statistiques réalisées
et de leurs interprétations), une autre grille critériée sera fournie
ici avant la fin du semestre.

\hypertarget{licence}{%
\section*{Licence}\label{licence}}
\addcontentsline{toc}{section}{Licence}

Ce livre est ligne est sous licence Creative Commons
(\href{https://creativecommons.org/licenses/by-nc-nd/4.0/deed.fr}{CC
BY-NC-ND 4.0})

\begin{figure}

{\centering 

\href{https://creativecommons.org/licenses/by-nc-nd/4.0/deed.fr}{\includegraphics{./images/cc_licence.png}}

}

\end{figure}

Vous êtes autorisé à partager, copier, distribuer et communiquer ce
matériel par tous moyens et sous tous formats, tant que les conditions
suivantes sont respectées :

{\faIcon{creative-commons-by}} \textbf{Attribution} : vous devez
créditer ce travail (donc citer son auteur), fournir un lien vers ce
livre en ligne, intégrer un lien vers la licence Creative Commons et
indiquer si des modifications du contenu original ont été effectuées.
Vous devez indiquer ces informations par tous les moyens raisonnables,
sans toutefois suggérer que l'auteur vous soutient ou soutient la façon
dont vous avez utilisé son travail.

{\faIcon{creative-commons-nc-eu}} \textbf{Pas d'Utilisation Commerciale}
: vous n'êtes pas autorisé à faire un usage commercial de cet ouvrage,
ni de tout ou partie du matériel le composant. Cela comprend évidemment
la diffusion sur des plateformes de partage telles que studocu.com qui
tirent profit d'œuvres dont elles ne sont pas propriétaires, souvent à
l'insu des auteurs.

{\faIcon{creative-commons-nd}} \textbf{Pas de modifications} : dans le
cas où vous effectuez un remix, que vous transformez, ou créez à partir
du matériel composant l'ouvrage original, vous n'êtes pas autorisé à
distribuer ou mettre à disposition l'ouvrage modifié.

{\faIcon{unlock-keyhole}} \textbf{Pas de restrictions complémentaires} :
vous n'êtes pas autorisé à appliquer des conditions légales ou des
mesures techniques qui restreindraient légalement autrui à utiliser cet
ouvrage dans les conditions décrites par la licence.

\bookmarksetup{startatroot}

\hypertarget{sec-EDA}{%
\chapter{Exploration statistique des données}\label{sec-EDA}}

\hypertarget{pruxe9-requis-1}{%
\section{Pré-requis}\label{pruxe9-requis-1}}

La première étape de toute analyse de données est l'exploration. Avant
de se lancer dans des tests statistiques et des procédures complexes, et
à supposer que les données dont vous disposez sont déjà dans un format
approprié, il est toujours très utile de :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  explorer visuellement les données dont on dispose en faisant des
  graphiques nombreux et variés, afin de comprendre, notamment quelle
  est la distribution des variables numériques, quelles sont les
  catégories les plus représentées pour les variables qualitatives (ou
  facteurs), quelles sont les relations les plus marquantes entre
  variables numériques et/ou catégorielles, etc. Vous avez déjà appris,
  au semestre 3, comment produire toutes sortes de graphiques avec le
  package \texttt{ggplot2}. Si vous avez besoin de revoir les bases,
  \href{https://besibo.github.io/BiometrieS3/03-visualization.html}{c'est
  là que ça se passe}
\item
  explorer les données en calculant des indices de statistiques
  descriptives. Ces indices relèvent en général de 2 catégories : les
  indices de position (e.g.~moyennes, médianes\ldots) et les indices de
  dispersion (e.g.~variance, écart-type, intervalle
  inter-quartiles\ldots). Nous allons voir dans ce chapitre comment
  calculer ces indices dans plusieurs situations, notamment lorsque l'on
  souhaite les calculer pour plusieurs sous-groupes d'un jeu de données
\end{enumerate}

Nous verrons également dans ce chapitre comment calculer des indices
d'incertitude. Attention, il ne faut pas confondre indices de dispersion
et indices d'incertitude. Nous y reviendrons plus loin.

Afin d'explorer ces questions, nous aurons besoin des packages suivants
:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(skimr)}
\FunctionTok{library}\NormalTok{(palmerpenguins)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

Les packages du \texttt{tidyverse} (Wickham 2022) permettent de
manipuler facilement des tableaux de données et de réaliser des
graphiques. Charger le \texttt{tidyverse} permet d'accéder, entre
autres, aux packages \texttt{readr} (Wickham, Hester, et Bryan 2022),
pour importer facilement des fichiers \texttt{.csv} au format
\texttt{tibble}, \texttt{dplyr} (Wickham et al. 2023) pour manipuler des
tableaux de données ou encore \texttt{ggplot2} (Wickham et al. 2022)
pour produire des graphiques. Le package \texttt{skimr} (Waring et al.
2022) permet de calculer des résumés de données très informatifs. Les
packages \texttt{palmerpenguins} (Horst, Hill, et Gorman 2022) et
\texttt{nycflights13} (Wickham 2021) fournissent des jeux de données qui
seront faciles à manipuler pour illustrer ce chapitre (et les suivants).

Attention, pensez à installer ces packages avant de les charger en
mémoire. Si vous ne savez plus comment faire, consultez d'urgence
\href{https://besibo.github.io/BiometrieS3/01-R-basics.html\#sec-packages}{la
section dédiée au package du livre en ligne de Biométrie du semestre 3}.

De même, pour travailler dans de bonnes conditions, créez un nouveau
dossier sur votre ordinateur, créez un Rproject et un script dans ce
dossier et travaillez systématiquement dans votre script. Là encore,
consultez
\href{https://besibo.github.io/BiometrieS3/01-R-basics.html\#sec-code}{le
livre en ligne du semestre 3} si vous ne savez plus comment faire.

\hypertarget{cruxe9er-des-ruxe9sumuxe9s-avec-les-fonctions-group_by-et-summarise}{%
\section{\texorpdfstring{Créer des résumés avec les fonctions
\texttt{group\_by()} et
\texttt{summarise()}}{Créer des résumés avec les fonctions group\_by() et summarise()}}\label{cruxe9er-des-ruxe9sumuxe9s-avec-les-fonctions-group_by-et-summarise}}

Comme nous l'avons vu au semestre 3, le package \texttt{dplyr} fournit
plusieurs fonctions qui portent le nom de verbes simples et qui
permettent d'effectuer des manipulations simples mais qui peuvent
devenir très puissantes lorsqu'on les combine. Nous avons ainsi vu les
fonctions suivantes :

\begin{itemize}
\tightlist
\item
  \texttt{select()} : pour sélectionner ou exclure certaines colonnes
  (variables) d'un tableau de données
\item
  \texttt{filter()} : pour trier des lignes d'un tableau de données
  selon des critères ou conditions choisis par l'utilisateur
\item
  \texttt{mutate()} : pour transformer des variables existantes, ou pour
  créer de nouvelles colonnes dans un tableau de données
\item
  \texttt{arrange()} : pour trier des tableaux de données par ordre
  croissants ou décroissants
\end{itemize}

Si vous ne savez plus comment utiliser ces fonctions, relisez
\href{https://besibo.github.io/BiometrieS3/04-DataWrangling.html}{le
chapitre 4 du livre en ligne de Biométrie du semestre 3}.

À ces 4 verbes, on ajoute en général les 3 suivants :

\begin{itemize}
\tightlist
\item
  \texttt{summarise()} : pour créer des résumés de données à partir des
  colonnes d'un tableau
\item
  \texttt{group\_by()} : pour effectuer des opérations pour chaque
  niveau d'un facteur (ou modalité d'une variable catégorielle)
\item
  \texttt{count()} : pour compter le nombre d'observations pour chaque
  niveau d'un facteur (ou modalité d'une variable catégorielle)
\end{itemize}

Voyons comment on utilise ces fonctions pour calculer des indices de
statistiques descriptives pour les variables du tableau
\texttt{penguins} :

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# affichage du tableau}
\NormalTok{penguins}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 344 x 8
   species island    bill_length_mm bill_depth_mm flipper_~1 body_~2 sex    year
   <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>
 1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007
 2 Adelie  Torgersen           39.5          17.4        186    3800 fema~  2007
 3 Adelie  Torgersen           40.3          18          195    3250 fema~  2007
 4 Adelie  Torgersen           NA            NA           NA      NA <NA>   2007
 5 Adelie  Torgersen           36.7          19.3        193    3450 fema~  2007
 6 Adelie  Torgersen           39.3          20.6        190    3650 male   2007
 7 Adelie  Torgersen           38.9          17.8        181    3625 fema~  2007
 8 Adelie  Torgersen           39.2          19.6        195    4675 male   2007
 9 Adelie  Torgersen           34.1          18.1        193    3475 <NA>   2007
10 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007
# ... with 334 more rows, and abbreviated variable names 1: flipper_length_mm,
#   2: body_mass_g
\end{verbatim}

\hypertarget{principe-de-la-fonction-summarise}{%
\subsection{\texorpdfstring{Principe de la fonction
\texttt{summarise()}}{Principe de la fonction summarise()}}\label{principe-de-la-fonction-summarise}}

\begin{figure}

{\centering \includegraphics[width=0.55\textwidth,height=\textheight]{./images/summarizearrow.png}

}

\end{figure}

\begin{figure}

{\centering \includegraphics[width=0.4\textwidth,height=\textheight]{./images/summarize.png}

}

\caption{\label{fig-summarise2}Schéma de la fonction
\texttt{summarise()} tiré de la `cheatsheet' de \texttt{dplyr} et
\texttt{tidyr}}

\end{figure}

La Figure~\ref{fig-summarise2} ci-dessus indique comment travaille la
fonction \texttt{summarise()} : elle prend plusieurs valeurs
(potentiellement, un très grand nombre) et les réduit à une unique
valeur qui les résume. Lorsque l'on applique cette démarche à plusieurs
colonnes d'un tableau, on obtient un tableau qui ne contient plus qu'une
unique ligne de résumé.

La valeur qui résume les données est choisie par l'utilisateur. Il peut
s'agir par exemple d'un calcul moyenne ou de variance, il peut s'agir de
calculer une somme, ou d'extraire la valeur maximale ou minimale, ou
encore, il peut tout simplement s'agir de déterminer un nombre
d'observations.

Ainsi, pour connaître la moyenne et l'écart-type de la longueur du bec
des manchots de l'île de Palmer, il suffit d'utiliser le tableau
\texttt{penguins} du package \texttt{palmerpenguins} et sa variable
\texttt{bill\_length\_mm} que nous avons déjà utilisés au semestre 3 :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm),}
            \AttributeTok{ecart\_type =} \FunctionTok{sd}\NormalTok{(bill\_length\_mm))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 2
  moyenne ecart_type
    <dbl>      <dbl>
1      NA         NA
\end{verbatim}

Les fonctions \texttt{mean()} et \texttt{sd()} permettent de calculer
une moyenne et un écart-type respectivement. Ici, les valeurs retournées
sont \texttt{NA} car 2 individus n'ont pas été mesurés, et le tableau
contient donc des valeurs manquantes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(bill\_length\_mm))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 2 x 8
  species island    bill_length_mm bill_depth_mm flipper_l~1 body_~2 sex    year
  <fct>   <fct>              <dbl>         <dbl>       <int>   <int> <fct> <int>
1 Adelie  Torgersen             NA            NA          NA      NA <NA>   2007
2 Gentoo  Biscoe                NA            NA          NA      NA <NA>   2009
# ... with abbreviated variable names 1: flipper_length_mm, 2: body_mass_g
\end{verbatim}

Pour obtenir les valeurs souhaitées, il faut indiquer à \texttt{R}
d'exclure les valeurs manquantes lors des calculs de moyenne et
écart-types :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{ecart\_type =} \FunctionTok{sd}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 2
  moyenne ecart_type
    <dbl>      <dbl>
1    43.9       5.46
\end{verbatim}

La longueur moyenne du bec des manchots est donc de 43.9 millimètres et
l'écart-type vaut 5.5 millimètres.

La fonction \texttt{summarise()} permet donc de calculer des indices
statistiques variés, et sur plusieurs variables à la fois. Par exemple.
pour calculer les moyennes, médianes, minima et maxima des longueurs de
nageoires et de masses corporelles, on peut procéder ainsi :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moy\_flip =} \FunctionTok{mean}\NormalTok{(flipper\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{med\_flip =} \FunctionTok{median}\NormalTok{(flipper\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{min\_flip =} \FunctionTok{min}\NormalTok{(flipper\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{max\_flip =} \FunctionTok{max}\NormalTok{(flipper\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{moy\_mass =} \FunctionTok{mean}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{med\_mass =} \FunctionTok{median}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{min\_mass =} \FunctionTok{min}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{max\_mass =} \FunctionTok{max}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 8
  moy_flip med_flip min_flip max_flip moy_mass med_mass min_mass max_mass
     <dbl>    <dbl>    <int>    <int>    <dbl>    <dbl>    <int>    <int>
1     201.      197      172      231    4202.     4050     2700     6300
\end{verbatim}

La fonction \texttt{summarise()} est donc très utile pour produire des
résumés informatifs des données, mais nos exemples ne sont ici pas très
pertinents puisque nous avons jusqu'ici calculé des indices sans
distinguer les espèces. Si les 3 espèces de manchots ont des
caractéristiques très différentes, calculer des moyennes toutes espèces
confondues n'a pas de sens. Voyons maintenant comment obtenir ces même
indices pour chaque espèce.

\hypertarget{intuxe9ruxeat-de-la-fonction-group_by}{%
\subsection{\texorpdfstring{Intérêt de la fonction
\texttt{group\_by()}}{Intérêt de la fonction group\_by()}}\label{intuxe9ruxeat-de-la-fonction-group_by}}

La fonction \texttt{summarise()} devient particulièrement puissante
lorsqu'elle est combinée avec la fonction \texttt{group\_by()} :

\begin{figure}

{\centering \includegraphics[width=0.65\textwidth,height=\textheight]{./images/groupby.png}

}

\caption{\label{fig-groupby}Fonctionnement de \texttt{group\_by()}
travaillant de concert avec \texttt{summarise()}, tiré de la
`cheatsheet' de \texttt{dplyr} et \texttt{tidyr}}

\end{figure}

Comme son nom l'indique, la fonction \texttt{group\_by()} permet de
créer des sous-groupes dans un tableau, afin que le résumé des données
soit calculé pour chacun des sous-groupes plutôt que sur l'ensemble du
tableau. En ce sens, son fonctionnement est analogue à celui des
\texttt{facet}s de \texttt{ggplot2} qui permettent de scinder les
données d'un graphique en plusieurs sous-groupes.

Pour revenir à l'exemple de la longueur du bec des manchots, imaginons
que nous souhaitions calculer les moyennes et les écart-types pour
chacune des trois espèces. Voilà comment procéder :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{ecart\_type =} \FunctionTok{sd}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 3
  species   moyenne ecart_type
  <fct>       <dbl>      <dbl>
1 Adelie       38.8       2.66
2 Chinstrap    48.8       3.34
3 Gentoo       47.5       3.08
\end{verbatim}

Ici, les étapes sont les suivantes :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  On prend le tableau \texttt{penguins}, \emph{puis}
\item
  On groupe les données selon la variable \texttt{species}, \emph{puis}
\item
  On résume les données groupées sous la forme de moyennes et
  d'écart-types
\end{enumerate}

Là où nous avions auparavant une seule valeur de moyenne et d'écart-type
pour l'ensemble des individus du tableau de données, nous avons
maintenant une valeur de moyenne et d'écart-type pour chaque modalité de
la variable espèce. Puisque le facteur \texttt{species} contient 3
modalités (\texttt{Adelie}, \texttt{Chinstrap} et \texttt{Gentoo}), le
résumé des données contient maintenant 3 lignes.

Nous pouvons aller plus loin. Ajoutons à ce résumé 2 variables
supplémentaires : le nombre de mesures et l'\textbf{erreur standard}
(notée \(se\)), qui peut être calculée de la façon suivante :

\[se \approx \frac{s}{\sqrt{n}}\]

avec \(s\), l'écart-type de l'échantillon et \(n\), la taille de
l'échantillon (plus d'informations sur cette statistique très importante
dans la Section~\ref{sec-disp}). Nous allons donc calculer ici ces
résumés, et nous donnerons un nom au tableau créé pour pouvoir
ré-utiliser ces statistiques descriptives :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_esp }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{ecart\_type =} \FunctionTok{sd}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{nb\_obs =} \FunctionTok{n}\NormalTok{(),}
            \AttributeTok{erreur\_std =}\NormalTok{ ecart\_type }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(nb\_obs))}
\NormalTok{stats\_esp}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 5
  species   moyenne ecart_type nb_obs erreur_std
  <fct>       <dbl>      <dbl>  <int>      <dbl>
1 Adelie       38.8       2.66    152      0.216
2 Chinstrap    48.8       3.34     68      0.405
3 Gentoo       47.5       3.08    124      0.277
\end{verbatim}

Vous constatez ici que nous avons 4 statistiques descriptives pour
chaque espèce. Deux choses sont importantes à retenir ici :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  on peut obtenir le nombre d'observations dans chaque sous-groupe d'un
  tableau groupé en utilisant la fonction \texttt{n()}. Cette fonction
  n'a besoin d'aucun argument : elle détermine automatiquement la taille
  des groupes créés par \texttt{group\_by()}.
\item
  on peut créer de nouvelles variables en utilisant le nom de variables
  créées auparavant. Ainsi, nous avons créé la variable
  \texttt{erreur\_std} en utilisant deux variables créées au préalable :
  \texttt{ecart-type} et \texttt{nb\_obs}
\end{enumerate}

\hypertarget{grouper-par-plus-dune-variable}{%
\subsection{Grouper par plus d'une
variable}\label{grouper-par-plus-dune-variable}}

Jusqu'ici, nous avons groupé les données par espèce. Il est tout à fait
possible de grouper les données par plus d'une variable, par exemple,
par espèce et par sexe :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_esp\_sex }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{ecart\_type =} \FunctionTok{sd}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{nb\_obs =} \FunctionTok{n}\NormalTok{(),}
            \AttributeTok{erreur\_std =}\NormalTok{ ecart\_type }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(nb\_obs))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'species'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_esp\_sex}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 8 x 6
# Groups:   species [3]
  species   sex    moyenne ecart_type nb_obs erreur_std
  <fct>     <fct>    <dbl>      <dbl>  <int>      <dbl>
1 Adelie    female    37.3       2.03     73      0.237
2 Adelie    male      40.4       2.28     73      0.267
3 Adelie    <NA>      37.8       2.80      6      1.14 
4 Chinstrap female    46.6       3.11     34      0.533
5 Chinstrap male      51.1       1.56     34      0.268
6 Gentoo    female    45.6       2.05     58      0.269
7 Gentoo    male      49.5       2.72     61      0.348
8 Gentoo    <NA>      45.6       1.37      5      0.615
\end{verbatim}

En plus de la variable \texttt{species}, la tableau
\texttt{stats\_esp\_sex} contient une variable \texttt{sex}. Les
statistiques que nous avons calculées plus tôt sont maintenant
disponibles pour chaque espèce et chaque sexe. D'ailleurs, puisque le
sexe de certains individus est inconnu, nous avons également des lignes
pour lesquelles le sexe affiché est \texttt{NA}. Pour les éliminer, il
suffit de retirer les lignes du tableau pour lesquelles le sexe des
individus est inconnu, puis de recalculer les mêmes indices :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_esp\_sex2 }\OtherTok{\textless{}{-}}\NormalTok{ penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{ecart\_type =} \FunctionTok{sd}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{nb\_obs =} \FunctionTok{n}\NormalTok{(),}
            \AttributeTok{erreur\_std =}\NormalTok{ ecart\_type }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(nb\_obs))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'species'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_esp\_sex2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 6
# Groups:   species [3]
  species   sex    moyenne ecart_type nb_obs erreur_std
  <fct>     <fct>    <dbl>      <dbl>  <int>      <dbl>
1 Adelie    female    37.3       2.03     73      0.237
2 Adelie    male      40.4       2.28     73      0.267
3 Chinstrap female    46.6       3.11     34      0.533
4 Chinstrap male      51.1       1.56     34      0.268
5 Gentoo    female    45.6       2.05     58      0.269
6 Gentoo    male      49.5       2.72     61      0.348
\end{verbatim}

Si vous ne comprenez pas la commande \texttt{filter(!is.na(sex))}, je
vous encourage vivement à consulter
\href{https://besibo.github.io/BiometrieS3/04-DataWrangling.html\#filtrer-des-lignes-avec-filter}{cette
section du livre en ligne de Biométrie du semestre 3}.

Enfin, lorsque nous groupons par plusieurs variables, il peut être utile
de présenter les résultats sous la forme d'un tableau large (grâce à la
fonction \texttt{pivot\_wider()}) pour l'intégration dans un rapport par
exemple. La fonction \texttt{pivot\_wider()} permet de passer d'un
tableau qui possède ce format :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'species'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 6 x 3
# Groups:   species [3]
  species   sex    moyenne
  <fct>     <fct>    <dbl>
1 Adelie    female    37.3
2 Adelie    male      40.4
3 Chinstrap female    46.6
4 Chinstrap male      51.1
5 Gentoo    female    45.6
6 Gentoo    male      49.5
\end{verbatim}

à un tableau sous ce format :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(bill\_length\_mm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ sex,}
              \AttributeTok{values\_from =}\NormalTok{ moyenne)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'species'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 3 x 3
# Groups:   species [3]
  species   female  male
  <fct>      <dbl> <dbl>
1 Adelie      37.3  40.4
2 Chinstrap   46.6  51.1
3 Gentoo      45.6  49.5
\end{verbatim}

Sous cette forme, les données ne sont plus ``rangées'', c'est à dire que
nous n'avons plus une observation par ligne et une variable par colonne.
En effet ici, la variable \texttt{sex} est maintenant ``étalée'' dans 2
colonnes distinctes : chaque modalité modalité du facteur de départ
(\texttt{female} et \texttt{male}) est utilisé en tant que titre de
nouvelles colonnes, et la variable \texttt{moyenne} est répartie dans
deux colonnes. Ce format de tableau n'est pas idéal pour les
statistiques ou les représentations graphiques, mais il est plus
synthétique, et donc plus facile à inclure dans un rapport ou un
compte-rendu.

\hypertarget{un-raccourci-pratique-pour-compter-des-effectifs}{%
\subsection{Un raccourci pratique pour compter des
effectifs}\label{un-raccourci-pratique-pour-compter-des-effectifs}}

Il est extrêmement fréquent d'avoir à grouper des données en fonction
d'une variable catégorielle puis d'avoir à compter le nombre
d'observations de chaque modalité avec \texttt{n()} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{effectif =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 2
  species   effectif
  <fct>        <int>
1 Adelie         152
2 Chinstrap       68
3 Gentoo         124
\end{verbatim}

Ces deux opérations sont tellement fréquentes (regrouper puis compter)
que le package \texttt{dplyr} nous fournit un raccourci : la fonction
\texttt{count()}.

Le code ci-dessus est équivalent à celui-ci :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 2
  species       n
  <fct>     <int>
1 Adelie      152
2 Chinstrap    68
3 Gentoo      124
\end{verbatim}

Notez qu'avec la fonction \texttt{count()}, la colonne qui contient les
comptages s'appelle toujours \texttt{n} par défaut. Comme avec
\texttt{group\_by()}, il est bien sûr possible d'utiliser
\texttt{count()} avec plusieurs variables :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species, sex)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 8 x 3
  species   sex        n
  <fct>     <fct>  <int>
1 Adelie    female    73
2 Adelie    male      73
3 Adelie    <NA>       6
4 Chinstrap female    34
5 Chinstrap male      34
6 Gentoo    female    58
7 Gentoo    male      61
8 Gentoo    <NA>       5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species, sex)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 3
  species   sex        n
  <fct>     <fct>  <int>
1 Adelie    female    73
2 Adelie    male      73
3 Chinstrap female    34
4 Chinstrap male      34
5 Gentoo    female    58
6 Gentoo    male      61
\end{verbatim}

Et il est évidemment possible de présenter le résultats sous un format
de tableau large :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(sex)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species, sex) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ sex,}
              \AttributeTok{values\_from =}\NormalTok{ n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 3
  species   female  male
  <fct>      <int> <int>
1 Adelie        73    73
2 Chinstrap     34    34
3 Gentoo        58    61
\end{verbatim}

\hypertarget{Exo-10}{%
\subsection{Exercices}\label{Exo-10}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Avec le tableau \texttt{diamonds} du package \texttt{ggplot2}, faites
  un tableau indiquant combien de diamants de chaque couleur on dispose.
  Vous devriez obtenir le tableau suivant :
\end{enumerate}

\begin{verbatim}
# A tibble: 7 x 2
  color     n
  <ord> <int>
1 D      6775
2 E      9797
3 F      9542
4 G     11292
5 H      8304
6 I      5422
7 J      2808
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  Examinez le tableau \texttt{weather} du package \texttt{nycflights13}
  et lisez son fichier d'aide pour comprendre à quoi correspondent les
  données et comment elles ont été acquises.
\item
  À partir du tableau \texttt{weather} faites un tableau indiquant les
  vitesses de vents minimales, maximales et moyennes, enregistrées
  chaque mois dans chaque aéroport de New York. Indice : les 3 aéroports
  de New York sont Newark, LaGuardia Airport et John F. Kennedy, notés
  respectivement \texttt{EWR}, \texttt{LGA} et \texttt{JFK} dans la
  variable \texttt{origin}. Votre tableau devrait ressembler à ceci :
\end{enumerate}

\begin{verbatim}
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month max_wind min_wind moy_wind
   <chr>  <int>    <dbl>    <dbl>    <dbl>
 1 EWR        1     42.6        0     9.87
 2 EWR        2   1048.         0    12.2 
 3 EWR        3     29.9        0    11.6 
 4 EWR        4     25.3        0     9.63
 5 EWR        5     33.4        0     8.49
 6 EWR        6     34.5        0     9.55
 7 EWR        7     20.7        0     9.15
 8 EWR        8     21.9        0     7.62
 9 EWR        9     23.0        0     8.03
10 EWR       10     26.5        0     8.32
# ... with 26 more rows
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Sachant que les vitesses du vent sont exprimées en miles par heure,
  certaines valeurs sont-elles surprenantes ? À l'aide de la fonction
  \texttt{filter()}, éliminez la ou les valeurs aberrantes. Vous devriez
  obtenir ce tableau :
\end{enumerate}

\begin{verbatim}
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month max_wind min_wind moy_wind
   <chr>  <int>    <dbl>    <dbl>    <dbl>
 1 EWR        1     42.6        0     9.87
 2 EWR        2     31.1        0    10.7 
 3 EWR        3     29.9        0    11.6 
 4 EWR        4     25.3        0     9.63
 5 EWR        5     33.4        0     8.49
 6 EWR        6     34.5        0     9.55
 7 EWR        7     20.7        0     9.15
 8 EWR        8     21.9        0     7.62
 9 EWR        9     23.0        0     8.03
10 EWR       10     26.5        0     8.32
# ... with 26 more rows
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  En utilisant les données de vitesse de vent du tableau
  \texttt{weather}, produisez le graphique suivant :
\end{enumerate}

\includegraphics{./01-EDA_files/figure-pdf/windspeed-1.pdf}

Indications :

\begin{itemize}
\tightlist
\item
  les vitesses de vent aberrantes ont été éliminées grâce à la fonction
  \texttt{filter()}
\item
  la fonction \texttt{geom\_jitter()} a été utilisée avec l'argument
  \texttt{height\ =\ 0}
\item
  la transparence des points est fixée à \texttt{0.2}
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\tightlist
\item
  À votre avis :
\end{enumerate}

\begin{itemize}
\tightlist
\item
  pourquoi les points sont-ils organisés en bandes horizontales ?
\item
  pourquoi n'y a-t-il jamais de vent entre 0 et environ 3 miles à
  l'heure (mph) ?
\item
  Sachant qu'en divisant des mph par 1.151 on obtient des vitesses en
  nœuds, que nous apprend cette commande :
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sort}\NormalTok{(}\FunctionTok{unique}\NormalTok{(weather}\SpecialCharTok{$}\NormalTok{wind\_speed)) }\SpecialCharTok{/} \FloatTok{1.151}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]   0.000000   2.999427   3.999235   4.999044   5.998853   6.998662
 [7]   7.998471   8.998280   9.998089  10.997897  11.997706  12.997515
[13]  13.997324  14.997133  15.996942  16.996751  17.996560  18.996368
[19]  19.996177  20.995986  21.995795  22.995604  23.995413  24.995222
[25]  25.995030  26.994839  27.994648  28.994457  29.994266  30.994075
[31]  31.993884  32.993692  33.993501  34.993310  36.992928 910.825873
\end{verbatim}

\hypertarget{cruxe9er-des-ruxe9sumuxe9s-de-donnuxe9es-avec-des-fonctions-spuxe9cifiques}{%
\section{Créer des résumés de données avec des fonctions
spécifiques}\label{cruxe9er-des-ruxe9sumuxe9s-de-donnuxe9es-avec-des-fonctions-spuxe9cifiques}}

Les fonctions \texttt{group\_by()} et \texttt{summarise()} permettent
donc de calculer n'importe quel indice de statistique descriptive sur un
tableau de donnée entier ou sur des modalités ou combinaisons de
modalités de facteurs. Il existe par ailleurs de nombreuses fonctions,
disponibles de base dans \texttt{R} ou dans certains packages
spécifiques, qui permettent de fournir des résumés plus ou moins
automatiques de tout ou partie des variables d'un jeu de données. Nous
allons en décire 2 ici, mais il en existe beaucoup d'autres : à vous
d'explorer les possibilités et d'utiliser les fonctions qui vous
paraissent les plus pertinentes, les plus simples à utiliser ou les plus
complètes.

\hypertarget{la-fonction-summary}{%
\subsection{\texorpdfstring{La fonction
\texttt{summary()}}{La fonction summary()}}\label{la-fonction-summary}}

La fonction \texttt{summary()} permet d'obtenir des résumés de données
pour tous types d'objets dans \texttt{R}. Selon la classe des objets que
l'on transmets à \texttt{summary()}, la nature des résultats obtenus
changera. Nous verrons ainsi au semestre 6 que cette fonction peut être
utilisée pour examiner les résultats de modèles de régressions linéaires
ou d'analyses de variances. Pour l'instant, nous nous intéressons à 3
situations :

\begin{itemize}
\tightlist
\item
  ce que renvoie la fonction quand on lui fournit un vecteur
\item
  ce que renvoie la fonction quand on lui fournit un facteur
\item
  ce que renvoie la fonction quand on lui fournit un tableau
\end{itemize}

\hypertarget{variable-continue-vecteur-numuxe9rique}{%
\subsubsection{Variable continue : vecteur
numérique}\label{variable-continue-vecteur-numuxe9rique}}

Commençons par fournir un vecteur numérique à la fonction
\texttt{summary()}. Nous allons pour cela extraire les données de masses
corporelles des manchots du tableau \texttt{penguins} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins}\SpecialCharTok{$}\NormalTok{body\_mass\_g}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  [1] 3750 3800 3250   NA 3450 3650 3625 4675 3475 4250 3300 3700 3200 3800 4400
 [16] 3700 3450 4500 3325 4200 3400 3600 3800 3950 3800 3800 3550 3200 3150 3950
 [31] 3250 3900 3300 3900 3325 4150 3950 3550 3300 4650 3150 3900 3100 4400 3000
 [46] 4600 3425 2975 3450 4150 3500 4300 3450 4050 2900 3700 3550 3800 2850 3750
 [61] 3150 4400 3600 4050 2850 3950 3350 4100 3050 4450 3600 3900 3550 4150 3700
 [76] 4250 3700 3900 3550 4000 3200 4700 3800 4200 3350 3550 3800 3500 3950 3600
 [91] 3550 4300 3400 4450 3300 4300 3700 4350 2900 4100 3725 4725 3075 4250 2925
[106] 3550 3750 3900 3175 4775 3825 4600 3200 4275 3900 4075 2900 3775 3350 3325
[121] 3150 3500 3450 3875 3050 4000 3275 4300 3050 4000 3325 3500 3500 4475 3425
[136] 3900 3175 3975 3400 4250 3400 3475 3050 3725 3000 3650 4250 3475 3450 3750
[151] 3700 4000 4500 5700 4450 5700 5400 4550 4800 5200 4400 5150 4650 5550 4650
[166] 5850 4200 5850 4150 6300 4800 5350 5700 5000 4400 5050 5000 5100 4100 5650
[181] 4600 5550 5250 4700 5050 6050 5150 5400 4950 5250 4350 5350 3950 5700 4300
[196] 4750 5550 4900 4200 5400 5100 5300 4850 5300 4400 5000 4900 5050 4300 5000
[211] 4450 5550 4200 5300 4400 5650 4700 5700 4650 5800 4700 5550 4750 5000 5100
[226] 5200 4700 5800 4600 6000 4750 5950 4625 5450 4725 5350 4750 5600 4600 5300
[241] 4875 5550 4950 5400 4750 5650 4850 5200 4925 4875 4625 5250 4850 5600 4975
[256] 5500 4725 5500 4700 5500 4575 5500 5000 5950 4650 5500 4375 5850 4875 6000
[271] 4925   NA 4850 5750 5200 5400 3500 3900 3650 3525 3725 3950 3250 3750 4150
[286] 3700 3800 3775 3700 4050 3575 4050 3300 3700 3450 4400 3600 3400 2900 3800
[301] 3300 4150 3400 3800 3700 4550 3200 4300 3350 4100 3600 3900 3850 4800 2700
[316] 4500 3950 3650 3550 3500 3675 4450 3400 4300 3250 3675 3325 3950 3600 4050
[331] 3350 3450 3250 4050 3800 3525 3950 3650 3650 4000 3400 3775 4100 3775
\end{verbatim}

Nous avons donc 344 valeurs de masses en grammes qui correspondent aux
344 manchots du jeu de données. La fonction \texttt{summary()} renvoie
le résumé suivant lorsqu'on lui fournit ces valeurs :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{body\_mass\_g)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   2700    3550    4050    4202    4750    6300       2 
\end{verbatim}

Nous obtenons ici 7 valeurs, qui correspondent respectivement à :

\begin{itemize}
\tightlist
\item
  la valeur minimale observée dans le vecteur. Ici, le manchot le plus
  léger de l'échantillon pèse donc 2700 grammes.
\item
  la valeur du premier quartile du vecteur. Le premier quartile est la
  valeur qui coupe l'échantillon en 2 groupes : 25\% des observations du
  vecteur sont inférieures au premier quartile, et 75\% des observations
  du vecteur sont supérieures au premier quartile. Ici, 25\% des
  manchots de l'échantillon (soit 86 individus) ont une masse inférieure
  à 3550 grammes, et 75\% des individus de l'échantillon (soit 258
  individus) ont une masse supérieure à 3550 grammes.
\item
  la valeur de médiane du vecteur. La médiane est la valeur qui coupe
  l'échantillon en 2 groupes : 50\% des observations du vecteur sont
  inférieures à la médiane, et 50\% des observations du vecteur sont
  supérieures à la médiane. Ici, 50\% des manchots de l'échantillon
  (soit 172 individus) ont une masse inférieure à 4050 grammes, et 50\%
  des individus de l'échantillon (soit 172 individus) ont une masse
  supérieure à 4050 grammes.
\item
  la moyenne du vecteur. Ici, les manchots des 3 espèces du jeu de
  données ont en moyenne une masse 4202 grammes.
\item
  la valeur du troisième quartile du vecteur. Le troisième quartile est
  la valeur qui coupe l'échantillon en 2 groupes : 75\% des observations
  du vecteur sont inférieures au troisième quartile, et 25\% des
  observations du vecteur sont supérieures au troisième quartile. Ici,
  75\% des manchots de l'échantillon (soit 258 individus) ont une masse
  inférieure à 4700 grammes, et 25\% des individus de l'échantillon
  (soit 86 individus) ont une masse supérieure à 4750 grammes.
\item
  la valeur maximale observée dans le vecteur. Ici, le manchot le plus
  lourd de l'échantillon pèse donc 6300 grammes.
\item
  le nombre de données manquantes. Ici, 2 manchots n'ont pas été pesés
  et présentent donc la mention \texttt{NA} (comme \textbf{N}ot
  \textbf{A}vailable) pour la variable \texttt{body\_mass\_g}.
\end{itemize}

Ces différents indices statistiques nous renseignent donc à la fois sur
la position de la distribution et sur la dispersion des données.

\begin{itemize}
\tightlist
\item
  La \emph{position} correspond à la tendance centrale et indique
  quelles sont les valeurs qui caractérisent le plus grand nombre
  d'individus. La moyenne et la médiane sont les deux indices de
  position les plus fréquemment utilisés. Lorsqu'une variable a une
  distribution parfaitement symétrique, la moyenne et la médiane sont
  strictement égales. Mais lorsqu'une distribution est asymétrique, la
  moyenne et la médiane diffèrent. En particulier, la moyenne est
  beaucoup plus sensible aux valeurs extrêmes que la médiane. Cela
  signifie que quand une distribution est très asymétrique, la médiane
  est souvent une meilleure indication des valeurs les plus fréquemment
  observées.
\end{itemize}

\begin{figure}

{\centering \includegraphics{./01-EDA_files/figure-pdf/fig-distri-masses-1.pdf}

}

\caption{\label{fig-distri-masses}Distribution des masses corporelles
des manchots}

\end{figure}

L'histogramme de la Figure~\ref{fig-distri-masses} montre la
distribution de la taille des manchots (toutes espèces confondues).
Cette distribution présente une asymétrie à droite. Cela signifie que la
distribution n'est pas symétrique et que la ``queue de distribution''
est plus longue à droite qu'à gauche. La plupart des individus ont une
masse comprise entre 3500 et 3700 grammes, au niveau du pic principal du
graphique. La médiane, en orange et qui vaut 4050 grammes est plus
proche du pic que la moyenne, en rouge, qui vaut 4202 grammes. Ici, la
différence entre moyenne et médiane n'est pas énorme, mais elle peut le
devenir si la distribution est vraiment très asymétrique, par exemple,
si quelques individus seulement avaient une masse supérieure à 7000
grammes, la moyenne serait tirée vers la droite du graphique alors que
la médiane ne serait presque pas affectée. la moyenne représenterait
alors encore moins fidèlement la tendance centrale.

Si l'on revient à la fonction \texttt{summary()}, observer des valeurs
proches pour la moyenne et la médiane nous indique donc le degré de
symétrie de la distribution.

\begin{itemize}
\tightlist
\item
  La dispersion des données nous renseigne sur la dispersion des points
  autour des indices de position. Les quartiles et les valeurs minimales
  et maximales renvoyées par la fonction \texttt{summary()} nous
  renseigne sur l'étalement des points. Les valeurs situées entre le
  premier et le troisième quartile correspondent aux 50\% des valeurs de
  l'échantillon les plus centrales. Plus l'étendue entre ces quartiles
  (notée IQR pour ``intervalle interquartile'') sera grande, plus la
  dispersion sera importante. D'ailleurs, lorsque la dispersion est très
  importante, les moyennes et médianes ne renseignent que très
  moyennement sur le tendance centrale. Les indices de position sont
  surtout pertinents lorsque la dispersion des points autour de cette
  tendance centrale n'est pas trop large. Par exemple, si la
  distribution des données ressemblait à ceci
  (Figure~\ref{fig-distri-masses2}), la moyenne et la médiane seraient
  fort peu utiles car très éloignées de la plupart des observations :
\end{itemize}

\begin{figure}

{\centering \includegraphics{./01-EDA_files/figure-pdf/fig-distri-masses2-1.pdf}

}

\caption{\label{fig-distri-masses2}Distribution des masses corporelles
(données fictives)}

\end{figure}

On comprend donc l'importance de considérer les indices de dispersion en
plus des indices de position pour caractériser et comprendre une série
de données numériques. L'intervalle interquartile est toujours utile
pour connaître l'étendue des données qui correspond aux 50\% des
observations les plus centrales. Les autres indices de dispersion très
fréquemment utilisés, mais qui ne sont pas proposés par défaut par la
fonction \texttt{summary()}, sont la variance et l'écart-type. Il est
possible de calculer tous les indices renvoyés par la fonction
\texttt{summary()} et ceux qui nous manquent grâce à la fonction
\texttt{summarise()} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{min =} \FunctionTok{min}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{Q1 =} \FunctionTok{quantile}\NormalTok{(body\_mass\_g, }\FloatTok{0.25}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{med =} \FunctionTok{median}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{moy =} \FunctionTok{mean}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{Q3 =} \FunctionTok{quantile}\NormalTok{(body\_mass\_g, }\FloatTok{0.75}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{max =} \FunctionTok{max}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{var =} \FunctionTok{var}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{et =} \FunctionTok{sd}\NormalTok{(body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 8
    min    Q1   med   moy    Q3   max     var    et
  <int> <dbl> <dbl> <dbl> <dbl> <int>   <dbl> <dbl>
1  2700  3550  4050 4202.  4750  6300 643131.  802.
\end{verbatim}

Vous notez que le code est beaucoup plus long, et qu'utiliser
\texttt{summary()} peut donc faire gagner beaucoup de temps, même si
cette fonction ne nous fournit ni la variance ni l'écart-type. Mais
comme souvent dans \texttt{R}, il est possible de calculer à la main
toutes ces valeurs si besoin. Les fonctions suivantes pourront donc vous
être utiles :

\begin{itemize}
\tightlist
\item
  \texttt{mean()} permet de calculer la moyenne.
\item
  \texttt{median()} permet de calculer la médiane.
\item
  \texttt{min()} et \texttt{max()} permettent de calculer les valeurs
  minimales et maximales respectivement.
\item
  \texttt{quantile()} permet de calculer les quartiles.
\item
  \texttt{sd()} permet de calculer l'écart-type.
\item
  \texttt{var()} permet de calculer la variance.
\end{itemize}

Pour toutes ces fonctions l'argument \texttt{na.rm\ =\ TRUE} permet
d'obtenir les résultats même si certaines valeurs sont manquantes.
Enfin, la fonction \texttt{IQR()} permet de calculer l'intervalle
inter-quartiles :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{body\_mass\_g, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1200
\end{verbatim}

Ici, les 50\% des valeurs les plus centrales de l'échantillon sont
situées dans un intervalle de 1200 grammes autour de la médiane.

\hypertarget{variable-quantitative-facteur}{%
\subsubsection{Variable quantitative :
facteur}\label{variable-quantitative-facteur}}

Si l'on fournit une variable catégorielle ou facteur à
\texttt{summary()}, le résultat obtenu sera naturellement différent :
calculer des moyennes, médianes ou quartiles n'aurait en effet pas de
sens lorsque la variable fournie ne contient que des catégories :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Adelie Chinstrap    Gentoo 
      152        68       124 
\end{verbatim}

Pour les facteurs, \texttt{summary()} compte simplement le nombre
d'observations pour chaque modalité. Ici, la variable \texttt{species}
est un facteur qui compte 3 modalités. La fonction \texttt{summary()}
nous indique donc le nombre d'individus pour chaque modalité : notre jeu
de données se compose de 152 individus de l'espèce Adélie, 68 individus
de l'espèce Chinstrap, et 124 individus de l'espèce Gentoo.

Comme pour les vecteurs numériques, si le facteur présente des données
manquantes, la fonction \texttt{summary()} compte également leur nombre
:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(penguins}\SpecialCharTok{$}\NormalTok{sex)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
female   male   NA's 
   165    168     11 
\end{verbatim}

Pour les facteurs, la fonction \texttt{summary()} est donc tout à fait
équivalente à la fonction \texttt{count()} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{count}\NormalTok{(species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 2
  species       n
  <fct>     <int>
1 Adelie      152
2 Chinstrap    68
3 Gentoo      124
\end{verbatim}

L'avantage de la fonction \texttt{count()} est qu'il est possible
d'utiliser plusieurs facteurs pour compter le nombre d'observations de
toutes les combinaisons de modalités (par exemple, combien d'individus
de chaque sexe pour chaque espèce), ce qui n'est pas possible avec la
fonction \texttt{summary()}.

\hypertarget{les-tableaux-data.frame-ou-tibble}{%
\subsubsection{\texorpdfstring{Les tableaux : \texttt{data.frame} ou
\texttt{tibble}}{Les tableaux : data.frame ou tibble}}\label{les-tableaux-data.frame-ou-tibble}}

L'avantage de la fonction \texttt{summary()} par rapport à la fonction
\texttt{count()} apparaît lorsque l'on souhaite obtenir des informations
sur toutes les variables d'un tableau à la fois :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(penguins)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      species          island    bill_length_mm  bill_depth_mm  
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
                                 Mean   :43.92   Mean   :17.15  
                                 3rd Qu.:48.50   3rd Qu.:18.70  
                                 Max.   :59.60   Max.   :21.50  
                                 NA's   :2       NA's   :2      
 flipper_length_mm  body_mass_g       sex           year     
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007  
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  
 Median :197.0     Median :4050   NA's  : 11   Median :2008  
 Mean   :200.9     Mean   :4202                Mean   :2008  
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  
 Max.   :231.0     Max.   :6300                Max.   :2009  
 NA's   :2         NA's   :2                                 
\end{verbatim}

Ici, on obtient un résumé pour chaque colonne du tableau. Les colonnes
numériques sont traitées comme les vecteurs numériques (on obtient alors
les minimas et maximas, les quartiles, les moyennes et médianes) et les
colonnes contenant des variables catégorielles sont traitées comme des
facteurs (et on obtient alors le nombre d'observations pour chaque
modalité).

On constate au passage que la variable \texttt{year} est considérée ici
comme une variable numérique, alors qu'elle devrait plutôt être
considérée comme un facteur, ce qui nous permettrait de savoir combien
d'individus ont été échantillonnés chaque année :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{year =} \FunctionTok{factor}\NormalTok{(year)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      species          island    bill_length_mm  bill_depth_mm  
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
                                 Mean   :43.92   Mean   :17.15  
                                 3rd Qu.:48.50   3rd Qu.:18.70  
                                 Max.   :59.60   Max.   :21.50  
                                 NA's   :2       NA's   :2      
 flipper_length_mm  body_mass_g       sex        year    
 Min.   :172.0     Min.   :2700   female:165   2007:110  
 1st Qu.:190.0     1st Qu.:3550   male  :168   2008:114  
 Median :197.0     Median :4050   NA's  : 11   2009:120  
 Mean   :200.9     Mean   :4202                          
 3rd Qu.:213.0     3rd Qu.:4750                          
 Max.   :231.0     Max.   :6300                          
 NA's   :2         NA's   :2                             
\end{verbatim}

Au final, la fonction \texttt{summary()} est très utile dans certaines
situations, notamment pour avoir rapidement accès à des statistiques
descriptives simples sur toutes les colonnes d'un tableau. Elle reste
cependant limitée car d'une part, elle ne fournit pas les variances ou
les écarts-types pour les variables numériques, et il est impossible
d'avoir des résumés plus fins, pour chaque modalité d'un facteur par
exemple. Ici, il serait en effet intéressant d'avoir des informations
synthétiques concernant les mesures biométriques des manchots, espèce
par espèce, plutôt que toutes espèces confondues. C'est là que la
fonction \texttt{skim()} intervient.

\hypertarget{sec-skim}{%
\subsection{\texorpdfstring{La fonction
\texttt{skim()}}{La fonction skim()}}\label{sec-skim}}

La fonction \texttt{skim()} fait partie du package \texttt{skimr}. Avant
de pouvoir l'utiliser, pensez donc à l'installer et à le charger en
mémoire si ce n'est pas déjà fait. Comme pour la fonction
\texttt{summary()}, on peut utiliser la fonction \texttt{skim()} sur
plusieurs types d'objets. Nous nous contenterons d'examiner ici le cas
le plus fréquent : celui des tableaux, groupés avec \texttt{group\_by()}
ou non.

\hypertarget{tableau-non-groupuxe9}{%
\subsubsection{Tableau non groupé}\label{tableau-non-groupuxe9}}

Commençons par examiner le résultat avec le tableau \texttt{penguins}
non groupé :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{skim}\NormalTok{(penguins)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{Data summary}\tabularnewline
\toprule()
\endhead
Name & penguins \\
Number of rows & 344 \\
Number of columns & 8 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Column type frequency: & \\
factor & 3 \\
numeric & 5 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Group variables & None \\
\bottomrule()
\end{longtable}

\textbf{Variable type: factor}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1687}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1205}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1687}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0964}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1084}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.3373}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
ordered
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_unique
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
top\_counts
\end{minipage} \\
\midrule()
\endhead
species & 0 & 1.00 & FALSE & 3 & Ade: 152, Gen: 124, Chi: 68 \\
island & 0 & 1.00 & FALSE & 3 & Bis: 168, Dre: 124, Tor: 52 \\
sex & 11 & 0.97 & FALSE & 2 & mal: 168, fem: 165 \\
\bottomrule()
\end{longtable}

\textbf{Variable type: numeric}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.1800}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.1000}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.1400}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0800}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0700}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0700}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0800}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0800}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0700}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0700}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0600}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
mean
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
sd
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p0
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p25
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p75
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p100
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
hist
\end{minipage} \\
\midrule()
\endhead
bill\_length\_mm & 2 & 0.99 & 43.92 & 5.46 & 32.1 & 39.23 & 44.45 & 48.5
& 59.6 & ▃▇▇▆▁ \\
bill\_depth\_mm & 2 & 0.99 & 17.15 & 1.97 & 13.1 & 15.60 & 17.30 & 18.7
& 21.5 & ▅▅▇▇▂ \\
flipper\_length\_mm & 2 & 0.99 & 200.92 & 14.06 & 172.0 & 190.00 &
197.00 & 213.0 & 231.0 & ▂▇▃▅▂ \\
body\_mass\_g & 2 & 0.99 & 4201.75 & 801.95 & 2700.0 & 3550.00 & 4050.00
& 4750.0 & 6300.0 & ▃▇▆▃▂ \\
year & 0 & 1.00 & 2008.03 & 0.82 & 2007.0 & 2007.00 & 2008.00 & 2009.0 &
2009.0 & ▇▁▇▁▇ \\
\bottomrule()
\end{longtable}

Les résultats obtenus grâce à cette fonction sont nombreux. La première
section nous donne des informations sur le tableau :

\begin{itemize}
\tightlist
\item
  son nom, son nombre de lignes et de colonnes
\item
  la nature des variables qu'il contient (ici 3 facteurs et 5 variables
  numériques)
\item
  la présence de variables utilisées pour faire des regroupements (il
  n'y en a pas encore à ce stade)
\end{itemize}

Ensuite, un bloc apporte des information sur chaque facteur présent dans
le tableau :

\begin{itemize}
\tightlist
\item
  le nom de la variable catégorielle (\texttt{skim\_variable})
\item
  le nombre de données manquantes (\texttt{n\_missing}) et le taux de
  ``données complètes'' (\texttt{complete\_rate})
\item
  des informations sur le nombre de modalités (\texttt{n\_unique})
\item
  le nombre d'observations pour les modalités les plus représentées
  (\texttt{top\_counts})
\end{itemize}

En un coup d'œil, on sait donc que 3 espèces sont présentes (et on
connait leurs effectifs), on sait que les manchots ont été
échantillonnées sur 3 îles, et on sait que le sexe de 11 individu (sur
344) est inconnu. Pour le reste, il y a presque autant de femelles que
de mâles.

Le dernier bloc renseigne sur les variables numériques. Pour chaque
d'elle, on a :

\begin{itemize}
\tightlist
\item
  le nom de la variable numérique (\texttt{skim\_variable})
\item
  le nombre de données manquantes (\texttt{n\_missing}) et le taux de
  ``données complètes'' (\texttt{complete\_rate})
\item
  la moyenne (\texttt{mean}) et l'écart-type (\texttt{sd}), ce qui est
  une nouveauté par rapport à la fonction \texttt{summary()}
\item
  les valeurs minimales (\texttt{p0}), de premier quartile
  (\texttt{p25}), de second quartile (\texttt{p50}, c'est la médiane !),
  de troisième quartile (\texttt{p75}) et la valeur maximale
  (\texttt{p100})
\item
  un histogramme très simple qui donne un premier aperçu grossier de la
  forme de la distribution
\end{itemize}

Là encore, en un coup d'œil, on dispose donc de toutes les informations
pertinentes pour juger de la distribution, de la position et de la
dispersion de chaque variable numérique du jeu de données.

\hypertarget{tableau-groupuxe9}{%
\subsubsection{Tableau groupé}\label{tableau-groupuxe9}}

La fonction \texttt{skim()}, déjà très pratique, le devient encore plus
lorsque l'on choisit de lui fournir seulement certaines variables, et
qu'on fait certains regroupements. Par exemple, on peut sélectionner les
variables relatives aux dimensions du bec (\texttt{bill\_length\_mm} et
\texttt{bill\_depth\_mm}) avec la fonction \texttt{select()} que nous
connaissons déjà, et demander un résumé des données pour chaque espèce
grâce à la fonction \texttt{group\_by()} que nous connaissons également
:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{\%\textgreater{}\%}                     \CommentTok{\# Avec le tableau penguins...}
  \FunctionTok{select}\NormalTok{(species, }
\NormalTok{         bill\_length\_mm,}
\NormalTok{         bill\_depth\_mm) }\SpecialCharTok{\%\textgreater{}\%}      \CommentTok{\# Je sélectionne les variables d\textquotesingle{}intérêt...}
  \FunctionTok{group\_by}\NormalTok{(species) }\SpecialCharTok{\%\textgreater{}\%}          \CommentTok{\# Je regroupe par espèce...}
  \FunctionTok{skim}\NormalTok{()                         }\CommentTok{\# Et je produis un résumé des données}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{Data summary}\tabularnewline
\toprule()
\endhead
Name & Piped data \\
Number of rows & 344 \\
Number of columns & 3 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Column type frequency: & \\
numeric & 2 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Group variables & species \\
\bottomrule()
\end{longtable}

\textbf{Variable type: numeric}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.1596}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.1064}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.1064}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.1489}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0638}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0532}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0532}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0638}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0638}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0638}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0532}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0638}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
species
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
mean
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
sd
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p0
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p25
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p75
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p100
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
hist
\end{minipage} \\
\midrule()
\endhead
bill\_length\_mm & Adelie & 1 & 0.99 & 38.79 & 2.66 & 32.1 & 36.75 &
38.80 & 40.75 & 46.0 & ▁▆▇▆▁ \\
bill\_length\_mm & Chinstrap & 0 & 1.00 & 48.83 & 3.34 & 40.9 & 46.35 &
49.55 & 51.08 & 58.0 & ▂▇▇▅▁ \\
bill\_length\_mm & Gentoo & 1 & 0.99 & 47.50 & 3.08 & 40.9 & 45.30 &
47.30 & 49.55 & 59.6 & ▃▇▆▁▁ \\
bill\_depth\_mm & Adelie & 1 & 0.99 & 18.35 & 1.22 & 15.5 & 17.50 &
18.40 & 19.00 & 21.5 & ▂▆▇▃▁ \\
bill\_depth\_mm & Chinstrap & 0 & 1.00 & 18.42 & 1.14 & 16.4 & 17.50 &
18.45 & 19.40 & 20.8 & ▅▇▇▆▂ \\
bill\_depth\_mm & Gentoo & 1 & 0.99 & 14.98 & 0.98 & 13.1 & 14.20 &
15.00 & 15.70 & 17.3 & ▅▇▇▆▂ \\
\bottomrule()
\end{longtable}

On constate ici que pour chaque variable numérique sélectionnée, des
statistiques descriptives détaillées nous sont fournies pour chacune des
3 espèces. Ce premier examen semble montrer que :

\begin{itemize}
\tightlist
\item
  L'espèce Adélie est celle qui possède le bec le plus court (ses
  valeurs de moyennes, médianes et quartiles sont plus faibles que
  celles des 2 autres espèces).
\item
  L'espèce Gentoo est celle qui possède le bec le plus fin, ou le moins
  épais (ses valeurs de moyennes, médianes et quartiles sont plus
  faibles que celles des 2 autres espèces)
\item
  Il ne semble pas y avoir de fortes différences d'écarts-types (donc
  des dispersions des points autour des moyennes) entre les 3 espèces :
  pour chacune des 2 variables numériques, des valeurs d'écarts-types
  comparables sont en effet observées pour les 3 espèces
\item
  La distribution des 2 variables numériques semble approximativement
  suivre une distribution symétrique pour les 3 espèces, avec une forme
  de courbe en cloche. Les distributions devraient donc suivre à peu une
  distribution normale
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-note-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Note}, colbacktitle=quarto-callout-note-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]
Vous comprenez j'espère l'importance d'examiner ce genre de résumé des
données avant de vous lancer dans des tests statistiques. Ils sont un
complément indispensable aux explorations graphiques que vous devez
également prendre l'habitude de réaliser pour mieux appréhender et
comprendre la nature de vos données. Puisque chaque je de données est
unique, vous devrez vous adapter à la situation et aux questions
scientifiques qui vous sont posées (ou que vous vous posez !) : les
choix qui seront pertinents pour une situation ne le seront pas
nécessairement pour une autre. Mais dans tous les cas, pour savoir où
vous allez et pour ne pas faire de bêtise au moment des tests
statistiques et de leur interprétation, vous devrez toujours explorer
vos données, avec des graphiques exploratoire et des statistiques
descriptives.
\end{tcolorbox}

\hypertarget{exercice}{%
\subsection{Exercice}\label{exercice}}

En utilisant les fonctions de résumé abordées jusqu'ici et le tableau
\texttt{weather}, répondez aux questions suivante :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Dans quel aéroport de New York les précipitations moyennes ont-elle
  été les plus fortes en 2013 ?
\item
  Dans quel aéroport de New York la vitesse du vent moyenne était-elle
  la plus forte en 2013 ? Quelle est cette vitesse ?
\item
  Dans quel aéroport de New York les rafales de vent étaient-elles les
  plus variables en 2013 ? Quel indice statistique vous donne cette
  information et quelle est sa valeur ?
\item
  Les précipitation dans les 3 aéroports de New-York ont-elles une
  distribution symétrique ?
\item
  Quelle est la température médiane observée en 2013 tous aéroports
  confondus ?
\item
  Tous aéroports confondus, quel est le mois de l'année où la
  température a été la plus variable en 2013 ? Quelles étaient les
  températures minimales et maximales observées ce mois-là ?
\end{enumerate}

\hypertarget{sec-disp}{%
\section{Dispersion et incertitude}\label{sec-disp}}

\hypertarget{la-notion-de-dispersion}{%
\subsection{La notion de dispersion}\label{la-notion-de-dispersion}}

Comme expliqué plus haut, les \textbf{indices de dispersion} nous
renseignent sur la variabilités des données autour de la valeur moyenne
(ou médiane) d'une population ou d'un échantillon. L'écart-type, la
variance et l'intervalle inter-quartiles sont 3 exemples d'indices de
dispersion. Prenons l'exemple de l'écart-type. Un écart-type faible
indique que la majorité des observations ont des valeurs proches de la
moyenne. À l'inverse, un écart-type important indique que la plupart des
points sont éloignés de la moyenne. L'écart-type est une caractéristique
de la population que l'on étudie grâce à un échantillon, au même titre
que la moyenne. En travaillant sur un échantillon, j'espère accéder aux
vraies grandeurs de la population. Même si ces vraies grandeurs sont à
jamais inaccessibles (on ne connaîtra jamais parfaitement quelle est la
vraie valeur de moyenne \(\mu\) ou d'écart-type \(\sigma\) de la
population), on espère qu'avec un échantillonnage réalisé correctement,
la moyenne de l'échantillon (\(\bar{x}\) ou \(m\)) et l'écart-type
(\(s\)) de l'échantillon reflètent assez fidèlement les valeurs de la
population générale. C'est la notion d'estimateur, intimement liée à la
notion d'\textbf{inférence statistique} : la moyenne de l'échantillon
est un estimateur de la moyenne \(\mu\) de la population. C'est la
raison pour laquelle on la note parfois \(\hat{\mu}\) (en plus de
\(\bar{x}\) ou \(m\)). De même, l'écart-type \(s\) et la variance
\(s^2\) d'un échantillon sont des estimateurs de l'écart-type \(\sigma\)
et de la variance \(\sigma^2\) de la population générale. C'est la
raison pour laquelle on les note parfois \(\hat{\sigma}\) et
\(\hat{\sigma}^2\) respectivement. L'accent circonflexe se prononce
``chapeau''. On dit donc que \(\hat{\sigma}\) (sigma chapeau) est un
estimateur de l´écart-type de la population générale. Comme nous l'avons
vu, les indices de dispersion doivent accompagner les indices de
position lorsque l'on décrit des données, car présenter une valeur de
moyenne, ou de médiane seule n'a pas de sens : il faut savoir à quel
point les données sont proches ou éloignées de la tendance centrale pour
savoir si, dans la population générale, les indicateurs de position
correspondent ou non, aux valeurs portées par la majorité des individus.

Nous avons vu plus haut comment calculer des indices de position et de
dispersion. Tout ceci devrait donc être clair pour vous à ce stade.

\hypertarget{la-notion-dincertitude}{%
\subsection{La notion d'incertitude}\label{la-notion-dincertitude}}

Par ailleurs, puisqu'on ne sait jamais avec certitude si nos estimations
(de moyennes ou d'écarts-types ou de tout autre paramètre) reflètent
fidèlement ou non les vraies valeurs de la population, nous devons
quantifier à quel point nos estimations s'écartent de celles de la
population générale. C'est ce que permettent les \textbf{indices
d'incertitude}. Les deux indices d'incertitude les plus connus (et les
plus utilisés) sont l'intervalle de confiance à 95\% (de la moyenne ou
de tout autre estimateur ; les formules sont nombreuses et il n'est pas
utile de les détailler ici : nous verrons comment les calculer plus bas)
et l'erreur standard de la moyenne (\(se_{\bar{x}}\)), dont la formule
est la suivante :

\[se_{\bar{x}} = \frac{s}{\sqrt{n}}\]

avec \(s\), l'écart-type de l'échantillon et \(n\) la taille de
l'échantillon.

Comme pour la moyenne, on peut calculer l'erreur standard d'un
écart-type, d'une médiane, d'une proportion, ou de tout autre estimateur
calculé sur un échantillon. Cet indice d'incertitude ne nous renseigne
pas sur une grandeur de la population générale qu'on chercherait à
estimer, mais bien sur l'incertitude associée à une estimation que nous
faisons en travaillant sur un échantillon de taille forcément limitée.
Tout processus d'échantillonnage est forcément entaché d'incertitude,
causée entre autre par le hasard de l'échantillonnage (ou fluctuation
d'échantillonnage). Puisque nous travaillons sur des échantillons
forcément imparfaits, les indices d'incertitude vont nous permettre de
quantifier à quel point nos estimations s'écartent des vraies valeurs de
la population. Ces ``vraies valeurs'', faute de pouvoir collecter tous
les individus de la population, resteront à jamais inconnues.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-important-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Autrement dit\ldots{}}, colbacktitle=quarto-callout-important-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]
Quand on étudie des populations naturelles grâce à des échantillons
\textbf{on se trompe toujours}. Les statistiques nous permettent de
\textbf{quantifier à quel point on se trompe} grâce aux indices
d'incertitude, et c'est déjà pas mal !
\end{tcolorbox}

En examinant la formule de l'erreur standard de la moyenne présentée
ci-dessus, on comprend intuitivement que plus la taille de l'échantillon
(\(n\)) augmente, plus l'erreur standard (donc l'incertitude) associée à
notre estimation de moyenne diminue. Autrement dit, plus les données
sont abondantes dans l'échantillon, meilleure sera notre estimation de
moyenne, et donc, moins le risque de raconter des bêtises sera grand.

L'autre indice d'incertitude très fréquemment utilisé est l'intervalle
de confiance à 95\% (de la moyenne, de la médiane, de la variance, ou de
toute autre estimateur calculé dans un échantillon). L'intervalle de
confiance nous renseigne sur la gamme des valeurs les plus probables
pour un paramètre de la population étudiée. Par exemple, si j'observe,
dans un échantillon, une moyenne de 10, avec un intervalle de confiance
calculé de {[}7 ; 15{]}, cela signifie que, dans la population générale,
la vraie valeur de moyenne a de bonnes chances de se trouver dans
l'intervalle {[}7 ; 15{]}. Dans la population générale, toutes les
valeurs comprises entre 7 et 15 sont vraisemblables pour la moyenne
alors que les valeurs situées en dehors de cet intervalle sont moins
probables. Une autre façon de comprendre l'intervalle de confiance est
de dire que si je récupère un grand nombre d'échantillons dans la même
population, en utilisant exactement le même protocole expérimental, 95\%
des échantillons que je vais récupérer auront une moyenne située à
l'intérieur de l'intervalle de confiance à 95\%, et 5\% des échantillons
auront une moyenne située à l'extérieur de l'intervalle de confiance à
95\%. C'est une notion qui n'est pas si évidente que ça à comprendre,
donc prenez bien le temps de relire cette section si besoin, et de poser
des questions le cas échéant.

Concrètement, plus l'intervalle de confiance est large, moins notre
confiance est grande. Si, pour une moyenne d'échantillon de 10,
l'intervalle de confiance à 95\% vaut {[}9,5 ; 11{]}, la gamme des
valeurs probables pour la moyenne est étroite. Autrement dit, la moyenne
de l'échantillon, qui vaut 10, a de bonne chances d'être très proche de
la vraie valeur de moyenne de la population générale.

La notion d'intervalle de confiance à 95\% est donc très proche de celle
d'erreur standard. D'ailleurs, pour la plupart des grandeurs d'un
échantillon, l'intervalle de confiance est très souvent calculé à partir
de l'erreur standard.

\hypertarget{calcul-de-lerreur-standard-de-la-moyenne}{%
\subsection{Calcul de l'erreur standard de la
moyenne}\label{calcul-de-lerreur-standard-de-la-moyenne}}

Contrairement aux indices de position et de dispersion, il n'existe pas
de fonction intégrée à \texttt{R} qui permette de calculer l'erreur
standard de la moyenne. Toutefois, sa formule très simple nous permet de
la calculer à la main quand on en a besoin grâce aux fonction
\texttt{group\_by()} et \texttt{summarise()}.

Par exemple, reprenons les données de température (tableau
\texttt{weather}, colonne \texttt{temp}) dans les 3 aéroports de New
York (colonne \texttt{origin}). Imaginons que nous souhaitions étudier
les fluctuations de températures au fil des mois de l'année 2013 :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Je vais commencer par transformer les températures (fournies en degrés
  Fahrenheit) en degrés Celsius :
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 26,115 x 16
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed wind_g~1
   <chr>  <int> <int> <int> <int> <dbl> <dbl> <dbl>    <dbl>      <dbl>    <dbl>
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4        NA
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06       NA
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5        NA
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7        NA
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7        NA
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5        NA
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0        NA
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4        NA
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0        NA
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8        NA
# ... with 26,105 more rows, 5 more variables: precip <dbl>, pressure <dbl>,
#   visib <dbl>, time_hour <dttm>, temp_celsius <dbl>, and abbreviated variable
#   name 1: wind_gust
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Ensuite, je détermine, pour chaque jour de chaque mois de l'année, et
  pour chaque aéroport, quelle est la température maximale atteinte :
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 1,092 x 4
# Groups:   origin, month [36]
   origin month   day temperature_max
   <chr>  <int> <int>           <dbl>
 1 EWR        1     1            5   
 2 EWR        1     2            1.10
 3 EWR        1     3            1.10
 4 EWR        1     4            4.4 
 5 EWR        1     5            6.7 
 6 EWR        1     6            8.9 
 7 EWR        1     7            8.3 
 8 EWR        1     8            9.4 
 9 EWR        1     9           10   
10 EWR        1    10           10   
# ... with 1,082 more rows
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Je peux maintenant calculer la température moyenne mensuelle pour
  chaque aéroport :
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(temperature\_max, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 3
# Groups:   origin [3]
   origin month moyenne
   <chr>  <int>   <dbl>
 1 EWR        1    5.69
 2 EWR        2    4.74
 3 EWR        3    8.20
 4 EWR        4   16.4 
 5 EWR        5   22.2 
 6 EWR        6   27.4 
 7 EWR        7   31.0 
 8 EWR        8   27.8 
 9 EWR        9   24.6 
10 EWR       10   20.0 
# ... with 26 more rows
\end{verbatim}

Pour pouvoir réutiliser ce tableau, je lui donne un nom :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperatures }\OtherTok{\textless{}{-}}\NormalTok{ weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(temperature\_max, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

Au final, je peux faire un graphique de l'évolution de ces températures
:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperatures }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ moyenne)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{origin, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }
       \AttributeTok{y =} \StringTok{"Moyenne des températures quotidiennes maximales (ºC)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/unnamed-chunk-44-1.pdf}

}

\end{figure}

Vous remarquerez que :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  j'associe \texttt{factor(month)}, et non simplement \texttt{month}, à
  l'axe des \texttt{x} afin d'avoir, sur l'axe des abscisses, des
  chiffres cohérents allant de 1 à 12, et non des chiffres à virgule
\item
  l'argument \texttt{group\ =\ 1} doit être ajouté pour que la ligne
  reliant les points apparaisse. En effet, les lignes sont censées
  relier des points qui appartiennent à une même série temporelle. Or
  ici, nous avons transformé \texttt{month} en facteur. Préciser
  \texttt{group\ =\ 1} permet d'indiquer à \texttt{geom\_line()} que
  toutes les catégories du facteur \texttt{month} appartiennent au même
  groupe, que ce facteur peut être considéré comme une variable
  continue, et qu'il est donc correct de relier les points.
\end{enumerate}

Pour les 3 aéroports, les profils de températures sont très proches.
C'est tout à fait logique puisqu'ils sont situés dans un rayon de
quelques kilomètres seulement. Le problème de ce graphique est que
chaque point a été obtenu en calculant une moyenne. En janvier, nous
avons fait la moyenne de 31 valeurs de températures quotidiennes pour
chaque aéroport. En février, nous avons fait la moyenne de 28 valeurs de
températures quotidiennes pour chaque aéroport. Et ainsi de suite pour
tous les mois de l'année 2013. Puisque nous présentons des valeurs de
moyennes, il nous faut présenter également \textbf{l'incertitude
associée à ces calculs de moyennes}. Pour cela, nous devons calculer
l'erreur standard des moyennes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(temperature\_max, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{N\_obs =} \FunctionTok{n}\NormalTok{(),}
            \AttributeTok{erreur\_standard =} \FunctionTok{sd}\NormalTok{(temperature\_max, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(N\_obs))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne N_obs erreur_standard
   <chr>  <int>   <dbl> <int>           <dbl>
 1 EWR        1    5.69    31           1.14 
 2 EWR        2    4.74    28           0.762
 3 EWR        3    8.20    31           0.649
 4 EWR        4   16.4     30           0.919
 5 EWR        5   22.2     31           1.02 
 6 EWR        6   27.4     30           0.769
 7 EWR        7   31.0     31           0.700
 8 EWR        8   27.8     31           0.385
 9 EWR        9   24.6     30           0.716
10 EWR       10   20.0     31           0.882
# ... with 26 more rows
\end{verbatim}

Notre tableau de statistiques descriptives possède maintenant 2 colonnes
supplémentaires : le nombre d'observations (que j'ai nommé
\texttt{N\_obs}), et l'erreur standard associée à chaque moyenne,
calculée grâce à la formule vue plus haut
\(se_{\bar{x}} = \frac{s}{\sqrt{n}}\) (la fonction \texttt{sqrt()}
permet de calculer la racine carrée). On constate que l'erreur standard,
qui s'exprime dans la même unité que la moyenne, est variable selon les
mois de l'année. Ainsi, pour l'aéroport de Newark, l'incertitude semble
particulièrement faible pour le mois d'août (0.385 ºC) mais presque 3
fois plus forte pour le mois de janvier (1.14 ºC).

Une fois de plus, je donne un nom à ce tableau de données pour pouvoir
le réutiliser plus tard :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperatures\_se }\OtherTok{\textless{}{-}}\NormalTok{ weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne =} \FunctionTok{mean}\NormalTok{(temperature\_max, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
            \AttributeTok{N\_obs =} \FunctionTok{n}\NormalTok{(),}
            \AttributeTok{erreur\_standard =} \FunctionTok{sd}\NormalTok{(temperature\_max, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(N\_obs))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

Notez que le package \texttt{ggplot2} contient une fonction permettant
de calculer à la fois la moyenne et erreur standard de la moyenne d'un
échantillon :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{mean\_se}\NormalTok{(temperature\_max))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month     y  ymin  ymax
   <chr>  <int> <dbl> <dbl> <dbl>
 1 EWR        1  5.69  4.55  6.82
 2 EWR        2  4.74  3.97  5.50
 3 EWR        3  8.20  7.55  8.85
 4 EWR        4 16.4  15.5  17.4 
 5 EWR        5 22.2  21.1  23.2 
 6 EWR        6 27.4  26.6  28.1 
 7 EWR        7 31.0  30.3  31.7 
 8 EWR        8 27.8  27.4  28.2 
 9 EWR        9 24.6  23.9  25.3 
10 EWR       10 20.0  19.1  20.9 
# ... with 26 more rows
\end{verbatim}

Les résultats obtenus ne sont pas exactement au même format :

\begin{itemize}
\tightlist
\item
  la colonne \texttt{y} contient les valeurs de moyennes
\item
  la colonne \texttt{ymin} contient la valeur de moyenne moins une fois
  l'erreur standard
\item
  la colonne \texttt{ymax} contient la valeur de moyenne plus une fois
  l'erreur standard
\end{itemize}

Il ne nous restera plus qu'à ajouter des barres d'erreur sur notre
graphique pour visualiser l'incertitude associée à chaque valeur de
moyenne.

\hypertarget{calculs-dintervalles-de-confiance-uxe0-95}{%
\subsection{Calculs d'intervalles de confiance à
95\%}\label{calculs-dintervalles-de-confiance-uxe0-95}}

Comme pour les erreurs standard, il est possible de calculer des
intervalles de confiance de n'importe quel estimateur calculé à partir
d'un échantillon, pour déterminer la gamme des valeurs les plus
probables pour les paramètres équivalents dans la population générale.
Nous nous concentrerons ici sur le calcul des intervalles de confiance à
95\% de la moyenne, mais nous serons amenés à examiner également
l'intervalle de confiance de la médiane, puis, dans la
Chapitre~\ref{sec-moy2}, l'intervalle de confiance à 95\% d'une
différence de moyennes.

Contrairement à l'erreur standard, il n'y a pas qu'une bonne façon de
calculer l'intervalle de confiance à 95\% d'une moyenne. Plusieurs
formules existent et le choix de la formule dépend en partie de la
distribution des données (la distribution suit-elle une loi Normale ou
non) et de la taille de l'échantillon dont nous disposons (\(n\) est-il
supérieur à 30 ou non ?). Dans la situation idéale d'une variable qui
suit la distribution Normale, les bornes inférieures et supérieures de
l'intervalle de confiance à 95\% sont obtenues grâce à cette formule

\[\bar{x} - 1.96 \cdot \frac{s}{\sqrt{n}} < \mu < \bar{x} + 1.96 \cdot \frac{s}{\sqrt{n}}\]

Autrement dit, la vraie moyenne \(\mu\) d'une population a de bonnes
chances de se trouver dans un intervalle de plus ou moins 1.96 fois
l'erreur standard de la moyenne. En première approximation, l'intervalle
de confiance est donc la moyenne de l'échantillon \(\bar{x}\) plus ou
moins 2 fois l'erreur standard (que nous avons appris à calculer à la
main un peu plus tôt). On peut donc calculer à la main les bornes
inférieures et supérieures de l'intervalle de confiance ainsi :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{mean\_se}\NormalTok{(temperature\_max, }\AttributeTok{mult =} \FloatTok{1.96}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month     y  ymin  ymax
   <chr>  <int> <dbl> <dbl> <dbl>
 1 EWR        1  5.69  3.46  7.92
 2 EWR        2  4.74  3.24  6.23
 3 EWR        3  8.20  6.93  9.47
 4 EWR        4 16.4  14.6  18.2 
 5 EWR        5 22.2  20.1  24.2 
 6 EWR        6 27.4  25.8  28.9 
 7 EWR        7 31.0  29.6  32.3 
 8 EWR        8 27.8  27.0  28.5 
 9 EWR        9 24.6  23.2  26.0 
10 EWR       10 20.0  18.3  21.7 
# ... with 26 more rows
\end{verbatim}

Ici, grâce à l'argument \texttt{mult\ =\ 1.96} de la fonction
\texttt{mean\_se()} :

\begin{itemize}
\tightlist
\item
  la colonne \texttt{ymin} contient maintenant les valeurs de moyennes
  moins 1.96 fois l'erreur standard
\item
  la colonne \texttt{ymax} contient maintenant les valeurs de moyennes
  plus 1.96 fois l'erreur standard
\end{itemize}

Dans la pratique, puisque cette méthode reste approximative et dépend de
la nature des données dont on dispose, on utilisera plutôt des fonctions
spécifiques qui calculeront pour nous les intervalles de confiance à
95\% de nos estimateurs. C'est ce que permet en particulier la fonction
\texttt{mean\_cl\_normal()} du package \texttt{ggplot2}. Il est
toutefois important de bien comprendre qu'il y a un lien étroit entre
l'erreur standard (l'incertitude associées à l'estimation d'un paramètre
d'une population à partir des données d'un échantillon), et l'intervalle
de confiance à 95\% de ce paramètre.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{mean\_cl\_normal}\NormalTok{(temperature\_max))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month     y  ymin  ymax
   <chr>  <int> <dbl> <dbl> <dbl>
 1 EWR        1  5.69  3.36  8.01
 2 EWR        2  4.74  3.17  6.30
 3 EWR        3  8.20  6.88  9.53
 4 EWR        4 16.4  14.6  18.3 
 5 EWR        5 22.2  20.1  24.2 
 6 EWR        6 27.4  25.8  28.9 
 7 EWR        7 31.0  29.5  32.4 
 8 EWR        8 27.8  27.0  28.6 
 9 EWR        9 24.6  23.1  26.0 
10 EWR       10 20.0  18.2  21.8 
# ... with 26 more rows
\end{verbatim}

Comme dans les tableaux précédents, 3 nouvelles colonnes ont été crées :

\begin{itemize}
\tightlist
\item
  \texttt{y} contient toujours la moyenne des températures mensuelles
  pour chaque aéroport
\item
  \texttt{ymin} contient maintenant les bornes inférieures de
  l'intervalle à 95\% des moyennes
\item
  \texttt{ymax} contient maintenant les bornes supérieures de
  l'intervalle à 95\% des moyennes
\end{itemize}

Pour que la suite soit plus claire, nous allons afficher et donner des
noms à ces différents tableaux en prenant soin de renommer les colonnes
pour plus de clarté.

Tout d'abord, nous disposons du tableau \texttt{temperatures\_se}, qui
contient, les moyennes des températures mensuelles de chaque aéroport de
New York en 2013, et les erreurs standard de ces moyennes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperatures\_se}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne N_obs erreur_standard
   <chr>  <int>   <dbl> <int>           <dbl>
 1 EWR        1    5.69    31           1.14 
 2 EWR        2    4.74    28           0.762
 3 EWR        3    8.20    31           0.649
 4 EWR        4   16.4     30           0.919
 5 EWR        5   22.2     31           1.02 
 6 EWR        6   27.4     30           0.769
 7 EWR        7   31.0     31           0.700
 8 EWR        8   27.8     31           0.385
 9 EWR        9   24.6     30           0.716
10 EWR       10   20.0     31           0.882
# ... with 26 more rows
\end{verbatim}

Ensuite, nous avons produit un tableau presque équivalent que nous
allons nommer \texttt{temperature\_se\_bornes} et pour lequel nous
allons modifier le nom des colonnes \texttt{y}, \texttt{ymin} et
\texttt{ymax} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_se\_bornes }\OtherTok{\textless{}{-}}\NormalTok{ weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{mean\_se}\NormalTok{(temperature\_max)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{moyenne =}\NormalTok{ y,}
         \AttributeTok{moyenne\_moins\_se =}\NormalTok{ ymin,}
         \AttributeTok{moyenne\_plus\_se =}\NormalTok{ ymax)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_se\_bornes}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne moyenne_moins_se moyenne_plus_se
   <chr>  <int>   <dbl>            <dbl>           <dbl>
 1 EWR        1    5.69             4.55            6.82
 2 EWR        2    4.74             3.97            5.50
 3 EWR        3    8.20             7.55            8.85
 4 EWR        4   16.4             15.5            17.4 
 5 EWR        5   22.2             21.1            23.2 
 6 EWR        6   27.4             26.6            28.1 
 7 EWR        7   31.0             30.3            31.7 
 8 EWR        8   27.8             27.4            28.2 
 9 EWR        9   24.6             23.9            25.3 
10 EWR       10   20.0             19.1            20.9 
# ... with 26 more rows
\end{verbatim}

Nous avons ensuite calculé manuellement des intervalles de confiance
approximatifs, avec la fonction \texttt{mean\_se()} et son argument
\texttt{mult\ =\ 1.96}. Là encore, nous allons stocker cet objet dans un
tableau nommé \texttt{temperatures\_ci\_approx}, et nous allons modifier
le nom des colonnes \texttt{y}, \texttt{ymin}, et \texttt{ymax} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_ci\_approx }\OtherTok{\textless{}{-}}\NormalTok{ weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{mean\_se}\NormalTok{(temperature\_max, }\AttributeTok{mult =} \FloatTok{1.96}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{moyenne =}\NormalTok{ y,}
         \AttributeTok{ci\_borne\_inf =}\NormalTok{ ymin,}
         \AttributeTok{ci\_borne\_sup =}\NormalTok{ ymax)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_ci\_approx}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne ci_borne_inf ci_borne_sup
   <chr>  <int>   <dbl>        <dbl>        <dbl>
 1 EWR        1    5.69         3.46         7.92
 2 EWR        2    4.74         3.24         6.23
 3 EWR        3    8.20         6.93         9.47
 4 EWR        4   16.4         14.6         18.2 
 5 EWR        5   22.2         20.1         24.2 
 6 EWR        6   27.4         25.8         28.9 
 7 EWR        7   31.0         29.6         32.3 
 8 EWR        8   27.8         27.0         28.5 
 9 EWR        9   24.6         23.2         26.0 
10 EWR       10   20.0         18.3         21.7 
# ... with 26 more rows
\end{verbatim}

Enfin, nous avons calculé les intervalles de confiance avec une fonction
spécialement dédiée à cette tâche : la fonction
\texttt{mean\_cl\_normal()}. Nous allons stocker cet objet dans un
tableau nommé \texttt{temperatures\_ci}, et nous allons modifier le nom
des colonnes \texttt{y}, \texttt{ymin}, et \texttt{ymax} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_ci }\OtherTok{\textless{}{-}}\NormalTok{ weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(origin, month, day) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{temperature\_max =} \FunctionTok{max}\NormalTok{(temp\_celsius, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{mean\_cl\_normal}\NormalTok{(temperature\_max)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{moyenne =}\NormalTok{ y,}
         \AttributeTok{ci\_borne\_inf =}\NormalTok{ ymin,}
         \AttributeTok{ci\_borne\_sup =}\NormalTok{ ymax)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`summarise()` has grouped output by 'origin', 'month'. You can override using
the `.groups` argument.
`summarise()` has grouped output by 'origin'. You can override using the
`.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_ci}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne ci_borne_inf ci_borne_sup
   <chr>  <int>   <dbl>        <dbl>        <dbl>
 1 EWR        1    5.69         3.36         8.01
 2 EWR        2    4.74         3.17         6.30
 3 EWR        3    8.20         6.88         9.53
 4 EWR        4   16.4         14.6         18.3 
 5 EWR        5   22.2         20.1         24.2 
 6 EWR        6   27.4         25.8         28.9 
 7 EWR        7   31.0         29.5         32.4 
 8 EWR        8   27.8         27.0         28.6 
 9 EWR        9   24.6         23.1         26.0 
10 EWR       10   20.0         18.2         21.8 
# ... with 26 more rows
\end{verbatim}

Maintenant, si l'on compare les 2 tableaux contenant les calculs
d'intervalles de confiance de la moyenne, on constate que les résultats
sont très proches :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_ci\_approx}
\NormalTok{temperature\_ci}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}[t]{0.50\linewidth}

{\centering 

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne ci_borne_inf ci_borne_sup
   <chr>  <int>   <dbl>        <dbl>        <dbl>
 1 EWR        1    5.69         3.46         7.92
 2 EWR        2    4.74         3.24         6.23
 3 EWR        3    8.20         6.93         9.47
 4 EWR        4   16.4         14.6         18.2 
 5 EWR        5   22.2         20.1         24.2 
 6 EWR        6   27.4         25.8         28.9 
 7 EWR        7   31.0         29.6         32.3 
 8 EWR        8   27.8         27.0         28.5 
 9 EWR        9   24.6         23.2         26.0 
10 EWR       10   20.0         18.3         21.7 
# ... with 26 more rows
\end{verbatim}

}

\end{minipage}%
%
\begin{minipage}[t]{0.50\linewidth}

{\centering 

\begin{verbatim}
# A tibble: 36 x 5
# Groups:   origin [3]
   origin month moyenne ci_borne_inf ci_borne_sup
   <chr>  <int>   <dbl>        <dbl>        <dbl>
 1 EWR        1    5.69         3.36         8.01
 2 EWR        2    4.74         3.17         6.30
 3 EWR        3    8.20         6.88         9.53
 4 EWR        4   16.4         14.6         18.3 
 5 EWR        5   22.2         20.1         24.2 
 6 EWR        6   27.4         25.8         28.9 
 7 EWR        7   31.0         29.5         32.4 
 8 EWR        8   27.8         27.0         28.6 
 9 EWR        9   24.6         23.1         26.0 
10 EWR       10   20.0         18.2         21.8 
# ... with 26 more rows
\end{verbatim}

}

\end{minipage}%

\end{figure}

Les bornes inférieures et supérieures des intervalles de confiance à
95\% des moyennes ne sont pas égales quand on les calcule manuellement
de façon approchée et quand on les calcule de façon exacte, mais les
différences sont minimes.

\hypertarget{visualiser-lincertitude-et-la-dispersion}{%
\section{Visualiser l'incertitude et la
dispersion}\label{visualiser-lincertitude-et-la-dispersion}}

Il existe plusieurs façons de représenter visuellement les positions,
les dispersions et les incertitudes. Concernant les positions et les
dispersions tout d'abord, nous avons déjà vu plusieurs façons de faire
au semestre 3, en particulier dans les parties consacrées aux
histogrammes, aux stripcharts et aux boxplots. Nous reprenons ici
brièvement chacun de ces 3 types de graphique afin de les remettre en
contexte avec ce que nous avons appris ici.

Dans un dernier temps, nous verrons enfin comment visualiser
l'incertitude associée à des calculs de moyennes ou de variance grâce
aux barres d'erreurs ou aux encoches des boîtes à moustaches.

\hypertarget{position-et-dispersion-les-histogrammes}{%
\subsection{Position et dispersion : les
histogrammes}\label{position-et-dispersion-les-histogrammes}}

Je vous renvoie à
\href{https://besibo.github.io/BiometrieS3/03-visualization.html\#les-histogrammes}{la
partie sur les histogrammes} du livre en ligne de biométrie du semestre
3 si vous avez besoin de vous rafraîchir la mémoire. Jetez aussi un œil
la partie sur
\href{https://besibo.github.io/BiometrieS3/03-visualization.html\#sec-factorhisto}{les
histogrammes facettés}.

Les histogrammes permettent de déterminer à la fois où se trouvent les
valeurs les plus fréquemment observées (la position du pic principal
correspond à la tendance centrale), et la dispersion (ou variabilité)
des valeurs autour de la tendance centrale. Par exemple, la fonction
\texttt{facet\_grid()} permet de faire des histogrammes des températures
pour chaque aéroport de New York et chaque mois de l'année 2013 :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ temp\_celsius, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(month))) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey20"}\NormalTok{, }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\FunctionTok{factor}\NormalTok{(month) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ origin, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Températures (ºC)"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Fréquence"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: Removed 1 rows containing non-finite values (`stat_bin()`).
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/unnamed-chunk-55-1.pdf}

}

\end{figure}

Ici, 36 histogrammes sont produits. Ils permettent de constater que :

\begin{itemize}
\tightlist
\item
  les températures évoluent à peu près de la même façon dans les 3
  aéroports (les 3 colonnes de graphiques se ressemblent beaucoup)
\item
  les températures moyennes sont plus faibles en hiver qu'en été, et
  qu'elles sont intermédiaires au printemps et à l'automne. C'est bien
  la position des pics sur l'axe des abscisses qui nous renseigne
  là-dessus. On sait aussi que les températures moyennes les plus fortes
  sont autour de 25 degrés ºC en juillet, alors que ces mêmes
  températures moyennes sont proches de 0 ºC en janvier, février et
  décembre.
\item
  la variabilité des température est comparable pour la plupart des mois
  de l'année, avec une exception au mois d'août où la dispersion des
  valeurs semble plus limitée. Cette fois, c'est l'étalement de
  l'histogramme qui nous renseigne sur la dispersion.
\end{itemize}

\hypertarget{position-et-dispersion-les-stripcharts}{%
\subsection{Position et dispersion : les
stripcharts}\label{position-et-dispersion-les-stripcharts}}

Une autre façon de visualiser à la fois les tendances centrales et les
dispersion consiste à produire un nuage de points ``stripchart''. Là
encore, je vous renvoie à
\href{https://besibo.github.io/BiometrieS3/03-visualization.html\#les-stripcharts}{la
partie sur les stripcharts} du livre en ligne de biométrie du semestre 3
si vous avez besoin de vous rafraîchir la mémoire.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ temp\_celsius, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(month))) }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{shape =} \DecValTok{21}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey20"}\NormalTok{, }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{,}
              \AttributeTok{width =} \FloatTok{0.15}\NormalTok{, }\AttributeTok{height =} \DecValTok{0}\NormalTok{,}
              \AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ origin, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Températures (ºC)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: Removed 1 rows containing missing values (`geom_point()`).
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/unnamed-chunk-56-1.pdf}

}

\end{figure}

Cette fois, nous visualisons la totalité des données disponibles, et non
les données regroupées dans des classes plus ou moins arbitraires. Mais
là encore, on peut facilement comparer la position de chaque série de
données : pour les mois d'été, les températures sont plus élevées que
pour les mois d'hiver. Et la dispersion des données est aussi facile à
comparer entre les mois. Par exemple, la variabilités des températures
en janvier est nettement supérieure à celle du mois de février. C'est
ici l'étendue du nuage de point sur l'axe des ordonnées qui nous permet
de le dire.

\hypertarget{position-et-dispersion-les-boxplots}{%
\subsection{Position et dispersion : les
boxplots}\label{position-et-dispersion-les-boxplots}}

La dernière façon classique de visualiser à la fois les tendances
centrales et les dispersion consiste à produire graphique boîte à
moustaches, ou ``boxplot''. Là encore, je vous renvoie à
\href{https://besibo.github.io/BiometrieS3/03-visualization.html\#les-boîtes-à-moustaches-ou-boxplots}{la
partie sur les boxplots} du livre en ligne de biométrie du semestre 3 si
vous avez besoin de vous rafraîchir la mémoire.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ temp\_celsius, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(month))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ origin, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Températures (ºC)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/unnamed-chunk-57-1.pdf}

}

\end{figure}

Vous voyez que le code est très proche pour produire un stripchart ou un
boxplot. Comme indiqué au semestre 3, les différents éléments de chaque
boîte nous renseignent sur la position et sur la dispersion des données
pour chaque mois et chaque aéroport :

\begin{itemize}
\tightlist
\item
  La limite inférieure de la boîte correspond au premier quartile : 25\%
  des données de l'échantillon sont situées au-dessous de cette valeur.
\item
  La limite supérieure de la boîte correspond au troisième quartile :
  25\% des données de l'échantillon sont situées au-dessus de cette
  valeur.
\item
  Le segment épais à l'intérieur de la boîte correspond au second
  quartile : c'est la médiane de l'échantillon, qui nous renseigne sur
  la position de la distribution. 50\% des données de l'échantillon sont
  situées au-dessus de cette valeur, et 50\% au-dessous.
\item
  La hauteur de la boîte correspond à l'étendue (ou intervalle)
  inter-quartile ou Inter Quartile Range (IQR) en anglais. On trouve
  dans cette boîte 50\% des observations de l'échantillon. C'est une
  mesure de la dispersion des 50\% des données les plus centrales. Une
  boîte plus allongée indique donc une plus grande dispersion.
\item
  Les moustaches correspondent à des valeurs qui sont en dessous du
  premier quartile (pour la moustache du bas) et au-dessus du troisième
  quartile (pour la moustache du haut). La règle utilisée dans
  \texttt{R} est que ces moustaches s'étendent jusqu'aux valeurs
  minimales et maximales de l'échantillon, mais elles ne peuvent en
  aucun cas s'étendre au-delà de 1,5 fois la hauteur de la boîte (1,5
  fois l'IQR) vers le haut et le bas. Si des points apparaissent au-delà
  des moustaches (vers le haut ou le bas), ces points sont appelés
  ``outliers''. On peut en observer un pour l'espèce Adélie. Ce sont des
  points qui s'éloignent du centre de la distribution de façon
  importante puisqu'ils sont au-delà de 1,5 fois l'IQR de part et
  d'autre du premier ou du troisième quartile. Il peut s'agir
  d'anomalies de mesures, d'anomalies de saisie des données, ou tout
  simplement, d'enregistrements tout à fait valides mais atypiques ou
  extrêmes. J'attire votre attention sur le fait que la définition de
  ces outliers est relativement arbitraire. Nous pourrions faire le
  choix d'étendre les moustaches jusqu'à 1,8 fois l'IQR (ou 2, ou 2,5).
  Nous observerions alors beaucoup moins d'outliers. D'une façons
  générale, la longueur des moustaches renseigne sur la variabilité des
  données en dehors de la zone centrale. Plus elles sont longues, plus
  la variabilité est importante. Et dans tous les cas, l'examen attentif
  des outliers est utile car il nous permet d'en apprendre plus sur le
  comportement extrême de certaines observations.
\end{itemize}

Lorsque les boîtes ont une forme à peu près symétrique de part et
d'autre de la médiane (c'est le cas pour cet exemple dans la plupart des
catégories), cela signifie qu'un histogramme des mêmes données serait
symétrique également

Les stripcharts et les boxplots sont donc un bon moyen de comparer
rapidement la position et la dispersion d'un grand nombre de séries de
données : ici, en quelques lignes de code, nous en comparons 12 pour
chacun des 3 aéroports de New York.

Les histogrammes sont plus utiles lorsqu'il y a moins de catégories à
comparer. Ils permettent en outre de mieux visualiser les distribution
non symétriques, ou qui présentes plusieurs pics.

\hypertarget{visualiser-lincertitude-les-barres-derreur}{%
\subsection{Visualiser l'incertitude : les barres
d'erreur}\label{visualiser-lincertitude-les-barres-derreur}}

Comme évoqué plus haut, il est important de ne pas confondre dispersion
et incertitude. Lorsque l'on visualise des moyennes calculées à partir
des données d'un échantillon, il est important de faire apparaître des
barres d'erreurs, qui correspondent en générale :

\begin{itemize}
\tightlist
\item
  soit à l'erreur standard de la moyenne
\item
  soit à l'intervalle de confiance de la moyenne
\end{itemize}

Puisque deux choix sont possibles, il sera important de préciser
systématiquement dans la légende du graphique, la nature des barres
représentées. Commençons par visualiser les températures mensuelles avec
les erreurs standards. Pour cela, je reprends le tableau
\texttt{temperatures\_se} créé précédemment :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperatures\_se }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ moyenne)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_errorbar}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ moyenne }\SpecialCharTok{{-}}\NormalTok{ erreur\_standard,}
                    \AttributeTok{ymax =}\NormalTok{ moyenne }\SpecialCharTok{+}\NormalTok{ erreur\_standard),}
                \AttributeTok{width =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{origin, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }
       \AttributeTok{y =} \StringTok{"Moyenne des températures quotidiennes maximales (ºC)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/fig-errorbar-se-1.pdf}

}

\caption{\label{fig-errorbar-se}Températures moyennes mensuelles
observées en 2013 dans les 3 aéroports de New York. Les barres d'erreur
sont les erreurs standard}

\end{figure}

Vous remarquerez que :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  j'associe \texttt{factor(month)}, et non simplement \texttt{month}, à
  l'axe des \texttt{x} afin d'avoir, sur l'axe des abscisses, des
  chiffres cohérents allant de 1 à 12, et non des chiffres à virgule
\item
  l'argument \texttt{group\ =\ 1} doit être ajouté pour que la ligne
  reliant les points apparaisse. En effet, les lignes sont censées
  relier des points qui appartiennent à une même série temporelle. Or
  ici, nous avons transformé \texttt{month} en facteur. Préciser
  \texttt{group\ =\ 1} permet d'indiquer à \texttt{geom\_line()} que
  toutes les catégories du facteur \texttt{month} appartiennent au même
  groupe, que ce facteur peut être considéré comme une variable
  continue, et qu'il est donc correct de relier les points.
\item
  la fonction \texttt{geom\_errorbar()} contient de nouvelles
  caractéristiques esthétiques qu'il nous faut obligatoirement
  renseigner : les extrémités inférieures et supérieures des barres
  d'erreur. Il nous faut donc associer 2 variables à ces
  caractéristiques esthétiques. Ici, nous utilisons
  \texttt{moyenne\ -\ erreur\_std} pour la borne inférieure des barres
  d'erreur, et \texttt{moyenne\ +\ erreur\_std} pour la borne
  supérieure. Les variables \texttt{moyenne} et
  \texttt{erreur\_standard} faisant partie du tableau
  \texttt{temperatures\_se}, \texttt{geom\_errorbar()} les trouve sans
  difficulté.
\item
  l'argument \texttt{width} de la fonction \texttt{geom\_errorbar()}
  permet d'indiquer la longueur des segments horizontaux qui
  apparaissent à chaque extrémité des barres d'erreur.
\end{enumerate}

Ici, bien que moins lisible, on peut aussi faire apparaître les trois
courbes sur le même graphique, afin de mieux visualiser les similarités
des fluctuations de températures entre les 3 aéroports :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperatures\_se }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ moyenne, }\AttributeTok{color =}\NormalTok{ origin, }\AttributeTok{group =}\NormalTok{ origin)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_errorbar}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ moyenne }\SpecialCharTok{{-}}\NormalTok{ erreur\_standard,}
                    \AttributeTok{ymax =}\NormalTok{ moyenne }\SpecialCharTok{+}\NormalTok{ erreur\_standard),}
                \AttributeTok{width =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }
       \AttributeTok{y =} \StringTok{"Moyenne des températures quotidiennes maximales (ºC)"}\NormalTok{,}
       \AttributeTok{color =} \StringTok{"Aéroport"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/fig-errorbar-se_all-1.pdf}

}

\caption{\label{fig-errorbar-se_all}Températures moyennes mensuelles
observées en 2013 dans les 3 aéroports de New York. Les barres d'erreur
sont les erreurs standard}

\end{figure}

De la même façon, nous pouvons parfaitement faire apparaître, au lieu
des erreurs standards, les intervalles de confiance à 95\% de chaque
valeur de température moyenne. Il nous suffit pour cela d'utiliser le
tableau \texttt{temperatures\_ci} qui contient les valeurs de moyennes
et des bornes supérieures et inférieures de ces intervalles :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temperature\_ci }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ moyenne, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_errorbar}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ ci\_borne\_inf, }\AttributeTok{ymax =}\NormalTok{ ci\_borne\_sup), }\AttributeTok{width =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{origin, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }
       \AttributeTok{y =} \StringTok{"Moyenne des températures quotidiennes maximales (ºC)"}\NormalTok{,}
       \AttributeTok{color =} \StringTok{"Aéroport"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/fig-errorbar-ci-1.pdf}

}

\caption{\label{fig-errorbar-ci}Températures moyennes mensuelles
observées en 2013 dans les 3 aéroports de New York. Les barres d'erreur
sont les intervalels de confiance à 95\% des moyenes mensuelles.}

\end{figure}

Comme vous voyez, les barres d'erreurs sont maintenant plus longues que
sur la Figure~\ref{fig-errorbar-se}. C'est normal car rappelez-vous que
les intervalles de confiance sont à peu près équivalents à 2 fois les
erreurs standards. L'intérêt de représenter les intervalles de confiance
est qu'ils sont directement liés aux tests statistiques que nous
aborderons dans les chapitres suivants. Globalement, quand 2 séries de
données ont des intervalles de confiance qui se chevauchent largement
(comme les mois de janvier et février par exemple), alors, un test
d'hypothèse conclurait presque toujours à l'absence de différence
significative entre les 2 groupes. À l'inverse, quand 2 séries de
données ont des intervalles de confiance qui ne se chevauchent pas du
tout (comme les mois de mars et d'avril par exemple), alors, un test
d'hypothèse conclurait presque toujours à l'existence d'une différence
significative entre les 2 groupes. Lorsque les intervalles de confiance
entre 2 catégorie se chevauchent faiblement ou partiellement (comme
entre les mois de juin et juillet pour l'aéroport LGA), la situation est
moins tranchée, et nous devrons nous en remettre aux résultats du test
pour savoir si une différence devrait être considérée comme
significative ou non.

\hypertarget{visualiser-lincertitude-les-bouxeetes-uxe0-moustaches}{%
\subsection{Visualiser l'incertitude : les boîtes à
moustaches}\label{visualiser-lincertitude-les-bouxeetes-uxe0-moustaches}}

Outre les informations de position et de dispersion, les boîtes à
moustaches permettent également de visualiser l'incertitude associée aux
médianes. Il suffit pour cela d'ajouter l'argument
\texttt{notch\ =\ TRUE} dans la fonction \texttt{geom\_boxplot()} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{temp\_celsius =}\NormalTok{ (temp }\SpecialCharTok{{-}} \DecValTok{32}\NormalTok{) }\SpecialCharTok{/} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(month), }\AttributeTok{y =}\NormalTok{ temp\_celsius, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(month))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{notch =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ origin, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Mois"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Températures (ºC)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{./01-EDA_files/figure-pdf/unnamed-chunk-61-1.pdf}

}

\end{figure}

Des encoches ont été ajoutées autour de la médiane de chaque boîte à
moustache. Ces encoches sont des encoches d'incertitudes. Les limites
inférieures et supérieures de ces encoches correspondent aux bornes
inférieures et supérieures de l'intervalle de confiance à 95\% des
médianes. Comme pour les moyennes, le chevauchement ou l'absence de
chevauchement entre les encoches de 2 séries de données nous
renseigneront sur l'issue probable des futurs tests statistiques que
nous devrons réaliser. Il sera donc important de bien examiner ces
encoches en amont des tests statistiques pour éviter de faire/dire des
bêtises\ldots{}

\hypertarget{exercice-1}{%
\subsection{Exercice}\label{exercice-1}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Avec le tableau \texttt{penguins}, calculez les grandeurs suivantes
  pour chaque espèce de manchot et chaque sexe :
\end{enumerate}

\begin{itemize}
\tightlist
\item
  la moyenne de la longueur des nageoires
\item
  la variance de la longueur des nageoires
\item
  l'écart-type de la longueur des nageoires
\item
  l'erreur standard de la longueur moyenne des nageoires
\item
  la moyenne de la masse corporelle
\item
  la variance de la masse corporelle
\item
  l'écart-type de la masse corporelle
\item
  l'erreur standard de la masse corporelle moyenne
\end{itemize}

Attention : pensez à retirer les individus dont le sexe est inconnu.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  Vérifiez avec la fonction \texttt{skim()} que les moyennes et
  écart-types calculés ci-dessus sont corrects.
\item
  Avec ces données synthétiques faites le graphique suivant :
\end{enumerate}

\includegraphics{./01-EDA_files/figure-pdf/unnamed-chunk-62-1.pdf}

\bookmarksetup{startatroot}

\hypertarget{sec-prop}{%
\chapter{Principes des tests statistiques et comparaison de
proportions}\label{sec-prop}}

Sera traité au semestre prochain. Passez directement au
Chapitre~\ref{sec-cohortes}.

\bookmarksetup{startatroot}

\hypertarget{sec-moy1}{%
\chapter{Comparaison de moyennes : un échantillon et deux échantillons
appariés}\label{sec-moy1}}

Sera traité au semestre prochain. Passez directement au
Chapitre~\ref{sec-cohortes}.

\bookmarksetup{startatroot}

\hypertarget{sec-moy2}{%
\chapter{Comparaison de moyennes : deux échantillons
indépendants}\label{sec-moy2}}

Sera traité au semestre prochain. Passez directement au
Chapitre~\ref{sec-cohortes}.

\bookmarksetup{startatroot}

\hypertarget{sec-cohortes}{%
\chapter{Analyse de cohortes}\label{sec-cohortes}}

\hypertarget{objectifs-1}{%
\section{Objectifs}\label{objectifs-1}}

Cette section doit permettre d'illustrer la partie du cours de
Population Dynamics de l'EC ``Fonctionnement des écosystèmes'' consacrée
à l'analyse des cohortes. Vous utiliserez les tailes corporelles
d'individus échantillonnés sur le terrain à plusieurs dates pour :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Produire la structure démographique instantanée de la population pour
  chaque date d'échantillonnage
\item
  Réaliser la décomposition polymodale pour identifier les cohortes à
  chaque date d'échantillonnage
\item
  Créer une courbe de croissance et une courbe de mortalité
\item
  Utiliser une relation allométrique pour passer de la taille des
  individus à leur masse
\item
  Produire la courbe d'Allen
\end{enumerate}

Vous devrez en premier lieu importer les données fournies dans un
fichier Excel et vous assurer qu'elles sont dans un format permettant
les analyses et représentations graphiques.

\hypertarget{sec-pres}{%
\section{Présentation de l'étude}\label{sec-pres}}

Le suivi démographique des populations animales est extrêmement fréquent
dans le domaine de l'écologie. Le suivi des populations naturelles est
particulièrement pertinent dans un contexte de conservation, pour
réaliser des études d'impact ou pour mesurer l'évolution de la
biodiversité.

Ici, une population de gastéropodes \emph{Nassarius reticulatus} (la
nasse réticulée) a été suivie pendant 5 ans. Deux sessions
d'échantillonnage ont été organisées chaque année depuis 2010 : la
première a été réalisée en mars, juste après le recrutement des
juvéniles, et la seconde a été réalisée 6 mois plus tard, en septembre.
Tous les échantillons ont été collectés au même endroit, selon la même
méthode (collecte systématique de tous les individus présents à
l'intérieur de 10 quadrats positionnés aléatoirement dans la zone
d'étude), lors d'une marée basse de fort coefficient (marées de
printemps et d'automne). Les individus échantillonnés ont été mesurés
sur place, de la base, à l'apex de la coquille (voir
Figure~\ref{fig-nasse}) à l'aide d'un pied à coulisse (précision :
centième de millimètre) et relâchés sur place.

\begin{marginfigure}

{\centering \includegraphics{./images/Nassarius.png}

}

\caption{\label{fig-nasse}Coquille de nasse réticulée \emph{Nassarius
reticulatus} (Linnaeus, 1758)}

\end{marginfigure}

L'espèce étudiée présente les caractéristiques suivantes :

\begin{itemize}
\tightlist
\item
  Les individus ont une durée de vie de 5 ans en moyenne.
\item
  Les plus grand individus peuvent atteindre une taille de plus de 40
  millimètres.
\item
  Il n'y a qu'une seule période de reproduction chaque année. Il n'y a
  donc qu'un unique recrutement chaque année, au tout début du mois de
  mars.
\end{itemize}

Des travaux antérieurs réalisés au laboratoire ont montré que la taille
et la masse des individus étaient liées par la relation allométrique
suivante :

\[w = 0.0013 \cdot l^{2.3}\]

avec \(w\), la masse en grammes et \(l\) la longueur des coquilles en
millimètres.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-important-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Objectif principal}, colbacktitle=quarto-callout-important-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]
L'objectif principal de cette étude est de produire la courbe d'Allen
d'une cohorte de cette populations. Cette courbe sera utilisée pour
déterminer des gains et des pertes de biomasses au sein de l'écosystème
étudié. Les étapes nécessaires à la production de cette courbe sont
présentées ci-dessous.
\end{tcolorbox}

\hypertarget{avant-de-vous-lancer}{%
\section{Avant de vous lancer\ldots{}}\label{avant-de-vous-lancer}}

Pour travailler dans de bonnes conditions, vous aurez absolument besoin
de travailler dans un script et à l'intérieur d'un \texttt{Rproject}. Si
vous ne savez plus comment faire, reportez-vous aux chapitrex
correspondants du livre en ligne de Biométrie du semestre 3 :
\href{https://besibo.github.io/BiometrieS3/01-R-basics.html\#sec-script}{au
sujet des scripts} et
\href{https://besibo.github.io/BiometrieS3/01-R-basics.html\#les-projets-ou-rprojects}{au
sujet des \texttt{Rprojects}}. Vous devrez notamment (liste non
exhaustive !) :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Créer un nouveau script (nommez-le \texttt{Nasses.R})
\item
  Télécharger (si besoin) et charger quelques packages (voir plus bas)
\item
  Télécharger dans votre répertoire de travail le fichier Nassarius.csv
\item
  Importer dans \texttt{RStudio} les données du fichier
  \texttt{Nassarius.csv}
\end{enumerate}

Pour cette section, vous aurez besoin des packages suivants :

\begin{itemize}
\tightlist
\item
  \texttt{tidyverse} : pour manipuler les données et faire des
  graphiques (Wickham et al. 2019)
\item
  \texttt{mixdist} : pour effectuer les décompositions polymodales
  (Macdonald et Juan Du 2018)
\end{itemize}

Si vous ne savez plus comment installer et charger des packages en
mémoire, reportez-vous au chapitre correspondant du
\href{https://besibo.github.io/BiometrieS3/01-R-basics.html\#sec-packages}{livre
en ligne de Biométrie du semestre 3}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(mixdist)}
\end{Highlighting}
\end{Shaded}

Pour importer les données, utilisez l'assistant d'importation de
\texttt{RStudio}. Notez que :

\begin{itemize}
\tightlist
\item
  Les colonnes sont séparées par des tabulations
\item
  Le symbole utilisé pour les décimales dans le fichier
  \texttt{Nassarius.csv} est la virgule
\end{itemize}

Vous devrez donc spécifier correctement ces éléments pour pouvoir
importer le fichier dans le logiciel. Si vous ne savez plus comment
faire, reportez-vous au chapitre correspondant du
\href{https://besibo.github.io/BiometrieS3/04-DataWrangling.html\#plaintext}{livre
en ligne de Biométrie du semestre 3}.

Si l'importation s'est déroulée normalement, vous devriez maintenant
disposer de l'objet nommé \texttt{Nassarius} suivant :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Nassarius}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3,710 x 2
    size date    
   <dbl> <chr>   
 1  4.8  march-10
 2  3    march-10
 3  5.56 march-10
 4  3.74 march-10
 5  4.1  march-10
 6  2.21 march-10
 7  2.75 march-10
 8  3.18 march-10
 9  2.56 march-10
10  4.36 march-10
# ... with 3,700 more rows
\end{verbatim}

Et la commande suivante devrait produire exactement ces résultats :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Nassarius }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(date)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 10 x 2
   date         n
   <chr>    <int>
 1 march-10   468
 2 march-11   481
 3 march-12   460
 4 march-13   468
 5 march-14   487
 6 sept-10    268
 7 sept-11    276
 8 sept-12    265
 9 sept-13    258
10 sept-14    279
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{\%\textgreater{}\%} : le pipe est un opérateur spécial qui prend
l'objet situé à gauche et le transmets à la fonction placée à droite, en
guise de premier argument. P. ex. :
\texttt{Nassarius\ \%\textgreater{}\%\ count(date)} est équivalent à
\texttt{count(Nassarius,\ date)}\\
\texttt{count()} : compte le nombre d'occurrences de chaque valeur
possible (ou niveau/modalité) d'une variable catégorielle (ou facteur).

\end{footnotesize}}

\hypertarget{les-uxe9tapes-de-lanalyse}{%
\section{Les étapes de l'analyse}\label{les-uxe9tapes-de-lanalyse}}

Pour produire une courbe d'Allen, de nombreuses étapes sont nécessaires.
Vous devrez :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Produire la \emph{structure démographique instantanée} de la
  population à chaque date d'échantillonnage
\item
  Réaliser la \emph{décomposition polymodale} pour identifier les
  cohortes présentes dans la population à chaque date d'échantillonnage.
\item
  Déterminer la taille moyenne de la coquille des individus de la
  cohorte d'intérêt, à chaque date d'échantillonnage, pour produire la
  \emph{courbe de croissance}
\item
  Déterminer l'abondance des individus de la cohorte d'intérêt, à chaque
  date d'échantillonnage, pour produire la \emph{courbe de survie}
\end{enumerate}

Je vais présenter ci-dessous les étapes de cette procédure \textbf{pour
une unique date d'échantillonnage} : march 2010. Vous devrez reproduire
ces étapes pour les 9 autres dates d'échantillonnage.

\hypertarget{suxe9lection-des-donnuxe9es-dune-date-spuxe9cifique}{%
\section{Sélection des données d'une date
spécifique}\label{suxe9lection-des-donnuxe9es-dune-date-spuxe9cifique}}

Notre jeu de données \texttt{Nassrisu} contient 2 colonnes : la première
contient les dates d'échantillonnage et la seconde les tailles
individuelles en millimètres. La première étape consiste à créer un
nouvel objet (nous le nommerons \texttt{Nas\_01}) qui contiendra
uniquement les données collectées lors de la toute première session
d'échantillonnage de mars 2010. Vous devriez déjà savoir comment
utiliser la fonction \texttt{filter()} pour le faire :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Nas\_01 }\OtherTok{\textless{}{-}}\NormalTok{ Nassarius }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(date }\SpecialCharTok{==} \StringTok{"march{-}10"}\NormalTok{)}

\NormalTok{Nas\_01}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 468 x 2
    size date    
   <dbl> <chr>   
 1  4.8  march-10
 2  3    march-10
 3  5.56 march-10
 4  3.74 march-10
 5  4.1  march-10
 6  2.21 march-10
 7  2.75 march-10
 8  3.18 march-10
 9  2.56 march-10
10  4.36 march-10
# ... with 458 more rows
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{filter()} : permet de filtrer les lignes d'un tableau (ici
\texttt{Nassarius}) pour ne conserver que celles qui remplissent une
condition spécifiée par l'utilisateur (ici
\texttt{date\ ==\ "march\_10"})

\end{footnotesize}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(Nassarius)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3710    2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(Nas\_01)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 468   2
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{dim()} : Affiche le nombre de lignes et de colonnes d'un
tableau.

\end{footnotesize}}

Comme nous pouvons le constater, on passe du tableau original
\texttt{Nasarius} contenant 3710 lignes à un nouveau tableau
\texttt{Nas\_01} qui en contient seulement 468.

\hypertarget{structure-duxe9mographique-instantanuxe9e}{%
\section{Structure démographique
instantanée}\label{structure-duxe9mographique-instantanuxe9e}}

Maintenant que nous disposons d'une table \texttt{Nas\_01} qui contient
uniquement la taille des individus collectés en mars 2010, il nous faut
visualiser la structure démographique instantanée afin de déterminer
combien de cohortes étaient présentes dans la population à cette date.
La structure démographique instantanée est ici simplement un histogramme
présentant la distribution des tailles individuelles. Nous allons donc
placer la taille des individus sur l'axe des \texttt{x} en guise de
descripteur individuel, et sur l'axe des \texttt{y}, \texttt{RStudio}
placera automatiquement l'abondance pour chaque classe de taille en
guise de descripteur populationel.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Nas\_01 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ size)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\begin{figure}[H]

\sidecaption{\label{fig-histo1}Structure démographique instantanée}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-histo1-1.pdf}

}

\end{figure}

\marginnote{\begin{footnotesize}

\texttt{ggplot()} : crée un graphique\\
\texttt{aes()} : associe une variable d'un jeu de données à une
caractéristique esthétique d'un graphique (p.~ex. la position le long de
l'axe des \texttt{x} ou des \texttt{y}, la couleur, la forme, la taille,
etc.)\\
\texttt{geom\_histogram()} : ajoute un objet géométrique de type
histogramme à une graphique produit par \texttt{ggplot()}

\end{footnotesize}}

Notez le message d'avertissement qui s'affiche quand vous produisez cet
histogramme. Il indique que \texttt{R} a choisi pour nous le nombre de
classes de tailles. Par défaut, il crée 30 classes, mais nous indique
que ce n'est certainement pas le meilleur choix. Nous allons donc devoir
créer nous même manuellement les classes de tailles pour (i) identifier
les cohortes présentes dans la population et (ii) fixer des classes
identiques que nous utiliserons pour toutes les autres dates
d'échantillonnage et qui rendront les comparaisons plus aisées.

Puisque les individus de cette espèce peuvent atteindre une taille de 40
millimètres environ, nous allons définir des classes de tailles tous les
millimètres. On peut faire ça simplement en créant un vecteur qui
contient les limites des classes de tailles que l'on souhaite :

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calcul de la taille maximale observée}
\NormalTok{taille\_max }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(Nassarius}\SpecialCharTok{$}\NormalTok{size, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{taille\_max}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 41.33
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{max()} : affiche la valeur maximale contenue dans un vecteur

\end{footnotesize}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Définition des limites des classes de tailles}
\NormalTok{limites }\OtherTok{\textless{}{-}} \DecValTok{0}\SpecialCharTok{:}\NormalTok{(taille\_max }\SpecialCharTok{+} \DecValTok{1}\NormalTok{)}
\NormalTok{limites}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
[26] 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{:} : l'opérateur ``deux points'' permet de créer des suites
d'entiers

\end{footnotesize}}

L'objet \texttt{limites} contient les limites des classes de tailles que
nous utiliserons pour produire les structures démographiques
instantanées, pour chaque date d'échantillonnage, et pas seulement pour
mars 2010. C'est la raison pour nous avons utilisé
\texttt{max(Nassarius\$size)\ +1} : cette syntaxe nous assure que nos
classes de tailles recouvrent bien la taille de tous les individus
échantillonnés au cours des 5 années d'études. Ainsi, nous pourrons
utiliser les mêmes classes de tailles pour toutes les dates.

Maintenant, on peut utiliser le vecteur \texttt{limites} comme argument
de la fonction \texttt{geom\_histogram()}. On modifie aussi les couleurs
des barres de l'histogramme pour mieux visualiser les classes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Nas\_01 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ size)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ limites, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\sidecaption{\label{fig-histo2}Structure démographique instantanée
utilisable pour la décomposition polymodale}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-histo2-1.pdf}

}

\end{figure}

Cette structure démographique instantanée (Figure~\ref{fig-histo2}) fait
apparaître 5 cohortes, bien que la plus âgée soit à peine visible. Les
pics, ou modes, sont situés autour de 4, 9, 17, 30 et 34 millimètres.
Ces valeurs approximatives sont importantes car nous les utiliserons
pour réaliser la décomposition polymodale.

\hypertarget{duxe9composition-polymodale}{%
\section{Décomposition polymodale}\label{duxe9composition-polymodale}}

\hypertarget{principe-et-uxe9tapes}{%
\subsection{Principe et étapes}\label{principe-et-uxe9tapes}}

Effectuer une décomposition polymodale revient à tenter d'ajuster une
distribution Normale à chaque cohorte de la population. Puisque nous
avons identifié 5 cohortes dans la population en mars 2010, il nous faut
identifier 5 distribution Normales distinctes dont la somme reproduira
le plus fidèlement possible la structure démographique instantanée
observée. Plusieurs étapes sont requises pour y parvenir.

Nous allons utiliser le package \texttt{mixdist}, que vous devez avoir
déjà installé et chargé en mémoire. Ce package fournit plusieurs
fonctions relativement simples d'utilisation et qui permettent d'ajuster
des distributions Normales à une distribution observée (notre structure
démographique instantanée).

La fonction du package \texttt{mixdist} qui nous permettra de réaliser
la décomposition polymodale est la fonction \texttt{mix()}. Son fichier
d'aide nous indique que pour fonctionner correctement, il faut lui
fournir plusieurs choses :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?}\FunctionTok{mix}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\marginnote{\begin{footnotesize}

\texttt{?} : l'opérateur ``point d'interrogation'' suivi du nom d'une
fonction, permet d'ouvrir le fichier d'aide de cette fonction.

\end{footnotesize}}

Les deux premiers arguments de la fonction \texttt{mix()} ne possèdent
pas de valeur par défaut. Nous devons donc spécifier nous même ces deux
arguments :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Le premier s'appelle \texttt{mixdat}. Il doit obligatoirement s'agir
  d'un tableau de données (\texttt{data.frame} ou \texttt{tibble})
  contenant 2 colonnes. La première colonne doit contenir les limites
  supérieures des classes de tailles de notre structure démographique
  instantanée. Le dernier élément de cette colonne doit être ``ouvert''
  : il doit être fixé à \(+\infty\). La seconde colonne doit contenir
  les abondances pour chaque classe de taille de la structure
  démographique instantanée. Nous allons voir juste après comment créer
  cet objet \texttt{mixdat}.
\item
  Le second argument s'appelle \texttt{mixpar}. Là encore, il s'agit
  d'un tableau de données. Il doit contenir des valeurs approchées pour
  les paramètres des distributions Normales que nous souhaitons ajuster
  à chacune de nos 5 cohortes. Chaque distribution Normale possède 2
  paramètres : la moyenne (qui correspond à la position du pic sur l'axe
  des \texttt{x} d'un histogramme) et l'écart-type (qui correspond à
  l'étalement de la courbe en cloche, c'est-à-dire à la dispersion des
  données de part et d'autre de la moyenne). Là encore, nous verrons
  plus bas comment créer cet objet.
\end{enumerate}

\hypertarget{cruxe9ation-du-premier-objet}{%
\subsection{Création du premier
objet}\label{cruxe9ation-du-premier-objet}}

Pour créer le premier tableau qui sera utilisé comme argument
\texttt{mixdat} de la fonction \texttt{mix()}, nous allons nous servir
de la fonction \texttt{mixgroup()} du package \texttt{mixdist}. Elle est
très simple `a utiliser puisqu'elle n'a besoin que de 2 arguments :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Un vecteur de données (ici, la taille de tous les individus
  échantillonnés en mars 2010)
\item
  La liste des valeurs correspondant aux limites des classes de tailles
  de la structure démographique instantanée. Nous disposons déjà de cet
  objet puisque nous l'avons créé plus tôt : c'est le vecteur
  \texttt{limites}
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mix\_01 }\OtherTok{\textless{}{-}} \FunctionTok{mixgroup}\NormalTok{(Nas\_01}\SpecialCharTok{$}\NormalTok{size, }\AttributeTok{breaks =}\NormalTok{ limites)}
\FunctionTok{class}\NormalTok{(mix\_01)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "mixdata"    "data.frame"
\end{verbatim}

L'objet \texttt{mix\_01} que nous venons de créer est donc un
\texttt{data.frame}, mais c'est aussi un objet de classe
\texttt{mixdata} que nous utiliserons en guise de premier argument de la
fonction \texttt{mix()}. Pour afficher son contenu, il suffit comme
toujours de taper son nom :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mix\_01}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     X count
1    1     1
2    2     6
3    3    39
4    4    70
5    5    69
6    6    30
7    7    19
8    8    23
9    9    26
10  10    33
11  11    19
12  12     7
13  13     2
14  14     1
15  15     4
16  16     5
17  17    10
18  18    15
19  19     7
20  20    13
21  21     6
22  22     5
23  23     2
24  24     1
25  25     4
26  26     4
27  27     6
28  28     2
29  29     7
30  30     8
31  31     3
32  32     4
33  33     3
34  34     4
35  35     3
36  36     1
37  37     2
38  38     2
39  39     2
40  40     0
41  41     0
42 Inf     0
\end{verbatim}

Notez que la dernière ligne de \texttt{mix\_01} correspond à la
catégorie {[}42 mm ; \(+\infty\){[}. Pour vérifier que nous n'avons pas
fait d'erreur, on peut faire une représentation graphique de cet objet
particulier avec la fonction \texttt{plot()} :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(mix\_01, }\AttributeTok{xlab =} \StringTok{"Size (mm)"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Probability"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\sidecaption{\label{fig-mixplot}Le contenu de \texttt{mix\_01}
correspond exactement à la structure démographique instantanée de mars
2010. La ligne bleue est le contour de la structure démographique
instantanée, qui devra être approchée par la superposition de 5 courbes
Normales correspondant au 5 cohortes qui composent la population en mars
2010}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-mixplot-1.pdf}

}

\end{figure}

\marginnote{\begin{footnotesize}

\texttt{plot()} : fonction générique permettant de produire des
graphiques sans \texttt{ggplot2}. La forme du résultat dépendra de la
classe de l'objet utilisé comme argument.

\end{footnotesize}}

Au final, l'objet \texttt{mix\_01} est simplement la structure
démographique instantanée de mars 2010, présentée dans un format qui
sera compris par la fonction \texttt{mix()} que nous utiliserons pour
effectuer la décomposition polymodale.

\hypertarget{cruxe9ation-du-deuxiuxe8me-objet}{%
\subsection{Création du deuxième
objet}\label{cruxe9ation-du-deuxiuxe8me-objet}}

Pour créer le second \texttt{data.frame()} dont la fonction
\texttt{mix()} aura besoin, nous allons utiliser une autre fonction du
package \texttt{mixdist} : la fonction \texttt{mixparam()}. Cette
fonction prend au minimum 2 arguments :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{mu} : un vecteur qui contient la position approximative des
  modes (ou pics) de chaque cohorte. Si nous avons 5 cohortes à
  identifier, il faudra fournir 5 valeurs pour \texttt{mu}. Pour mars
  2010, nous utiliserons les valeurs présentées plus au, au niveau de la
  Figure~\ref{fig-histo2} (4, 9, 17, 30 et 34 millimètres). Ces valeurs
  changeront pour chaque date d'échantillonnage et il faudra donc
  examiner attentivement les structures démographiques instantanées de
  chaque échantillonnage pour les déterminer. J'insiste sur le fait que
  la position des pics peut être approximative, mais qu'elle ne doit
  malgré tout pas être trop éloignée des vraies valeurs.
\item
  \texttt{sigma} : un vecteur qui contient la valeur approchée de
  l'écart-type de chaque cohorte. L'écart-type d'une cohorte correspond
  à l'étalement des tailles de part et d'autres de la moyenne de la
  cohorte. C'est ce que nous avons appelé ``polymorphisme'' dans le
  cours de dynamique des populations, puisque cet étalement représente
  des performances de croissance variables pour des individus qui sont
  tous nés approximativement en même temps. Là encore, il faut fournir
  autant de valeurs que nous avons de cohortes (soit 5 pour mars 2010).
  Puisque nous n'avons pas d'idée précise d'ordre de grandeur pour ces
  écarts-types, nous utiliserons la valeur \texttt{1} pour chaque
  cohorte.
\end{enumerate}

Ainsi, on obtient le second \texttt{data.frame} ainsi :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{param\_01 }\OtherTok{\textless{}{-}} \FunctionTok{mixparam}\NormalTok{(}\AttributeTok{mu =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{17}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{34}\NormalTok{),}
                     \AttributeTok{sigma =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{param\_01}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   pi mu sigma
1 0.2  4     1
2 0.2  9     1
3 0.2 17     1
4 0.2 30     1
5 0.2 34     1
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{mixparam()} : fonction qui crée un \texttt{data.frame} dans
lequel chaque ligne contient les caractéristiques approchées d'une
cohorte de la population échantillonnée\\
\texttt{c()} : fonction qui permet de créer un vecteur, donc une
collection d'éléments qui sont tous du même type (ici, des valeurs
numériques).

\end{footnotesize}}

La première colonne de ce nouveau \texttt{data.frame}, nommée
\texttt{pi}, correspond à la proportion de l'effectif total
échantillonné, contenu dans chaque cohorte. Puisque nous n'avons rien
spécifié, \texttt{mixparam()} suppose que chaque cohorte contient une
proportion identiques des individus de la population, et fixe donc la
proportion à 0.2 (soit 20\% de l'abondance totale dans chacune des 5
cohortes supposées). Nous savons pertinemment que ces proportions sont
fausses puisqu'en réalité, l'abondance au sein des cohortes décroit avec
l'âge des individus en raison de la mortalité. On sait donc que la
cohorte la plus jeune sera la plus abondante, et que les cohortes plus
âgées seront de moins en moins abondantes. Ces proportions seront
estimées automatiquement par la fonction \texttt{mix()} lorsque nous
réaliserons la décomposition polymodale. Les autres colonnes de
\texttt{param\_01}, qui contiennent les valeurs que nous avons fournies
manuellement, seront également ajustées lors de la décomposition
polymodale

\hypertarget{ajustement-des-lois-normales-aux-donnuxe9es}{%
\subsection{Ajustement des lois Normales aux
données}\label{ajustement-des-lois-normales-aux-donnuxe9es}}

Maintenant que nous disposons des deux objets nécessaires, nous pouvons
réaliser la décomposition polymodale qui consiste, grâce à la fonction
\texttt{mix()}, à ajuster une distribution Normale à chaque cohorte
supposée de la population échantillonnés.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res\_01 }\OtherTok{\textless{}{-}} \FunctionTok{mix}\NormalTok{(mix\_01, param\_01)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning in mix(mix_01, param_01): The optimization process terminated because
iteration limit exceeded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res\_01}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Parameters:
       pi     mu sigma
1 0.46418  3.903 1.086
2 0.27062  8.795 1.555
3 0.14355 18.115 2.102
4 0.09100 28.231 2.861
5 0.03066 35.021 2.344

Distribution:
[1] "norm"

Constraints:
   conpi    conmu consigma 
  "NONE"   "NONE"   "NONE" 
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{mix()} : réalise la décomposition polymodale. La fonction
identifie une combinaison de distributions Normales qui s'ajuste le
mieux possible aux données observées compte tenu des données brutes et
des caractéristiques approximatives de chaque distribution Normale
fournie par l'utilisateur.

\end{footnotesize}}

La fonction \texttt{mix()} peut produire quelques avertissements.
Ignorez-les à ce stade : seuls les messages d'erreurs sont
problématiques et nous y reviendrons plus tard. L'objet \texttt{res\_01}
contient donc les résultats de la décomposition polymodale. C'est une
liste de 3 éléments dont seul le premier nous intéresse.\sidenote{\footnotesize Il
  s'appelle \texttt{parameters}, sans majuscule, même si \texttt{R}
  affiche son nom avec une majuscule. Vous pouvez le vérifier en tapant
  \texttt{str(res\_01)}.} Il contient les valeurs ajustées pour les 3
paramètres des distributions Normales (\texttt{pi}, \texttt{mu} et
\texttt{sigma}) pour chacune des 5 cohortes identifiées en mars 2010.

Ainsi, par exemple, pour l'échantillon de mars 2010, la première ligne
du tableau \texttt{parameters} contenu dans \texttt{res\_01} nous
apprend les choses suivantes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res\_01}\SpecialCharTok{$}\NormalTok{parameters}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          pi        mu    sigma
1 0.46417551  3.903201 1.085989
2 0.27061611  8.795297 1.555004
3 0.14354832 18.114948 2.101807
4 0.09099874 28.230516 2.861214
5 0.03066132 35.020985 2.343520
\end{verbatim}

\begin{itemize}
\tightlist
\item
  La première cohorte représente 46.42\% de l'abondance totale de la
  population
\item
  La taille moyenne des individus composant cette cohorte vaut 3.9
  millimètres
\item
  L'écart-type (ou polymorphisme de taille) de cette cohorte vaut 1.1
  millimètres
\end{itemize}

Les distributions Normales qui ont été ajustées peuvent être visualisées
grâce à la fonction \texttt{plot()} :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(res\_01)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\sidecaption{\label{fig-ajustement}Distribution observée (histogramme
bleu) et cohortes ajustées (courbes rouges). Les triangles indiquent la
position du mode des cohortes et la courbe verte est la somme de toutes
les distributions Normales. Idéallement, cette courbe devrait être
étroitement ajustée aux données observées}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-ajustement-1.pdf}

}

\end{figure}

On observe sur la Figure~\ref{fig-ajustement} et dans l'objet
\texttt{res\_01\$parameters} que la qualité de l'ajustement (et donc de
la décomposition polymodale) est bonne :

\begin{itemize}
\tightlist
\item
  la courbe verte représente bien les données observées : elle est bien
  ajustée aux contours de l'histogramme.
\item
  l'abondance des cohortes décroit avec l'âge de la cohorte :
  \texttt{pi} décroit de la cohorte la plus jeune à la cohorte la plus
  âgée.
\item
  la taille moyenne des individus augmente avec l'âge de la cohorte :
  \texttt{mu} augmente de la cohorte la plus jeune à la cohorte la plus
  âgée.
\item
  le polymorphisme (ou dispersion des tailles autour de la moyenne)
  augmente avec l'âge de la cohorte : \texttt{sigma} augmente de la
  cohorte la plus jeune à la cohorte la plus âgée.
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-important-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{De l'importance du choix des valeurs initiales}, colbacktitle=quarto-callout-important-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]
Si nous avions choisi d'autres valeurs approchée lors de la création de
l'objet \texttt{param\_01} avec la fonction \texttt{mixparam()},
l'ajustement obtenu aurait pu être différent. La décomposition
polymodale n'est pas une science exacte et il est souvent nécessaire de
procéder par tâtonnements pour trouver des valeurs satisfaisantes. En
particulier, les résultats que nous obtenons dépendent :

\begin{itemize}
\tightlist
\item
  du choix des valeurs pour la fonction \texttt{mixparam()}
\item
  du choix des classes de tailles pour la structure démographique
  instantanée. Ici, nous avons des classes de tailles de un millimètre
  de large, mais nous aurions pu faire un autre choix (1,5 millimètre de
  large, ou 2) et nous aurions alors obtenu des résultats différents.
\end{itemize}

Il est donc important de retenir que les résultats obtenus ne sont pas
``justes'' ou ``faux'' en tant que tel et qu'il n'y a pas qu'une seule
``bonne réponse''. La qualité des résultats obtenus s'apprécie au regard
de ce qu'on connait de l'espèce étudiée (traits d'histoire de vie,
période de reproduction et de recrutement, nombre de cohorte supposées
selon la date, etc.), et de ce qu'on connait du comportement ``normal''
des cohortes (baisse de l'abondance avec l'âge, augmentation de la
taille moyenne avec l'âge, augmentation du polymorphisme avec l'âge).
\end{tcolorbox}

\hypertarget{et-en-cas-de-message-derreur}{%
\subsection{Et en cas de message d'erreur
?}\label{et-en-cas-de-message-derreur}}

Lorsque vous utiliserez la fonction \texttt{mix()}, il se peut que des
messages d'erreurs et/ou des messages d'avertissement apparaissent.

{\faIcon{info-circle}} Les messages d'information et les avertissements
commencent en général par le mot \texttt{Warning} et sont presque
toujours sans conséquence. La commande a été comprise par
\texttt{RStudio} et un résultat a été produit. Dans le cas de la
fonction \texttt{mix()}, les avertissements indiquent que la solution
trouvée (l'ajustement des loi Normales aux cohortes observées) n'est
peut-être pas optimale, mais une solution a néanmoins été obtenue.

{\faIcon{bomb}} Les messages d'erreurs commencent par \texttt{Erreur} ou
\texttt{Error} et indiquent que la commande n'a pas abouti. Dans le cas
de la fonction \texttt{mix()}, cela peut être lié à 2 choses :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  soit les valeurs choisies pour la fonction \texttt{mixparam()} sont
  trop éloignées de la position des pics réels, et la fonction
  \texttt{mix()} ne parvient donc pas à trouver de solution
  satisfaisante
\item
  soit le nombre de valeurs choisies pour la fonction
  \texttt{mixparam()} n'est pas le bon. Par exemple, s'il y a 5 cohortes
  et qu'on ne fournit que 4 valeurs pour \texttt{mu} et \texttt{sigma},
  un message d'erreur apparaîtra. De même, s'il y a 4 cohortes et qu'on
  fournit 5 valeurs pour \texttt{mu} et \texttt{sigma}, un message
  d'erreur apparaîtra. Enfin, si on ne fournit pas le même nombre de
  valeurs pour \texttt{mu} et pour \texttt{sigma}, un message d'erreur
  apparaîtra.
\end{enumerate}

Dans les deux cas, vous devez

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  revenir à votre structure démographique instantanée et l'observer plus
  attentivement
\item
  déterminer des valeurs plus appropriées\sidenote{\footnotesize ajoutez ou retirez
    une cohorte si besoin, et choisissez des valeurs plus proches des
    pics observés} pour la fonction \texttt{mixparam()}
\item
  ré-exécuter le code depuis la création de l'objet \texttt{param\_01}
  et jusqu'à la décomposition polymodale avec la fonction \texttt{mix()}
\end{enumerate}

\hypertarget{taille-moyenne-et-abondance-des-cohortes}{%
\section{Taille moyenne et abondance des
cohortes}\label{taille-moyenne-et-abondance-des-cohortes}}

À partir des résultats de la décomposition polymodale, nous devons
maintenant calculer l'abondance (\emph{i.e.} le nombre d'individus) de
chaque cohorte. Nous devrons ensuite stocker dans un nouveau tableau :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  la date d'échantillonnage (mars 2010)
\item
  la valeur d'abondance de la cohorte dont on souhaite réaliser le suivi
  (il s'agit de la cohorte la plus jeune en mars 2010)
\item
  la taille moyenne des individus de la cohorte dont on souhaite
  réaliser le suivi\sidenote{\footnotesize on sait déjà que cette taille vaut 3.9
    millimètres en mars 2010.}
\end{enumerate}

L'abondance d'une cohorte est obtenue en multipliant la valeur de
\texttt{pi} de la cohorte d'intérêt par le nombre total d'individus
échantillonnés en mars 2010. En effet, sur la
Figure~\ref{fig-ajustement}, la surface totale comprise entre l'axe des
abscisses et la courbe verte vaut 1. Cette surface correspond au nombre
total d'individus échantillonnés en mars 2010 :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(Nas\_01)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 468
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{nrow()} : affiche le nombre de lignes d'une matrice ou d'un
\texttt{data.frame}

\end{footnotesize}}

Puisque la première cohorte représente 46.42\% de l'abondance
totale\sidenote{\footnotesize c'est ce que nous dit la valeur de \texttt{pi} de la
  première cohorte dans le tableau \texttt{res\_01\$parameters} :}, tout
ce dont on a besoin pour connaitre l'abondance de la cohorte la plus
jeune est :

\begin{margintable}

\begin{longtable}[]{@{}rrr@{}}
\toprule()
pi & mu & sigma \\
\midrule()
\endhead
0.4642 & 3.9032 & 1.0860 \\
0.2706 & 8.7953 & 1.5550 \\
0.1435 & 18.1149 & 2.1018 \\
0.0910 & 28.2305 & 2.8612 \\
0.0307 & 35.0210 & 2.3435 \\
\bottomrule()
\end{longtable}

\end{margintable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res\_01}\SpecialCharTok{$}\NormalTok{parameters[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\SpecialCharTok{*} \FunctionTok{nrow}\NormalTok{(Nas\_01)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 217.2341
\end{verbatim}

En arrondissant à l'entier le plus proche, on obtient :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(res\_01}\SpecialCharTok{$}\NormalTok{parameters[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\SpecialCharTok{*} \FunctionTok{nrow}\NormalTok{(Nas\_01), }\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 217
\end{verbatim}

\marginnote{\begin{footnotesize}

\texttt{round()} : arrondit des valeurs numériques. Le deuxième argument
permet d'indiquer le nombre de décimales.

\end{footnotesize}}

Nous savons donc maintenant que la première cohorte, la plus jeune de la
population échantillonnée en mars 2010, a donc une taille moyenne de 3.9
millimètre et une abondance de 217 individus. Nous allons maintenant
utiliser ces valeurs pour créer un tableau et placer le premier point
des courbes de croissance, de survie et d'Allen.

\hypertarget{tableau-et-mise-en-forme-des-donnuxe9es}{%
\section{Tableau et mise en forme des
données}\label{tableau-et-mise-en-forme-des-donnuxe9es}}

Nous venons de décrire ci-dessus la méthode que vous devrez appliquer
pour chaque date d'échantillonnage. En suivant les mêmes étapes, vous
devriez être en mesure d'obtenir la taille et l'abondance moyennes de
notre cohorte d'intérêt pour les 9 dates restantes. Lorsque vous
effectuerez la décomposition polymodale pour ces 9 dates, n'oubliez
jamais que vous voulez suivre \emph{systématiquement la même cohorte
dans le temps}. Cette cohorte va progressivement évoluer vers des
tailles plus importantes puisque les individus grandissent chaque mois
et chaque année. Notre cohorte d'intérêt va donc progressivement se
décaler vers la droite des structures démographiques instantanées, et
les informations de cette cohortes ne seront donc pas systématiquement
situées sur la première ligne des résultats de la décomposition
polymodale.

Pour chaque date, on s'attend donc à ce que la taille moyenne des
individus soit plus grande que la taille obtenue pour la date
d'échantillonnage précédente. De même, l'abondance devrait diminuer au
fil du temps en raison de la mortalité naturelle qui affecte tous les
individus de la population.

Pour produire les 3 courbes (croissance, survie et Allen) dont nous
avons besoin, nous allons créer un \texttt{tibble} contenant 3 colonnes
:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  la date d'échantillonnage
\item
  la taille moyenne des individus de la cohorte en millimètres
\item
  l'abondance de la cohorte (nombre d'individus de la cohorte)
\end{enumerate}

Nous pouvons utiliser la fonction \texttt{tribble()} pour le faire :

\begin{figure*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{date,        }\SpecialCharTok{\textasciitilde{}}\NormalTok{size,                  }\SpecialCharTok{\textasciitilde{}}\NormalTok{abundance,}
  \StringTok{"2010{-}03{-}01"}\NormalTok{, res\_01}\SpecialCharTok{$}\NormalTok{parameters[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{], res\_01}\SpecialCharTok{$}\NormalTok{parameters[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{*} \FunctionTok{nrow}\NormalTok{(Nas\_01)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{figure*}

\marginnote{\begin{footnotesize}

\texttt{tribble()} : permet de créer un \texttt{tibble} ligne par ligne.
Le ``r'' de \texttt{tribble} est l'abréviation de ``\textbf{r}ow''.

\end{footnotesize}}

Pour chaque nouvelle date d'échantillonnage, vous devrez compléter ce
tableau en ajoutant une nouvelle ligne à l'intérieur de cette fonction
\texttt{tribble()}.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, colframe=quarto-callout-warning-color-frame, titlerule=0mm, leftrule=.75mm, opacityback=0, bottomrule=.15mm, title=\textcolor{quarto-callout-warning-color}{\faExclamationTriangle}\hspace{0.5em}{Attention !}, colbacktitle=quarto-callout-warning-color!10!white, breakable, colback=white, left=2mm, toptitle=1mm, arc=.35mm, bottomtitle=1mm, rightrule=.15mm, opacitybacktitle=0.6]

Une erreur fréquente est de saisir les données obtenues à chaque date
d'échantillonnage dans un tableau différent à chaque fois. Ça n'est pas
ce qu'il faut faire ! Il faut au contraire compléter le tableau
\texttt{cohorte} en ajoutant une nouvelle ligne au tableau existant de
la façon suivante :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{date,        }\SpecialCharTok{\textasciitilde{}}\NormalTok{size,                  }\SpecialCharTok{\textasciitilde{}}\NormalTok{abundance,}
  \StringTok{"2010{-}03{-}01"}\NormalTok{, res\_01}\SpecialCharTok{$}\NormalTok{parameters[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{], res\_01}\SpecialCharTok{$}\NormalTok{parameters[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{*} \FunctionTok{nrow}\NormalTok{(Nas\_01),}
  \StringTok{"2010{-}09{-}01"}\NormalTok{, ...                   , ...}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Nous devons spécifier une dernière chose afin de produire les graphiques
: à ce stade, la colonne \texttt{date} du nouveau tableau
\texttt{cohort} est considéré comme une variable de type
\texttt{character} (type \texttt{\textless{}chr\textgreater{}}) :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 3
  date        size abundance
  <chr>      <dbl>     <dbl>
1 2010-03-01  3.90      217.
\end{verbatim}

Il nous faut donc la transformer pour que \texttt{R} la reconnaisse
comme étant une variable temporelle afin que les données apparaissent
dans l'ordre chronologique (et non alphabétique) sur l'axe des abscisses
de nos graphiques. Voilà comment procéder :

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# On charge le package lubridate pour travailler avec des dates}
\CommentTok{\# Ce package fait partie du tidyverse}
\CommentTok{\# Si vous l\textquotesingle{}avez installé, lubridate est disponible sur votre ordinateur}
\FunctionTok{library}\NormalTok{(lubridate)}
\NormalTok{cohort }\OtherTok{\textless{}{-}}\NormalTok{ cohort }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{date}\NormalTok{(date))}
\end{Highlighting}
\end{Shaded}

\marginnote{\begin{footnotesize}

\texttt{mutate()} : crée de nouvelles variables dans un \texttt{tibble},
ou modifie des variables existantes.\\
\texttt{date()} : transforme des variables de type
\texttt{\textless{}chr\textgreater{}} (caractères) en variable de type
\texttt{\textless{}date\textgreater{}} (dates).

\end{footnotesize}}

On vérifie que la variable \texttt{date} possède maintenant le type
\texttt{\textless{}date\textgreater{}} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 3
  date        size abundance
  <date>     <dbl>     <dbl>
1 2010-03-01  3.90      217.
\end{verbatim}

À ce stade, nous avons tout ce qu'il nous faut pour produire les courbes
de croissance, de survie et d'Allen, à l'aide de \texttt{ggplot2}.
Évidemment, chaque courbe ne contiendra ici qu'un seul point puisque
nous avons examiné pour l'instant qu'une seule date d'échantillonnage.
Elles ne seront complètes que lorsque que vous aurez répété ce travail
pour l'ensemble des 10 dates d'échantillonnage.

\hypertarget{courbe-de-croissance}{%
\section{Courbe de croissance}\label{courbe-de-croissance}}

On place les dates d'échantillonnage sur l'axe des abscisses, et la
taille moyennes des individus de la cohorte d'intérêt sur l'axe des
ordonnées :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date, }\AttributeTok{y =}\NormalTok{ size, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Date d\textquotesingle{}échantillonnage"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Longueur moyenne de la coquille (mm)"}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Courbe de croissance"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\marginnote{\begin{footnotesize}

\texttt{geom\_point()} et \texttt{geom\_line()} : permettent d'ajouter
des points et des lignes (respectivement) sur un graphique\\
\texttt{labs()} : permet de spécifier le titre d'un graphique et de ses
axes\\
\texttt{theme\_bw()} : change l'apparence générale du graphique

\end{footnotesize}}

\begin{figure}

\sidecaption{\label{fig-croiss}Courbe de croissance d'une cohorte de la
population de \emph{Nassarius reticulatus}, suivie pendant 5 ans. À
compléter avec les données des 9 autres dates d'échantillonnage}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-croiss-1.pdf}

}

\end{figure}

L'argument \texttt{group\ =\ 1} est utilisé pour indiquer que toutes les
dates d'échantillonnage appartiennent à la même série temporelle, et
qu'on souhaite donc relier les dates par une ligne. Le résultat sera
nettement plus parlant quand vous aurez ajouté des données d'autres
dates d'échantillonnage sur le graphique, afin de visualiser l'évolution
de la taille moyenne des individus de la cohorte d'intérêt au fil du
temps.

\hypertarget{courbe-de-survie}{%
\section{Courbe de survie}\label{courbe-de-survie}}

Pour produire la courbe de survie, on procède de la même façon, mais on
place les dates d'échantillonnage sur l'axe des abscisses, et
l'abondance de la cohorte d'intérêt sur l'axe des ordonnées :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Date d\textquotesingle{}échantillonnage"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Abondance de la cohorte"}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Courbe de survie"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\sidecaption{\label{fig-survie}Courbe de survie d'une cohorte de la
population de \emph{Nassarius reticulatus}, suivie pendant 5 ans. À
compléter avec les données des 9 autres dates d'échantillonnage}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-survie-1.pdf}

}

\end{figure}

\hypertarget{courbe-dallen}{%
\section{Courbe d'Allen}\label{courbe-dallen}}

Pour produire la courbe de survie, on place la taille moyenne des
individus de la cohorte sur l'axe des abscisses, et l'abondance de la
cohorte d'intérêt sur l'axe des ordonnées :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ size, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Longueur moyenne de la coquille (mm)"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Abondance de la cohorte"}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Courbe d\textquotesingle{}Allen"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\sidecaption{\label{fig-allen}Courbe d'Allen d'une cohorte de la
population de \emph{Nassarius reticulatus}, suivie pendant 5 ans. À
compléter avec les données des 9 autres dates d'échantillonnage}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-allen-1.pdf}

}

\end{figure}

\hypertarget{relation-allomuxe9trique}{%
\section{Relation allométrique}\label{relation-allomuxe9trique}}

L'un des objectifs de ce travail était de produire une courbe d'Allen
pour étudier les \textbf{variations de biomasses}. Pour y parvenir, nous
devons faire une courbe d'Allen sur laquelle figure la masse moyenne des
individus de la cohorte d'intérêt (en grammes), plutôt que la taille
moyenne des individus de cette cohorte (en millimètres). Pour passer des
tailles en millimètres aux masses en grammes, il nous suffit d'appliquer
la relation allométrique fournie dans la Section~\ref{sec-pres}, et
d'ajouter une nouvelle colonne à notre tableau grâce à la fonction
\texttt{mutate()} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort\_2 }\OtherTok{\textless{}{-}}\NormalTok{ cohort }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{weight =} \FloatTok{0.0013} \SpecialCharTok{*}\NormalTok{ size }\SpecialCharTok{\^{}} \FloatTok{2.3}\NormalTok{)}

\NormalTok{cohort\_2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 4
  date        size abundance weight
  <date>     <dbl>     <dbl>  <dbl>
1 2010-03-01  3.90      217. 0.0298
\end{verbatim}

Il n'y a plus qu'à utiliser cette nouvelle variable sur l'axe des
abscisses d'une courbe d'Allen :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cohort\_2 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ weight, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Masse moyenne des individus (g)"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Abondance de la cohorte"}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Courbe d\textquotesingle{}Allen"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\sidecaption{\label{fig-biomasse}Courbe d'Allen d'une cohorte de la
population de \emph{Nassarius reticulatus}, suivie pendant 5 ans. À
compléter avec les données des 9 autres dates d'échantillonnage}

{\centering \includegraphics{./05-Cohortes_files/figure-pdf/fig-biomasse-1.pdf}

}

\end{figure}

\hypertarget{uxe0-vous-de-jouer}{%
\section{À vous de jouer !}\label{uxe0-vous-de-jouer}}

Au final, voilà comment on peut résumer les différentes étapes de ce
travail.

\begin{figure*}

{\centering \includegraphics{./images/diagram.png}

}

\end{figure*}

Assurez vous que vous avez bien compris chaque étape de la méthode
décrite pour l'échantillonnage de mars 2010, et pourquoi on fait les
choses présentées ici dans l'ordre où on les fait. À ce stade, vous
devriez déjà avoir un script assez long qui devrait contenir la plupart
des commandes évoquées plus haut. Vous devriez donc pouvoir reproduire
ces étapes pour toutes les autres dates d'échantillonnage en faisant des
copier-coller et en modifiant quelques éléments précis (dates, nom des
objets, valeurs de tailles moyennes pour les cohortes, etc.). Attention
aussi à adopter une structure de script la plus clair possible, afin de
pouvoir corriger les éventuels bugs ou problèmes plus facilement.

Il ne vous reste donc plus qu'à reproduire ce travail pour les 9 autres
dates d'échantillonnage afin (i) de récupérer les valeurs d'abondance,
de taille et de masse moyenne des individus de la cohorte d'intérêt
(celle qui a été recrutée en mars 2010) et (ii) de compléter les 3
courbes que nous avons commencées plus haut.

Bon courage !

\bookmarksetup{startatroot}

\hypertarget{sec-dynam}{%
\chapter{Systèmes dynamiques}\label{sec-dynam}}

Ne sera pas traité cette année\ldots{}

\bookmarksetup{startatroot}

\hypertarget{references}{%
\chapter*{References}\label{references}}
\addcontentsline{toc}{chapter}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-R-palmerpenguins}{}}%
Horst, Allison, Alison Hill, et Kristen Gorman. 2022.
\emph{palmerpenguins: Palmer Archipelago (Antarctica) Penguin Data}.
\url{https://CRAN.R-project.org/package=palmerpenguins}.

\leavevmode\vadjust pre{\hypertarget{ref-R-mixdist}{}}%
Macdonald, Peter, et with contributions from Juan Du. 2018.
\emph{mixdist: Finite Mixture Distribution Models}.
\url{https://CRAN.R-project.org/package=mixdist}.

\leavevmode\vadjust pre{\hypertarget{ref-R-skimr}{}}%
Waring, Elin, Michael Quinn, Amelia McNamara, Eduardo Arino de la Rubia,
Hao Zhu, et Shannon Ellis. 2022. \emph{skimr: Compact and Flexible
Summaries of Data}. \url{https://CRAN.R-project.org/package=skimr}.

\leavevmode\vadjust pre{\hypertarget{ref-R-nycflights13}{}}%
Wickham, Hadley. 2021. \emph{nycflights13: Flights that Departed NYC in
2013}. \url{https://github.com/hadley/nycflights13}.

\leavevmode\vadjust pre{\hypertarget{ref-R-tidyverse}{}}%
---------. 2022. \emph{tidyverse: Easily Install and Load the
Tidyverse}. \url{https://CRAN.R-project.org/package=tidyverse}.

\leavevmode\vadjust pre{\hypertarget{ref-tidyverse2019}{}}%
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
D'Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019.
{«~Welcome to the {tidyverse}~»}. \emph{Journal of Open Source Software}
4 (43): 1686. \url{https://doi.org/10.21105/joss.01686}.

\leavevmode\vadjust pre{\hypertarget{ref-R-ggplot2}{}}%
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen,
Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, et Dewey
Dunnington. 2022. \emph{ggplot2: Create Elegant Data Visualisations
Using the Grammar of Graphics}.
\url{https://CRAN.R-project.org/package=ggplot2}.

\leavevmode\vadjust pre{\hypertarget{ref-R-dplyr}{}}%
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, et Davis
Vaughan. 2023. \emph{dplyr: A Grammar of Data Manipulation}.
\url{https://CRAN.R-project.org/package=dplyr}.

\leavevmode\vadjust pre{\hypertarget{ref-R-readr}{}}%
Wickham, Hadley, Jim Hester, et Jennifer Bryan. 2022. \emph{readr: Read
Rectangular Text Data}. \url{https://CRAN.R-project.org/package=readr}.

\end{CSLReferences}



\end{document}
